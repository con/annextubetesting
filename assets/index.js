var sn=Object.defineProperty;var on=(l,e,t)=>e in l?sn(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var Ae=(l,e,t)=>on(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Q(){}function Hl(l){return l()}function zt(){return Object.create(null)}function Ee(l){l.forEach(Hl)}function Bt(l){return typeof l=="function"}function Oe(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let nt;function Le(l,e){return l===e?!0:(nt||(nt=document.createElement("a")),nt.href=e,l===nt.href)}function an(l){return Object.keys(l).length===0}function c(l,e){l.appendChild(e)}function y(l,e,t){l.insertBefore(e,t||null)}function b(l){l.parentNode&&l.parentNode.removeChild(l)}function $e(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function p(l){return document.createElement(l)}function M(l){return document.createTextNode(l)}function k(){return M(" ")}function ht(){return M("")}function H(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function rn(l){return function(e){return e.preventDefault(),l.call(this,e)}}function d(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function cn(l){return Array.from(l.childNodes)}function T(l,e){e=""+e,l.data!==e&&(l.data=e)}function x(l,e){l.value=e??""}function un(l,e,t,n){l.style.setProperty(e,t,"")}function Ge(l,e,t){for(let n=0;n<l.options.length;n+=1){const i=l.options[n];if(i.__value===e){i.selected=!0;return}}(!t||e!==void 0)&&(l.selectedIndex=-1)}function Ze(l,e){for(let t=0;t<l.options.length;t+=1){const n=l.options[t];n.selected=~e.indexOf(n.__value)}}function vt(l){const e=l.querySelector(":checked");return e&&e.__value}function gt(l){return[].map.call(l.querySelectorAll(":checked"),e=>e.__value)}function ge(l,e,t){l.classList.toggle(e,!!t)}let lt;function tt(l){lt=l}function Kl(){if(!lt)throw new Error("Function called outside component initialization");return lt}function _t(l){Kl().$$.on_mount.push(l)}function fn(l){Kl().$$.on_destroy.push(l)}const Je=[],Pt=[];let Xe=[];const Vt=[],Yl=Promise.resolve();let wt=!1;function ql(){wt||(wt=!0,Yl.then(Wl))}function It(){return ql(),Yl}function Te(l){Xe.push(l)}const bt=new Set;let Qe=0;function Wl(){if(Qe!==0)return;const l=lt;do{try{for(;Qe<Je.length;){const e=Je[Qe];Qe++,tt(e),dn(e.$$)}}catch(e){throw Je.length=0,Qe=0,e}for(tt(null),Je.length=0,Qe=0;Pt.length;)Pt.pop()();for(let e=0;e<Xe.length;e+=1){const t=Xe[e];bt.has(t)||(bt.add(t),t())}Xe.length=0}while(Je.length);for(;Vt.length;)Vt.pop()();wt=!1,bt.clear(),tt(l)}function dn(l){if(l.fragment!==null){l.update(),Ee(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Te)}}function hn(l){const e=[],t=[];Xe.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Xe=e}const rt=new Set;let qe;function pt(){qe={r:0,c:[],p:qe}}function mt(){qe.r||Ee(qe.c),qe=qe.p}function ae(l,e){l&&l.i&&(rt.delete(l),l.i(e))}function pe(l,e,t,n){if(l&&l.o){if(rt.has(l))return;rt.add(l),qe.c.push(()=>{rt.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function fe(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function _n(l,e){l.d(1),e.delete(l.key)}function pn(l,e){pe(l,1,1,()=>{e.delete(l.key)})}function Gl(l,e,t,n,i,s,o,a,r,u,f,h){let _=l.length,m=s.length,v=_;const w={};for(;v--;)w[l[v].key]=v;const D=[],A=new Map,g=new Map,E=[];for(v=m;v--;){const C=h(i,s,v),S=t(C);let j=o.get(S);j?E.push(()=>j.p(C,e)):(j=u(S,C),j.c()),A.set(S,D[v]=j),S in w&&g.set(S,Math.abs(v-w[S]))}const F=new Set,z=new Set;function B(C){ae(C,1),C.m(a,f),o.set(C.key,C),f=C.first,m--}for(;_&&m;){const C=D[m-1],S=l[_-1],j=C.key,P=S.key;C===S?(f=C.first,_--,m--):A.has(P)?!o.has(j)||F.has(j)?B(C):z.has(P)?_--:g.get(j)>g.get(P)?(z.add(j),B(C)):(F.add(P),_--):(r(S,o),_--)}for(;_--;){const C=l[_];A.has(C.key)||r(C,o)}for(;m;)B(D[m-1]);return Ee(E),D}function We(l){l&&l.c()}function Ve(l,e,t){const{fragment:n,after_update:i}=l.$$;n&&n.m(e,t),Te(()=>{const s=l.$$.on_mount.map(Hl).filter(Bt);l.$$.on_destroy?l.$$.on_destroy.push(...s):Ee(s),l.$$.on_mount=[]}),i.forEach(Te)}function Ie(l,e){const t=l.$$;t.fragment!==null&&(hn(t.after_update),Ee(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function mn(l,e){l.$$.dirty[0]===-1&&(Je.push(l),ql(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function Ne(l,e,t,n,i,s,o=null,a=[-1]){const r=lt;tt(l);const u=l.$$={fragment:null,ctx:[],props:s,update:Q,not_equal:i,bound:zt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(r?r.$$.context:[])),callbacks:zt(),dirty:a,skip_bound:!1,root:e.target||r.$$.root};o&&o(u.root);let f=!1;if(u.ctx=t?t(l,e.props||{},(h,_,...m)=>{const v=m.length?m[0]:_;return u.ctx&&i(u.ctx[h],u.ctx[h]=v)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](v),f&&mn(l,h)),_}):[],u.update(),f=!0,Ee(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const h=cn(e.target);u.fragment&&u.fragment.l(h),h.forEach(b)}else u.fragment&&u.fragment.c();e.intro&&ae(l.$$.fragment),Ve(l,e.target,e.anchor),Wl()}tt(r)}class Ue{constructor(){Ae(this,"$$");Ae(this,"$$set")}$destroy(){Ie(this,1),this.$destroy=Q}$on(e,t){if(!Bt(t))return Q;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!an(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const vn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(vn);function gn(l){return l?l.replace(/\\\\/g,"\0").replace(/\\t/g,"	").replace(/\\r/g,"\r").replace(/\\n/g,`
`).replace(/\x00/g,"\\"):""}function et(l){const e=l.split(/\r?\n/);if(e.length<2)return[];const t=e[0].split("	");return e.slice(1).filter(n=>n.trim()).map(n=>{const i=n.split("	");return Object.fromEntries(t.map((s,o)=>[s,gn(i[o]||"")]))})}function je(l,e=0){const t=parseInt(l,10);return isNaN(t)?e:t}async function Ql(l){try{return(await fetch(l,{method:"HEAD"})).ok}catch(e){return console.warn("[availability] Failed to check:",l,e),!1}}const yt=new Map;async function bn(l,e=!1){if(!e&&yt.has(l))return yt.get(l);const t=await Ql(l);return yt.set(l,t),t}class yn{constructor(e="."){Ae(this,"baseUrl");Ae(this,"videosCache",null);Ae(this,"playlistsCache",null);Ae(this,"metadataCache",new Map);Ae(this,"commentsCache",new Map);this.baseUrl=e}async loadVideos(){if(this.videosCache)return this.videosCache;const e=await fetch(`${this.baseUrl}/videos/videos.tsv`);if(!e.ok)throw new Error(`Failed to load videos.tsv: ${e.statusText}`);const t=await e.text(),n=et(t);return this.videosCache=n.map(i=>this.parseTSVVideo(i)),this.videosCache}async loadPlaylists(){if(this.playlistsCache)return this.playlistsCache;const e=await fetch(`${this.baseUrl}/playlists/playlists.tsv`);if(!e.ok)throw new Error(`Failed to load playlists.tsv: ${e.statusText}`);const t=await e.text(),i=et(t).map(s=>this.parseTSVPlaylist(s));return await Promise.all(i.map(async s=>{try{const o=await this.loadPlaylistMetadata(s.playlist_id,s.path);s.video_ids=o.video_ids}catch(o){console.warn(`Could not load video_ids for playlist ${s.playlist_id}:`,o)}})),this.playlistsCache=i,this.playlistsCache}async loadVideoMetadata(e,t){const n=e.video_id,i=e.file_path||n,s=t?`${t}:${n}`:n;if(this.metadataCache.has(s))return this.metadataCache.get(s);const o=t?`${this.baseUrl}/${t}/videos/${i}/metadata.json`:`${this.baseUrl}/videos/${i}/metadata.json`,a=await fetch(o);if(!a.ok)throw new Error(`Failed to load metadata for ${n}: ${a.statusText}`);const r=await a.json();return r.file_path=i,r.download_status=e.download_status,this.metadataCache.set(s,r),r}async loadComments(e,t){const n=e.video_id,i=e.file_path||n,s=t?`${t}:${n}`:n;if(this.commentsCache.has(s))return this.commentsCache.get(s);const o=t?`${this.baseUrl}/${t}/videos/${i}/comments.json`:`${this.baseUrl}/videos/${i}/comments.json`,a=await fetch(o);if(!a.ok){if(a.status===404)return[];throw new Error(`Failed to load comments for ${n}: ${a.statusText}`)}const r=await a.json();return this.commentsCache.set(s,r),r}async loadPlaylistMetadata(e,t){let n=t||"";if(!n&&this.playlistsCache){const s=this.playlistsCache.find(o=>o.playlist_id===e);s&&s.path&&(n=s.path)}if(!n)throw new Error(`Cannot load playlist metadata for ${e}: path not found in cache`);const i=await fetch(`${this.baseUrl}/playlists/${n}/playlist.json`);if(!i.ok)throw new Error(`Failed to load playlist metadata for ${e}: ${i.statusText}`);return await i.json()}getCaptionPath(e,t){const n=this.getVideoPath(e);return`${this.baseUrl}/videos/${n}/caption_${t}.vtt`}getVideoPath(e){if(this.videosCache){const t=this.videosCache.find(n=>n.video_id===e);if(t&&t.file_path)return t.file_path}return e}async isMultiChannelMode(){try{return(await fetch(`${this.baseUrl}/channels.tsv`)).ok}catch{return!1}}async loadChannels(e=!0){const t=await fetch(`${this.baseUrl}/channels.tsv`);if(!t.ok)throw new Error(`Failed to load channels.tsv: ${t.statusText}`);const n=await t.text(),s=et(n).map(o=>this.parseTSVChannel(o));return e&&await Promise.all(s.map(async o=>{try{const a=await this.loadChannelMetadata(o.channel_dir);Object.assign(o,a),o.channel_dir=a.channel_dir||o.channel_dir}catch(a){console.warn(`Could not load full metadata for channel ${o.channel_id}:`,a)}})),s}async loadChannelMetadata(e){const t=await fetch(`${this.baseUrl}/${e}/channel.json`);if(!t.ok)throw new Error(`Failed to load channel.json for ${e}: ${t.statusText}`);const n=await t.json();n.channel_dir=e;const i=await this.findChannelAvatar(e);return i&&(n.avatar_url=i),n}async findChannelAvatar(e){const t=["jpg","jpeg","png","gif","webp","svg"];for(const n of t){const i=`${this.baseUrl}/${e}/channel_avatar.${n}`;if(await Ql(i))return i}return null}async loadChannelVideos(e){const t=await fetch(`${this.baseUrl}/${e}/videos/videos.tsv`);if(!t.ok)throw new Error(`Failed to load videos for channel ${e}: ${t.statusText}`);const n=await t.text();return et(n).map(s=>this.parseTSVVideo(s))}async loadChannelPlaylists(e){const t=await fetch(`${this.baseUrl}/${e}/playlists/playlists.tsv`);if(!t.ok)throw new Error(`Failed to load playlists for channel ${e}: ${t.statusText}`);const n=await t.text(),s=et(n).map(o=>this.parseTSVPlaylist(o));return await Promise.all(s.map(async o=>{try{const a=await this.loadChannelPlaylistMetadata(e,o.playlist_id,o.path);o.video_ids=a.video_ids}catch(a){console.warn(`Could not load video_ids for playlist ${o.playlist_id}:`,a)}})),s}async loadChannelPlaylistMetadata(e,t,n){if(!n)throw new Error(`Cannot load playlist metadata for ${t}: path not provided`);const i=await fetch(`${this.baseUrl}/${e}/playlists/${n}/playlist.json`);if(!i.ok)throw new Error(`Failed to load playlist metadata for ${t}: ${i.statusText}`);return await i.json()}clearCache(){this.videosCache=null,this.playlistsCache=null,this.metadataCache.clear(),this.commentsCache.clear()}parseTSVVideo(e){return{video_id:e.video_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,published_at:e.published_at,duration:je(e.duration),view_count:je(e.view_count),like_count:je(e.like_count),comment_count:je(e.comment_count),thumbnail_url:e.thumbnail_url,download_status:e.download_status,source_url:e.source_url,file_path:e.path||e.video_id,license:"standard",privacy_status:"public",availability:"public",tags:[],categories:[],captions_available:[],has_auto_captions:!1,fetched_at:new Date().toISOString(),updated_at:new Date().toISOString()}}parseTSVPlaylist(e){return{playlist_id:e.playlist_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,video_count:je(e.video_count),total_duration:je(e.total_duration),privacy_status:e.privacy_status,created_at:e.created_at,last_sync:e.last_sync,path:e.path,video_ids:[],updated_at:e.last_sync,fetched_at:e.last_sync}}parseTSVChannel(e){return{channel_id:e.channel_id,name:e.title,description:e.description,custom_url:e.custom_url,subscriber_count:je(e.subscriber_count),video_count:je(e.video_count),avatar_url:"",videos:[],playlists:[],last_sync:e.last_sync,created_at:"",fetched_at:e.last_sync,archive_stats:{total_videos_archived:je(e.total_videos_archived),first_video_date:e.first_video_date||void 0,last_video_date:e.last_video_date||void 0,total_duration_seconds:0,total_size_bytes:0},channel_dir:e.channel_dir}}}const Be=new yn;class kn{constructor(){Ae(this,"listeners",[]);Ae(this,"currentRoute",{name:"home",params:{}});window.addEventListener("hashchange",()=>this.handleHashChange()),this.handleHashChange()}subscribe(e){return this.listeners.push(e),e(this.currentRoute),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}navigate(e,t={}){e==="home"?window.location.hash="#/":e==="channel"?window.location.hash=`#/channel/${t.channel_dir}`:e==="video"&&(t.channel_dir?window.location.hash=`#/channel/${t.channel_dir}/video/${t.video_id}`:window.location.hash=`#/video/${t.video_id}`)}getCurrentRoute(){return this.currentRoute}handleHashChange(){const e=window.location.hash.slice(1),t=this.parseHash(e);this.isSameRoute(this.currentRoute,t)||(this.currentRoute=t,this.notifyListeners(t))}isSameRoute(e,t){if(e.name!==t.name)return!1;const n=Object.keys(e.params),i=Object.keys(t.params);return n.length!==i.length?!1:n.every(s=>e.params[s]===t.params[s])}parseHash(e){const t=e.startsWith("/")?e.slice(1):e,n=t.indexOf("?"),i=n===-1?t:t.substring(0,n);if(!i||i==="/")return{name:"home",params:{}};const s=i.match(/^channel\/([^/]+)\/video\/([^/]+)$/);if(s)return{name:"video",params:{channel_dir:s[1],video_id:s[2]}};const o=i.match(/^channel\/([^/]+)$/);if(o)return{name:"channel",params:{channel_dir:o[1]}};const a=i.match(/^video\/([^/]+)$/);return a?{name:"video",params:{video_id:a[1]}}:{name:"home",params:{}}}notifyListeners(e){this.listeners.forEach(t=>t(e))}}const Pe=new kn;function ze(l){return Array.isArray?Array.isArray(l):Zl(l)==="[object Array]"}function Cn(l){if(typeof l=="string")return l;let e=l+"";return e=="0"&&1/l==-1/0?"-0":e}function wn(l){return l==null?"":Cn(l)}function De(l){return typeof l=="string"}function Jl(l){return typeof l=="number"}function An(l){return l===!0||l===!1||En(l)&&Zl(l)=="[object Boolean]"}function Xl(l){return typeof l=="object"}function En(l){return Xl(l)&&l!==null}function Ce(l){return l!=null}function kt(l){return!l.trim().length}function Zl(l){return l==null?l===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(l)}const Mn="Incorrect 'index' type",Sn=l=>`Invalid value for key ${l}`,Dn=l=>`Pattern length exceeds max of ${l}.`,Fn=l=>`Missing ${l} property in key`,jn=l=>`Property 'weight' in key '${l}' must be a positive integer`,Rt=Object.prototype.hasOwnProperty;class Bn{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let i=$l(n);this._keys.push(i),this._keyMap[i.id]=i,t+=i.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function $l(l){let e=null,t=null,n=null,i=1,s=null;if(De(l)||ze(l))n=l,e=Ot(l),t=At(l);else{if(!Rt.call(l,"name"))throw new Error(Fn("name"));const o=l.name;if(n=o,Rt.call(l,"weight")&&(i=l.weight,i<=0))throw new Error(jn(o));e=Ot(o),t=At(o),s=l.getFn}return{path:e,id:t,weight:i,src:n,getFn:s}}function Ot(l){return ze(l)?l:l.split(".")}function At(l){return ze(l)?l.join("."):l}function Tn(l,e){let t=[],n=!1;const i=(s,o,a)=>{if(Ce(s))if(!o[a])t.push(s);else{let r=o[a];const u=s[r];if(!Ce(u))return;if(a===o.length-1&&(De(u)||Jl(u)||An(u)))t.push(wn(u));else if(ze(u)){n=!0;for(let f=0,h=u.length;f<h;f+=1)i(u[f],o,a+1)}else o.length&&i(u,o,a+1)}};return i(l,De(e)?e.split("."):e,0),n?t:t[0]}const Ln={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},zn={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(l,e)=>l.score===e.score?l.idx<e.idx?-1:1:l.score<e.score?-1:1},Pn={location:0,threshold:.6,distance:100},Vn={useExtendedSearch:!1,getFn:Tn,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var V={...zn,...Ln,...Pn,...Vn};const In=/[^ ]+/g;function Rn(l=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(i){const s=i.match(In).length;if(t.has(s))return t.get(s);const o=1/Math.pow(s,.5*l),a=parseFloat(Math.round(o*n)/n);return t.set(s,a),a},clear(){t.clear()}}}class Tt{constructor({getFn:e=V.getFn,fieldNormWeight:t=V.fieldNormWeight}={}){this.norm=Rn(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,De(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();De(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Ce(e)||kt(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((i,s)=>{let o=i.getFn?i.getFn(e):this.getFn(e,i.path);if(Ce(o)){if(ze(o)){let a=[];const r=[{nestedArrIndex:-1,value:o}];for(;r.length;){const{nestedArrIndex:u,value:f}=r.pop();if(Ce(f))if(De(f)&&!kt(f)){let h={v:f,i:u,n:this.norm.get(f)};a.push(h)}else ze(f)&&f.forEach((h,_)=>{r.push({nestedArrIndex:_,value:h})})}n.$[s]=a}else if(De(o)&&!kt(o)){let a={v:o,n:this.norm.get(o)};n.$[s]=a}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function xl(l,e,{getFn:t=V.getFn,fieldNormWeight:n=V.fieldNormWeight}={}){const i=new Tt({getFn:t,fieldNormWeight:n});return i.setKeys(l.map($l)),i.setSources(e),i.create(),i}function On(l,{getFn:e=V.getFn,fieldNormWeight:t=V.fieldNormWeight}={}){const{keys:n,records:i}=l,s=new Tt({getFn:e,fieldNormWeight:t});return s.setKeys(n),s.setIndexRecords(i),s}function st(l,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:i=V.distance,ignoreLocation:s=V.ignoreLocation}={}){const o=e/l.length;if(s)return o;const a=Math.abs(n-t);return i?o+a/i:a?1:o}function Nn(l=[],e=V.minMatchCharLength){let t=[],n=-1,i=-1,s=0;for(let o=l.length;s<o;s+=1){let a=l[s];a&&n===-1?n=s:!a&&n!==-1&&(i=s-1,i-n+1>=e&&t.push([n,i]),n=-1)}return l[s-1]&&s-n>=e&&t.push([n,s-1]),t}const Ye=32;function Un(l,e,t,{location:n=V.location,distance:i=V.distance,threshold:s=V.threshold,findAllMatches:o=V.findAllMatches,minMatchCharLength:a=V.minMatchCharLength,includeMatches:r=V.includeMatches,ignoreLocation:u=V.ignoreLocation}={}){if(e.length>Ye)throw new Error(Dn(Ye));const f=e.length,h=l.length,_=Math.max(0,Math.min(n,h));let m=s,v=_;const w=a>1||r,D=w?Array(h):[];let A;for(;(A=l.indexOf(e,v))>-1;){let C=st(e,{currentLocation:A,expectedLocation:_,distance:i,ignoreLocation:u});if(m=Math.min(C,m),v=A+f,w){let S=0;for(;S<f;)D[A+S]=1,S+=1}}v=-1;let g=[],E=1,F=f+h;const z=1<<f-1;for(let C=0;C<f;C+=1){let S=0,j=F;for(;S<j;)st(e,{errors:C,currentLocation:_+j,expectedLocation:_,distance:i,ignoreLocation:u})<=m?S=j:F=j,j=Math.floor((F-S)/2+S);F=j;let P=Math.max(1,_-j+1),L=o?h:Math.min(_+j,h)+f,I=Array(L+2);I[L+1]=(1<<C)-1;for(let N=L;N>=P;N-=1){let U=N-1,Y=t[l.charAt(U)];if(w&&(D[U]=+!!Y),I[N]=(I[N+1]<<1|1)&Y,C&&(I[N]|=(g[N+1]|g[N])<<1|1|g[N+1]),I[N]&z&&(E=st(e,{errors:C,currentLocation:U,expectedLocation:_,distance:i,ignoreLocation:u}),E<=m)){if(m=E,v=U,v<=_)break;P=Math.max(1,2*_-v)}}if(st(e,{errors:C+1,currentLocation:_,expectedLocation:_,distance:i,ignoreLocation:u})>m)break;g=I}const B={isMatch:v>=0,score:Math.max(.001,E)};if(w){const C=Nn(D,a);C.length?r&&(B.indices=C):B.isMatch=!1}return B}function Hn(l){let e={};for(let t=0,n=l.length;t<n;t+=1){const i=l.charAt(t);e[i]=(e[i]||0)|1<<n-t-1}return e}const ct=String.prototype.normalize?l=>l.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):l=>l;class en{constructor(e,{location:t=V.location,threshold:n=V.threshold,distance:i=V.distance,includeMatches:s=V.includeMatches,findAllMatches:o=V.findAllMatches,minMatchCharLength:a=V.minMatchCharLength,isCaseSensitive:r=V.isCaseSensitive,ignoreDiacritics:u=V.ignoreDiacritics,ignoreLocation:f=V.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:i,includeMatches:s,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:r,ignoreDiacritics:u,ignoreLocation:f},e=r?e:e.toLowerCase(),e=u?ct(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const h=(m,v)=>{this.chunks.push({pattern:m,alphabet:Hn(m),startIndex:v})},_=this.pattern.length;if(_>Ye){let m=0;const v=_%Ye,w=_-v;for(;m<w;)h(this.pattern.substr(m,Ye),m),m+=Ye;if(v){const D=_-Ye;h(this.pattern.substr(D),D)}}else h(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:i}=this.options;if(e=t?e:e.toLowerCase(),e=n?ct(e):e,this.pattern===e){let w={isMatch:!0,score:0};return i&&(w.indices=[[0,e.length-1]]),w}const{location:s,distance:o,threshold:a,findAllMatches:r,minMatchCharLength:u,ignoreLocation:f}=this.options;let h=[],_=0,m=!1;this.chunks.forEach(({pattern:w,alphabet:D,startIndex:A})=>{const{isMatch:g,score:E,indices:F}=Un(e,w,D,{location:s+A,distance:o,threshold:a,findAllMatches:r,minMatchCharLength:u,includeMatches:i,ignoreLocation:f});g&&(m=!0),_+=E,g&&F&&(h=[...h,...F])});let v={isMatch:m,score:m?_/this.chunks.length:1};return m&&i&&(v.indices=h),v}}class He{constructor(e){this.pattern=e}static isMultiMatch(e){return Nt(e,this.multiRegex)}static isSingleMatch(e){return Nt(e,this.singleRegex)}search(){}}function Nt(l,e){const t=l.match(e);return t?t[1]:null}class Kn extends He{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Yn extends He{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class qn extends He{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Wn extends He{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class Gn extends He{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class Qn extends He{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class tn extends He{constructor(e,{location:t=V.location,threshold:n=V.threshold,distance:i=V.distance,includeMatches:s=V.includeMatches,findAllMatches:o=V.findAllMatches,minMatchCharLength:a=V.minMatchCharLength,isCaseSensitive:r=V.isCaseSensitive,ignoreDiacritics:u=V.ignoreDiacritics,ignoreLocation:f=V.ignoreLocation}={}){super(e),this._bitapSearch=new en(e,{location:t,threshold:n,distance:i,includeMatches:s,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:r,ignoreDiacritics:u,ignoreLocation:f})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class ln extends He{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const i=[],s=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+s,i.push([n,t-1]);const o=!!i.length;return{isMatch:o,score:o?0:1,indices:i}}}const Et=[Kn,ln,qn,Wn,Qn,Gn,Yn,tn],Ut=Et.length,Jn=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Xn="|";function Zn(l,e={}){return l.split(Xn).map(t=>{let n=t.trim().split(Jn).filter(s=>s&&!!s.trim()),i=[];for(let s=0,o=n.length;s<o;s+=1){const a=n[s];let r=!1,u=-1;for(;!r&&++u<Ut;){const f=Et[u];let h=f.isMultiMatch(a);h&&(i.push(new f(h,e)),r=!0)}if(!r)for(u=-1;++u<Ut;){const f=Et[u];let h=f.isSingleMatch(a);if(h){i.push(new f(h,e));break}}}return i})}const $n=new Set([tn.type,ln.type]);class xn{constructor(e,{isCaseSensitive:t=V.isCaseSensitive,ignoreDiacritics:n=V.ignoreDiacritics,includeMatches:i=V.includeMatches,minMatchCharLength:s=V.minMatchCharLength,ignoreLocation:o=V.ignoreLocation,findAllMatches:a=V.findAllMatches,location:r=V.location,threshold:u=V.threshold,distance:f=V.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:i,minMatchCharLength:s,findAllMatches:a,ignoreLocation:o,location:r,threshold:u,distance:f},e=t?e:e.toLowerCase(),e=n?ct(e):e,this.pattern=e,this.query=Zn(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:i,ignoreDiacritics:s}=this.options;e=i?e:e.toLowerCase(),e=s?ct(e):e;let o=0,a=[],r=0;for(let u=0,f=t.length;u<f;u+=1){const h=t[u];a.length=0,o=0;for(let _=0,m=h.length;_<m;_+=1){const v=h[_],{isMatch:w,indices:D,score:A}=v.search(e);if(w){if(o+=1,r+=A,n){const g=v.constructor.type;$n.has(g)?a=[...a,...D]:a.push(D)}}else{r=0,o=0,a.length=0;break}}if(o){let _={isMatch:!0,score:r/o};return n&&(_.indices=a),_}}return{isMatch:!1,score:1}}}const Mt=[];function es(...l){Mt.push(...l)}function St(l,e){for(let t=0,n=Mt.length;t<n;t+=1){let i=Mt[t];if(i.condition(l,e))return new i(l,e)}return new en(l,e)}const ut={AND:"$and",OR:"$or"},Dt={PATH:"$path",PATTERN:"$val"},Ft=l=>!!(l[ut.AND]||l[ut.OR]),ts=l=>!!l[Dt.PATH],ls=l=>!ze(l)&&Xl(l)&&!Ft(l),Ht=l=>({[ut.AND]:Object.keys(l).map(e=>({[e]:l[e]}))});function nn(l,e,{auto:t=!0}={}){const n=i=>{let s=Object.keys(i);const o=ts(i);if(!o&&s.length>1&&!Ft(i))return n(Ht(i));if(ls(i)){const r=o?i[Dt.PATH]:s[0],u=o?i[Dt.PATTERN]:i[r];if(!De(u))throw new Error(Sn(r));const f={keyId:At(r),pattern:u};return t&&(f.searcher=St(u,e)),f}let a={children:[],operator:s[0]};return s.forEach(r=>{const u=i[r];ze(u)&&u.forEach(f=>{a.children.push(n(f))})}),a};return Ft(l)||(l=Ht(l)),n(l)}function ns(l,{ignoreFieldNorm:e=V.ignoreFieldNorm}){l.forEach(t=>{let n=1;t.matches.forEach(({key:i,norm:s,score:o})=>{const a=i?i.weight:null;n*=Math.pow(o===0&&a?Number.EPSILON:o,(a||1)*(e?1:s))}),t.score=n})}function ss(l,e){const t=l.matches;e.matches=[],Ce(t)&&t.forEach(n=>{if(!Ce(n.indices)||!n.indices.length)return;const{indices:i,value:s}=n;let o={indices:i,value:s};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),e.matches.push(o)})}function is(l,e){e.score=l.score}function os(l,e,{includeMatches:t=V.includeMatches,includeScore:n=V.includeScore}={}){const i=[];return t&&i.push(ss),n&&i.push(is),l.map(s=>{const{idx:o}=s,a={item:e[o],refIndex:o};return i.length&&i.forEach(r=>{r(s,a)}),a})}class xe{constructor(e,t={},n){this.options={...V,...t},this.options.useExtendedSearch,this._keyStore=new Bn(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Tt))throw new Error(Mn);this._myIndex=t||xl(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Ce(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,i=this._docs.length;n<i;n+=1){const s=this._docs[n];e(s,n)&&(this.removeAt(n),n-=1,i-=1,t.push(s))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:i,shouldSort:s,sortFn:o,ignoreFieldNorm:a}=this.options;let r=De(e)?De(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return ns(r,{ignoreFieldNorm:a}),s&&r.sort(o),Jl(t)&&t>-1&&(r=r.slice(0,t)),os(r,this._docs,{includeMatches:n,includeScore:i})}_searchStringList(e){const t=St(e,this.options),{records:n}=this._myIndex,i=[];return n.forEach(({v:s,i:o,n:a})=>{if(!Ce(s))return;const{isMatch:r,score:u,indices:f}=t.searchIn(s);r&&i.push({item:s,idx:o,matches:[{score:u,value:s,norm:a,indices:f}]})}),i}_searchLogical(e){const t=nn(e,this.options),n=(a,r,u)=>{if(!a.children){const{keyId:h,searcher:_}=a,m=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(r,h),searcher:_});return m&&m.length?[{idx:u,item:r,matches:m}]:[]}const f=[];for(let h=0,_=a.children.length;h<_;h+=1){const m=a.children[h],v=n(m,r,u);if(v.length)f.push(...v);else if(a.operator===ut.AND)return[]}return f},i=this._myIndex.records,s={},o=[];return i.forEach(({$:a,i:r})=>{if(Ce(a)){let u=n(t,a,r);u.length&&(s[r]||(s[r]={idx:r,item:a,matches:[]},o.push(s[r])),u.forEach(({matches:f})=>{s[r].matches.push(...f)}))}}),o}_searchObjectList(e){const t=St(e,this.options),{keys:n,records:i}=this._myIndex,s=[];return i.forEach(({$:o,i:a})=>{if(!Ce(o))return;let r=[];n.forEach((u,f)=>{r.push(...this._findMatches({key:u,value:o[f],searcher:t}))}),r.length&&s.push({idx:a,item:o,matches:r})}),s}_findMatches({key:e,value:t,searcher:n}){if(!Ce(t))return[];let i=[];if(ze(t))t.forEach(({v:s,i:o,n:a})=>{if(!Ce(s))return;const{isMatch:r,score:u,indices:f}=n.searchIn(s);r&&i.push({score:u,key:e,value:s,idx:o,norm:a,indices:f})});else{const{v:s,n:o}=t,{isMatch:a,score:r,indices:u}=n.searchIn(s);a&&i.push({score:r,key:e,value:s,norm:o,indices:u})}return i}}xe.version="7.1.0";xe.createIndex=xl;xe.parseIndex=On;xe.config=V;xe.parseQuery=nn;es(xn);class as{constructor(){Ae(this,"fuse",null);Ae(this,"videos",[])}initialize(e){this.videos=e,this.fuse=new xe(e,{keys:[{name:"title",weight:.4},{name:"channel_name",weight:.2},{name:"tags",weight:.3},{name:"description",weight:.1}],threshold:.3,includeScore:!0,includeMatches:!0,ignoreLocation:!0,minMatchCharLength:2})}search(e,t){if(!this.fuse||!e.trim())return this.videos.map(s=>({video:s,score:0,matches:[]}));const i=this.fuse.search(e).map(s=>{var o;return{video:s.item,score:s.score||0,matches:((o=s.matches)==null?void 0:o.map(a=>a.key||""))||[]}});return t!=null&&t.limit&&t.limit>0?i.slice(0,t.limit):i}clear(){this.fuse=null,this.videos=[]}getIndexedCount(){return this.videos.length}}const jt=new as;function Kt(l){const e=Math.floor(l/3600),t=Math.floor(l%3600/60),n=l%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`:`${t}:${String(n).padStart(2,"0")}`}function ft(l){return l>=1e9?`${(l/1e9).toFixed(1)}B views`:l>=1e6?`${(l/1e6).toFixed(1)}M views`:l>=1e3?`${(l/1e3).toFixed(1)}K views`:`${l} views`}function Re(l){let e;typeof l=="number"?e=new Date(l*1e3):e=new Date(l);const n=new Date().getTime()-e.getTime(),i=Math.floor(n/1e3),s=Math.floor(i/60),o=Math.floor(s/60),a=Math.floor(o/24),r=Math.floor(a/30),u=Math.floor(a/365);return u>0?`${u} year${u>1?"s":""} ago`:r>0?`${r} month${r>1?"s":""} ago`:a>0?`${a} day${a>1?"s":""} ago`:o>0?`${o} hour${o>1?"s":""} ago`:s>0?`${s} minute${s>1?"s":""} ago`:"Just now"}function Yt(l){return l===0?"":l>=1e3?`${(l/1e3).toFixed(1)}K comments`:`${l} comment${l!==1?"s":""}`}function rs(l){let e,t,n,i,s;return{c(){e=p("img"),Le(e.src,t=l[0].thumbnail_url)||d(e,"src",t),d(e,"alt",n=l[0].title),d(e,"class","thumbnail svelte-16jifoe"),d(e,"loading","lazy")},m(o,a){y(o,e,a),i||(s=H(e,"error",l[3]),i=!0)},p(o,a){a&1&&!Le(e.src,t=o[0].thumbnail_url)&&d(e,"src",t),a&1&&n!==(n=o[0].title)&&d(e,"alt",n)},d(o){o&&b(e),i=!1,s()}}}function cs(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg> <span class="placeholder-text svelte-16jifoe">No thumbnail</span>',d(e,"class","thumbnail-placeholder svelte-16jifoe")},m(t,n){y(t,e,n)},p:Q,d(t){t&&b(e)}}}function us(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>',d(e,"class","status-badge metadata-only svelte-16jifoe"),d(e,"title","Metadata only (no video file)")},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function fs(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',d(e,"class","status-badge downloaded svelte-16jifoe"),d(e,"title","Video available locally")},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function qt(l){let e,t,n,i=Yt(l[0].comment_count)+"",s;return{c(){e=p("span"),e.textContent="•",t=k(),n=p("span"),s=M(i),d(e,"class","separator svelte-16jifoe"),d(n,"class","comments")},m(o,a){y(o,e,a),y(o,t,a),y(o,n,a),c(n,s)},p(o,a){a&1&&i!==(i=Yt(o[0].comment_count)+"")&&T(s,i)},d(o){o&&(b(e),b(t),b(n))}}}function ds(l){let e,t,n,i,s,o=Kt(l[0].duration)+"",a,r,u,f,h=l[0].title+"",_,m,v,w=l[0].channel_name+"",D,A,g,E,F=ft(l[0].view_count)+"",z,B,C,S,j,P,L=Re(l[0].published_at)+"",I,W,N;function U(K,Z){return K[2]?cs:rs}let Y=U(l),X=Y(l);function te(K,Z){if(K[0].download_status==="downloaded")return fs;if(K[0].download_status==="metadata_only")return us}let ee=te(l),G=ee&&ee(l),q=l[0].comment_count>0&&qt(l);return{c(){e=p("div"),t=p("div"),X.c(),n=k(),G&&G.c(),i=k(),s=p("div"),a=M(o),r=k(),u=p("div"),f=p("h3"),_=M(h),m=k(),v=p("div"),D=M(w),A=k(),g=p("div"),E=p("span"),z=M(F),B=k(),q&&q.c(),C=k(),S=p("span"),S.textContent="•",j=k(),P=p("span"),I=M(L),d(s,"class","duration svelte-16jifoe"),d(t,"class","thumbnail-container svelte-16jifoe"),d(f,"class","title svelte-16jifoe"),d(v,"class","channel svelte-16jifoe"),d(E,"class","views"),d(S,"class","separator svelte-16jifoe"),d(P,"class","date"),d(g,"class","metadata svelte-16jifoe"),d(u,"class","info svelte-16jifoe"),d(e,"class","video-card svelte-16jifoe"),d(e,"role","button"),d(e,"tabindex","0")},m(K,Z){y(K,e,Z),c(e,t),X.m(t,null),c(t,n),G&&G.m(t,null),c(t,i),c(t,s),c(s,a),c(e,r),c(e,u),c(u,f),c(f,_),c(u,m),c(u,v),c(v,D),c(u,A),c(u,g),c(g,E),c(E,z),c(g,B),q&&q.m(g,null),c(g,C),c(g,S),c(g,j),c(g,P),c(P,I),W||(N=[H(e,"click",l[5]),H(e,"keydown",l[4])],W=!0)},p(K,[Z]){Y===(Y=U(K))&&X?X.p(K,Z):(X.d(1),X=Y(K),X&&(X.c(),X.m(t,n))),ee!==(ee=te(K))&&(G&&G.d(1),G=ee&&ee(K),G&&(G.c(),G.m(t,i))),Z&1&&o!==(o=Kt(K[0].duration)+"")&&T(a,o),Z&1&&h!==(h=K[0].title+"")&&T(_,h),Z&1&&w!==(w=K[0].channel_name+"")&&T(D,w),Z&1&&F!==(F=ft(K[0].view_count)+"")&&T(z,F),K[0].comment_count>0?q?q.p(K,Z):(q=qt(K),q.c(),q.m(g,C)):q&&(q.d(1),q=null),Z&1&&L!==(L=Re(K[0].published_at)+"")&&T(I,L)},i:Q,o:Q,d(K){K&&b(e),X.d(),G&&G.d(),q&&q.d(),W=!1,Ee(N)}}}function hs(l,e,t){let{video:n}=e,{onClick:i=()=>{}}=e,s=!1;function o(){t(2,s=!0)}function a(u){(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),i(n))}const r=()=>i(n);return l.$$set=u=>{"video"in u&&t(0,n=u.video),"onClick"in u&&t(1,i=u.onClick)},[n,i,s,o,a,r]}class _s extends Ue{constructor(e){super(),Ne(this,e,hs,ds,Oe,{video:0,onClick:1})}}function Wt(l,e,t){const n=l.slice();return n[6]=e[t],n}function ps(l){let e,t,n=[],i=new Map,s,o=l[1]>0&&Gt(l),a=fe(l[0]);const r=u=>u[6].video_id;for(let u=0;u<a.length;u+=1){let f=Wt(l,a,u),h=r(f);i.set(h,n[u]=Qt(h,f))}return{c(){o&&o.c(),e=k(),t=p("div");for(let u=0;u<n.length;u+=1)n[u].c();d(t,"class","video-grid svelte-1thvyca")},m(u,f){o&&o.m(u,f),y(u,e,f),y(u,t,f);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(t,null);s=!0},p(u,f){u[1]>0?o?o.p(u,f):(o=Gt(u),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),f&5&&(a=fe(u[0]),pt(),n=Gl(n,f,r,1,u,a,i,t,pn,Qt,null,Wt),mt())},i(u){if(!s){for(let f=0;f<a.length;f+=1)ae(n[f]);s=!0}},o(u){for(let f=0;f<n.length;f+=1)pe(n[f]);s=!1},d(u){u&&(b(e),b(t)),o&&o.d(u);for(let f=0;f<n.length;f+=1)n[f].d()}}}function ms(l){let e;function t(s,o){return s[5]?Cs:ks}let n=t(l),i=n(l);return{c(){e=p("div"),i.c(),d(e,"class","empty svelte-1thvyca")},m(s,o){y(s,e,o),i.m(e,null)},p(s,o){n!==(n=t(s))&&(i.d(1),i=n(s),i&&(i.c(),i.m(e,null)))},i:Q,o:Q,d(s){s&&b(e),i.d()}}}function vs(l){let e,t,n,i,s;return{c(){e=p("div"),t=p("p"),t.textContent="Error loading videos",n=k(),i=p("p"),s=M(l[4]),d(t,"class","error-title svelte-1thvyca"),d(i,"class","error-message svelte-1thvyca"),d(e,"class","error svelte-1thvyca")},m(o,a){y(o,e,a),c(e,t),c(e,n),c(e,i),c(i,s)},p(o,a){a&16&&T(s,o[4])},i:Q,o:Q,d(o){o&&b(e)}}}function gs(l){let e;return{c(){e=p("div"),e.innerHTML='<div class="spinner svelte-1thvyca"></div> <p class="svelte-1thvyca">Loading videos...</p>',d(e,"class","loading svelte-1thvyca")},m(t,n){y(t,e,n)},p:Q,i:Q,o:Q,d(t){t&&b(e)}}}function Gt(l){let e,t;function n(o,a){return o[5]?ys:bs}let i=n(l),s=i(l);return{c(){e=p("div"),t=p("p"),s.c(),d(t,"class","result-count svelte-1thvyca"),d(e,"class","result-header svelte-1thvyca")},m(o,a){y(o,e,a),c(e,t),s.m(t,null)},p(o,a){i===(i=n(o))&&s?s.p(o,a):(s.d(1),s=i(o),s&&(s.c(),s.m(t,null)))},d(o){o&&b(e),s.d()}}}function bs(l){let e=l[0].length+"",t,n;return{c(){t=M(e),n=M(" videos")},m(i,s){y(i,t,s),y(i,n,s)},p(i,s){s&1&&e!==(e=i[0].length+"")&&T(t,e)},d(i){i&&(b(t),b(n))}}}function ys(l){let e,t=l[0].length+"",n,i,s,o;return{c(){e=M("Showing "),n=M(t),i=M(" of "),s=M(l[1]),o=M(" videos")},m(a,r){y(a,e,r),y(a,n,r),y(a,i,r),y(a,s,r),y(a,o,r)},p(a,r){r&1&&t!==(t=a[0].length+"")&&T(n,t),r&2&&T(s,a[1])},d(a){a&&(b(e),b(n),b(i),b(s),b(o))}}}function Qt(l,e){let t,n,i;return n=new _s({props:{video:e[6],onClick:e[2]}}),{key:l,first:null,c(){t=ht(),We(n.$$.fragment),this.first=t},m(s,o){y(s,t,o),Ve(n,s,o),i=!0},p(s,o){e=s;const a={};o&1&&(a.video=e[6]),o&4&&(a.onClick=e[2]),n.$set(a)},i(s){i||(ae(n.$$.fragment,s),i=!0)},o(s){pe(n.$$.fragment,s),i=!1},d(s){s&&b(t),Ie(n,s)}}}function ks(l){let e,t,n;return{c(){e=p("p"),e.textContent="No videos found in this archive.",t=k(),n=p("p"),n.textContent="Check that videos.tsv exists in the videos/ directory.",d(e,"class","svelte-1thvyca"),d(n,"class","hint svelte-1thvyca")},m(i,s){y(i,e,s),y(i,t,s),y(i,n,s)},d(i){i&&(b(e),b(t),b(n))}}}function Cs(l){let e,t,n;return{c(){e=p("p"),e.textContent="No videos match the current filters.",t=k(),n=p("p"),n.textContent="Try adjusting your search or filter criteria.",d(e,"class","svelte-1thvyca"),d(n,"class","hint svelte-1thvyca")},m(i,s){y(i,e,s),y(i,t,s),y(i,n,s)},d(i){i&&(b(e),b(t),b(n))}}}function ws(l){let e,t,n,i;const s=[gs,vs,ms,ps],o=[];function a(r,u){return r[3]?0:r[4]?1:r[0].length===0?2:3}return t=a(l),n=o[t]=s[t](l),{c(){e=p("div"),n.c(),d(e,"class","video-list-container svelte-1thvyca")},m(r,u){y(r,e,u),o[t].m(e,null),i=!0},p(r,[u]){let f=t;t=a(r),t===f?o[t].p(r,u):(pt(),pe(o[f],1,1,()=>{o[f]=null}),mt(),n=o[t],n?n.p(r,u):(n=o[t]=s[t](r),n.c()),ae(n,1),n.m(e,null))},i(r){i||(ae(n),i=!0)},o(r){pe(n),i=!1},d(r){r&&b(e),o[t].d()}}}function As(l,e,t){let n,{videos:i}=e,{totalVideos:s=0}=e,{onVideoClick:o=()=>{}}=e,{loading:a=!1}=e,{error:r=null}=e;return l.$$set=u=>{"videos"in u&&t(0,i=u.videos),"totalVideos"in u&&t(1,s=u.totalVideos),"onVideoClick"in u&&t(2,o=u.onVideoClick),"loading"in u&&t(3,a=u.loading),"error"in u&&t(4,r=u.error)},l.$$.update=()=>{l.$$.dirty&3&&t(5,n=s>0&&i.length!==s)},[i,s,o,a,r,n]}class Es extends Ue{constructor(e){super(),Ne(this,e,As,ws,Oe,{videos:0,totalVideos:1,onVideoClick:2,loading:3,error:4})}}function Jt(l,e,t){const n=l.slice();return n[21]=e[t],n}function Xt(l){let e,t,n,i,s,o,a,r,u,f;return{c(){e=p("div"),t=p("button"),n=M("Play from Archive"),s=k(),o=p("button"),a=M("Play from YouTube"),d(t,"class","tab svelte-1qmy9il"),d(t,"role","tab"),d(t,"aria-selected",i=l[5]==="local"),d(t,"aria-controls","local-player-panel"),ge(t,"active",l[5]==="local"),d(o,"class","tab svelte-1qmy9il"),d(o,"role","tab"),d(o,"aria-selected",r=l[5]==="youtube"),d(o,"aria-controls","youtube-player-panel"),ge(o,"active",l[5]==="youtube"),d(e,"class","tabs svelte-1qmy9il"),d(e,"role","tablist")},m(h,_){y(h,e,_),c(e,t),c(t,n),c(e,s),c(e,o),c(o,a),u||(f=[H(t,"click",l[15]),H(o,"click",l[16])],u=!0)},p(h,_){_&32&&i!==(i=h[5]==="local")&&d(t,"aria-selected",i),_&32&&ge(t,"active",h[5]==="local"),_&32&&r!==(r=h[5]==="youtube")&&d(o,"aria-selected",r),_&32&&ge(o,"active",h[5]==="youtube")},d(h){h&&b(e),u=!1,Ee(f)}}}function Ms(l){let e,t,n,i,s,o,a,r,u=l[4]&&Zt(l);return{c(){e=p("div"),u&&u.c(),t=k(),n=p("iframe"),Le(n.src,i=l[9]())||d(n,"src",i),d(n,"title",s=l[0].title),d(n,"frameborder","0"),d(n,"allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),n.allowFullscreen=!0,d(n,"style",o=l[4]?"opacity: 0;":""),d(n,"class","svelte-1qmy9il"),d(e,"class","youtube-wrapper svelte-1qmy9il")},m(f,h){y(f,e,h),u&&u.m(e,null),c(e,t),c(e,n),a||(r=H(n,"load",l[12]),a=!0)},p(f,h){f[4]?u?u.p(f,h):(u=Zt(f),u.c(),u.m(e,t)):u&&(u.d(1),u=null),h&1&&s!==(s=f[0].title)&&d(n,"title",s),h&16&&o!==(o=f[4]?"opacity: 0;":"")&&d(n,"style",o)},d(f){f&&b(e),u&&u.d(),a=!1,r()}}}function Ss(l){let e;function t(s,o){return s[2]?Fs:Ds}let n=t(l),i=n(l);return{c(){i.c(),e=ht()},m(s,o){i.m(s,o),y(s,e,o)},p(s,o){n===(n=t(s))&&i?i.p(s,o):(i.d(1),i=n(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){s&&b(e),i.d(s)}}}function Zt(l){let e,t,n,i,s,o;return{c(){e=p("div"),t=p("img"),s=k(),o=p("div"),o.textContent="Loading...",Le(t.src,n=l[8]())||d(t,"src",n),d(t,"alt",i=l[0].title),d(t,"class","thumbnail-placeholder svelte-1qmy9il"),d(o,"class","loading-spinner svelte-1qmy9il"),d(e,"class","youtube-loading svelte-1qmy9il")},m(a,r){y(a,e,r),c(e,t),c(e,s),c(e,o)},p(a,r){r&1&&i!==(i=a[0].title)&&d(t,"alt",i)},d(a){a&&b(e)}}}function Ds(l){let e,t,n,i,s,o,a,r,u=fe(l[6]),f=[];for(let h=0;h<u.length;h+=1)f[h]=$t(Jt(l,u,h));return{c(){e=p("video"),t=p("source");for(let h=0;h<f.length;h+=1)f[h].c();i=p("p"),s=M(`Your browser doesn't support HTML5 video or the MKV format.
              `),o=p("button"),o.textContent="Watch on YouTube",Le(t.src,n=l[7]())||d(t,"src",n),d(o,"class","fallback-button svelte-1qmy9il"),d(i,"class","video-fallback svelte-1qmy9il"),e.controls=!0,d(e,"crossorigin","anonymous"),d(e,"preload","metadata"),d(e,"poster",l[8]()),d(e,"class","svelte-1qmy9il")},m(h,_){y(h,e,_),c(e,t);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(e,null);c(e,i),c(i,s),c(i,o),a||(r=[H(o,"click",l[18]),H(e,"error",l[11]),H(e,"loadstart",Bs),H(e,"loadedmetadata",Ts),H(e,"canplay",Ls)],a=!0)},p(h,_){if(_&1088){u=fe(h[6]);let m;for(m=0;m<u.length;m+=1){const v=Jt(h,u,m);f[m]?f[m].p(v,_):(f[m]=$t(v),f[m].c(),f[m].m(e,i))}for(;m<f.length;m+=1)f[m].d(1);f.length=u.length}},d(h){h&&b(e),$e(f,h),a=!1,Ee(r)}}}function Fs(l){let e,t,n,i,s,o,a,r,u,f;return{c(){e=p("div"),t=p("p"),t.textContent="⚠️ Video Playback Error",n=k(),i=p("p"),s=M(l[3]),o=k(),a=p("div"),r=p("button"),r.textContent="Watch on YouTube instead",d(t,"class","error-title svelte-1qmy9il"),d(i,"class","error-details svelte-1qmy9il"),d(r,"class","error-button svelte-1qmy9il"),d(a,"class","error-actions svelte-1qmy9il"),d(e,"class","video-error-message svelte-1qmy9il")},m(h,_){y(h,e,_),c(e,t),c(e,n),c(e,i),c(i,s),c(e,o),c(e,a),c(a,r),u||(f=H(r,"click",l[17]),u=!0)},p(h,_){_&8&&T(s,h[3])},d(h){h&&b(e),u=!1,f()}}}function $t(l){let e,t,n,i;return{c(){e=p("track"),d(e,"kind","subtitles"),Le(e.src,t=l[10](l[21]))||d(e,"src",t),d(e,"srclang",n=l[21]),d(e,"label",i=l[21].toUpperCase())},m(s,o){y(s,e,o)},p(s,o){o&64&&!Le(e.src,t=s[10](s[21]))&&d(e,"src",t),o&64&&n!==(n=s[21])&&d(e,"srclang",n),o&64&&i!==(i=s[21].toUpperCase())&&d(e,"label",i)},d(s){s&&b(e)}}}function js(l){let e,t,n,i,s,o,a=l[1]&&Xt(l);function r(h,_){if(h[5]==="local"&&h[1])return Ss;if(h[5]==="youtube")return Ms}let u=r(l),f=u&&u(l);return{c(){e=p("div"),a&&a.c(),t=k(),n=p("div"),i=p("div"),f&&f.c(),d(i,"class","tab-content svelte-1qmy9il"),d(i,"role","tabpanel"),d(i,"id",s=l[5]==="local"?"local-player-panel":"youtube-player-panel"),d(i,"aria-labelledby",o=l[5]==="local"?"local-tab":"youtube-tab"),d(n,"class","tab-content-wrapper svelte-1qmy9il"),d(e,"class","video-player svelte-1qmy9il")},m(h,_){y(h,e,_),a&&a.m(e,null),c(e,t),c(e,n),c(n,i),f&&f.m(i,null)},p(h,[_]){h[1]?a?a.p(h,_):(a=Xt(h),a.c(),a.m(e,t)):a&&(a.d(1),a=null),u===(u=r(h))&&f?f.p(h,_):(f&&f.d(1),f=u&&u(h),f&&(f.c(),f.m(i,null))),_&32&&s!==(s=h[5]==="local"?"local-player-panel":"youtube-player-panel")&&d(i,"id",s),_&32&&o!==(o=h[5]==="local"?"local-tab":"youtube-tab")&&d(i,"aria-labelledby",o)},i:Q,o:Q,d(h){h&&b(e),a&&a.d(),f&&f.d()}}}function Bs(){console.log("[VideoPlayer] Video load started")}function Ts(){console.log("[VideoPlayer] Video metadata loaded")}function Ls(){console.log("[VideoPlayer] Video can play")}function zs(l,e,t){let n,i,{video:s}=e,{channelDir:o=void 0}=e,a=!1,r=!1,u="",f=!0;function h(){const C=s.file_path||s.video_id,S=o?`../${o}/videos/${C}/video.mkv`:`../videos/${C}/video.mkv`;return console.log("[VideoPlayer] Video path:",S,"channelDir:",o,"download_status:",s.download_status),S}function _(){if(s.download_status!=="downloaded"&&s.download_status!=="tracked")return s.thumbnail_url;const C=s.file_path||s.video_id;return o?`../${o}/videos/${C}/thumbnail.jpg`:`../videos/${C}/thumbnail.jpg`}function m(){return`https://www.youtube.com/embed/${s.video_id}`}function v(C){const S=s.file_path||s.video_id;return o?`../${o}/videos/${S}/video.${C}.vtt`:`../videos/${S}/video.${C}.vtt`}function w(C){t(2,r=!0);const S=C.target,j=S.error;if(console.error("[VideoPlayer] Video error event:",{error:j?{code:j.code,message:j.message}:"no error object",src:S.src,networkState:S.networkState,readyState:S.readyState}),j)switch(j.code){case j.MEDIA_ERR_ABORTED:t(3,u="Video loading was aborted. Please try again.");break;case j.MEDIA_ERR_NETWORK:t(3,u="Network error while loading video. Check your connection.");break;case j.MEDIA_ERR_DECODE:t(3,u="Video file is corrupted or in an unsupported format.");break;case j.MEDIA_ERR_SRC_NOT_SUPPORTED:t(3,u="Video file could not be loaded. You may need to run `git annex get` to download the file, or your browser may not support MKV format.");break;default:t(3,u="An unknown error occurred while loading the video.")}}function D(){t(4,f=!1)}function A(C){t(5,n=C),C==="local"?(t(2,r=!1),t(3,u="")):t(4,f=!0)}async function g(){const C=h(),S=await bn(C);t(1,a=S),console.log(S?"[VideoPlayer] Local video available:":"[VideoPlayer] Local video not available:",C)}_t(()=>{g()});const E=()=>A("local"),F=()=>A("youtube"),z=()=>A("youtube"),B=()=>A("youtube");return l.$$set=C=>{"video"in C&&t(0,s=C.video),"channelDir"in C&&t(14,o=C.channelDir)},l.$$.update=()=>{l.$$.dirty&1&&s&&(t(1,a=!1),t(2,r=!1),t(3,u=""),g()),l.$$.dirty&2&&t(5,n=a?"local":"youtube"),l.$$.dirty&1&&t(6,i=s.captions_available||[])},[s,a,r,u,f,n,i,h,_,m,v,w,D,A,o,E,F,z,B]}class Ps extends Ue{constructor(e){super(),Ne(this,e,zs,js,Oe,{video:0,channelDir:14})}}function xt(l,e,t){const n=l.slice();return n[7]=e[t],n}function el(l,e,t){const n=l.slice();return n[10]=e[t],n}function Vs(l){const e=l.slice(),t=e[1]!==void 0?e[1]:e[0].length;e[4]=t;const n=e[0].length>0;e[5]=n;const i=e[5]||e[1]===void 0;return e[6]=i,e}function tl(l){let e,t=l[4].toLocaleString()+"",n,i,s=l[4]!==1?"s":"",o,a,r,u,f=!l[6]&&l[1]!==void 0&&l[1]>0&&ll();function h(v,w){return v[5]?Rs:Os}let _=h(l),m=_(l);return{c(){e=p("h3"),n=M(t),i=M(" Comment"),o=M(s),a=k(),f&&f.c(),r=k(),m.c(),u=ht(),d(e,"class","svelte-799on6")},m(v,w){y(v,e,w),c(e,n),c(e,i),c(e,o),c(e,a),f&&f.m(e,null),y(v,r,w),m.m(v,w),y(v,u,w)},p(v,w){w&3&&t!==(t=v[4].toLocaleString()+"")&&T(n,t),w&3&&s!==(s=v[4]!==1?"s":"")&&T(o,s),!v[6]&&v[1]!==void 0&&v[1]>0?f||(f=ll(),f.c(),f.m(e,null)):f&&(f.d(1),f=null),_===(_=h(v))&&m?m.p(v,w):(m.d(1),m=_(v),m&&(m.c(),m.m(u.parentNode,u)))},d(v){v&&(b(e),b(r),b(u)),f&&f.d(),m.d(v)}}}function Is(l){let e,t,n;return{c(){e=p("h3"),e.textContent="Loading comments...",t=k(),n=p("div"),n.innerHTML='<div class="spinner svelte-799on6"></div>',d(e,"class","svelte-799on6"),d(n,"class","loading-spinner svelte-799on6")},m(i,s){y(i,e,s),y(i,t,s),y(i,n,s)},p:Q,d(i){i&&(b(e),b(t),b(n))}}}function ll(l){let e;return{c(){e=p("span"),e.textContent="(not fetched)",d(e,"class","not-fetched svelte-799on6")},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function Rs(l){let e,t=fe(l[3]),n=[];for(let i=0;i<t.length;i+=1)n[i]=al(xt(l,t,i));return{c(){e=p("div");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","comments-list svelte-799on6")},m(i,s){y(i,e,s);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(i,s){if(s&8){t=fe(i[3]);let o;for(o=0;o<t.length;o+=1){const a=xt(i,t,o);n[o]?n[o].p(a,s):(n[o]=al(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(i){i&&b(e),$e(n,i)}}}function Os(l){let e;function t(s,o){return s[1]!==void 0&&s[1]>0?Us:Ns}let n=t(l),i=n(l);return{c(){e=p("p"),i.c(),d(e,"class","no-comments svelte-799on6")},m(s,o){y(s,e,o),i.m(e,null)},p(s,o){n!==(n=t(s))&&(i.d(1),i=n(s),i&&(i.c(),i.m(e,null)))},d(s){s&&b(e),i.d()}}}function nl(l){let e,t,n=l[7].like_count.toLocaleString()+"",i;return{c(){e=p("span"),t=M("👍 "),i=M(n),d(e,"class","likes svelte-799on6")},m(s,o){y(s,e,o),c(e,t),c(e,i)},p(s,o){o&8&&n!==(n=s[7].like_count.toLocaleString()+"")&&T(i,n)},d(s){s&&b(e)}}}function sl(l){let e,t,n=l[7].replies.length+"",i,s,o=l[7].replies.length===1?"reply":"replies",a,r,u,f=fe(l[7].replies),h=[];for(let _=0;_<f.length;_+=1)h[_]=ol(el(l,f,_));return{c(){e=p("details"),t=p("summary"),i=M(n),s=k(),a=M(o),r=k(),u=p("div");for(let _=0;_<h.length;_+=1)h[_].c();d(t,"class","replies-summary svelte-799on6"),d(u,"class","replies svelte-799on6"),d(e,"class","replies-details svelte-799on6"),e.open=!0},m(_,m){y(_,e,m),c(e,t),c(t,i),c(t,s),c(t,a),c(e,r),c(e,u);for(let v=0;v<h.length;v+=1)h[v]&&h[v].m(u,null)},p(_,m){if(m&8&&n!==(n=_[7].replies.length+"")&&T(i,n),m&8&&o!==(o=_[7].replies.length===1?"reply":"replies")&&T(a,o),m&8){f=fe(_[7].replies);let v;for(v=0;v<f.length;v+=1){const w=el(_,f,v);h[v]?h[v].p(w,m):(h[v]=ol(w),h[v].c(),h[v].m(u,null))}for(;v<h.length;v+=1)h[v].d(1);h.length=f.length}},d(_){_&&b(e),$e(h,_)}}}function il(l){let e,t,n=l[10].like_count.toLocaleString()+"",i;return{c(){e=p("span"),t=M("👍 "),i=M(n),d(e,"class","likes svelte-799on6")},m(s,o){y(s,e,o),c(e,t),c(e,i)},p(s,o){o&8&&n!==(n=s[10].like_count.toLocaleString()+"")&&T(i,n)},d(s){s&&b(e)}}}function ol(l){let e,t,n,i=l[10].author+"",s,o,a,r=Re(l[10].timestamp)+"",u,f,h,_=l[10].text+"",m,v,w,D,A=l[10].like_count>0&&il(l);return{c(){e=p("div"),t=p("div"),n=p("span"),s=M(i),o=k(),a=p("span"),u=M(r),f=k(),h=p("div"),m=M(_),v=k(),w=p("div"),A&&A.c(),D=k(),d(n,"class","author svelte-799on6"),d(a,"class","timestamp svelte-799on6"),d(t,"class","comment-header svelte-799on6"),d(h,"class","comment-text svelte-799on6"),d(w,"class","comment-meta svelte-799on6"),d(e,"class","comment reply svelte-799on6")},m(g,E){y(g,e,E),c(e,t),c(t,n),c(n,s),c(t,o),c(t,a),c(a,u),c(e,f),c(e,h),c(h,m),c(e,v),c(e,w),A&&A.m(w,null),c(e,D)},p(g,E){E&8&&i!==(i=g[10].author+"")&&T(s,i),E&8&&r!==(r=Re(g[10].timestamp)+"")&&T(u,r),E&8&&_!==(_=g[10].text+"")&&T(m,_),g[10].like_count>0?A?A.p(g,E):(A=il(g),A.c(),A.m(w,null)):A&&(A.d(1),A=null)},d(g){g&&b(e),A&&A.d()}}}function al(l){let e,t,n,i=l[7].author+"",s,o,a,r=Re(l[7].timestamp)+"",u,f,h,_=l[7].text+"",m,v,w,D,A,g=l[7].like_count>0&&nl(l),E=l[7].replies&&l[7].replies.length>0&&sl(l);return{c(){e=p("div"),t=p("div"),n=p("span"),s=M(i),o=k(),a=p("span"),u=M(r),f=k(),h=p("div"),m=M(_),v=k(),w=p("div"),g&&g.c(),D=k(),E&&E.c(),A=k(),d(n,"class","author svelte-799on6"),d(a,"class","timestamp svelte-799on6"),d(t,"class","comment-header svelte-799on6"),d(h,"class","comment-text svelte-799on6"),d(w,"class","comment-meta svelte-799on6"),d(e,"class","comment svelte-799on6")},m(F,z){y(F,e,z),c(e,t),c(t,n),c(n,s),c(t,o),c(t,a),c(a,u),c(e,f),c(e,h),c(h,m),c(e,v),c(e,w),g&&g.m(w,null),c(e,D),E&&E.m(e,null),c(e,A)},p(F,z){z&8&&i!==(i=F[7].author+"")&&T(s,i),z&8&&r!==(r=Re(F[7].timestamp)+"")&&T(u,r),z&8&&_!==(_=F[7].text+"")&&T(m,_),F[7].like_count>0?g?g.p(F,z):(g=nl(F),g.c(),g.m(w,null)):g&&(g.d(1),g=null),F[7].replies&&F[7].replies.length>0?E?E.p(F,z):(E=sl(F),E.c(),E.m(e,A)):E&&(E.d(1),E=null)},d(F){F&&b(e),g&&g.d(),E&&E.d()}}}function Ns(l){let e;return{c(){e=M("No comments available for this video.")},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function Us(l){let e;return{c(){e=M("Comments were not fetched for this video. Enable comments in the archive configuration to download them.")},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function Hs(l){let e;function t(o,a){return o[2]?Is:tl}function n(o,a){return a===tl?Vs(o):o}let i=t(l),s=i(n(l,i));return{c(){e=p("div"),s.c(),d(e,"class","comments-section svelte-799on6")},m(o,a){y(o,e,a),s.m(e,null)},p(o,[a]){i===(i=t(o))&&s?s.p(n(o,i),a):(s.d(1),s=i(n(o,i)),s&&(s.c(),s.m(e,null)))},i:Q,o:Q,d(o){o&&b(e),s.d()}}}function Ks(l){const e=new Map,t=[];return l.forEach(n=>{e.set(n.comment_id,{...n,replies:[]})}),l.forEach(n=>{const i=e.get(n.comment_id);if(n.parent==="root")t.push(i);else{const s=e.get(n.parent);s?s.replies.push(i):t.push(i)}}),t}function Ys(l,e,t){let n,{comments:i}=e,{commentCount:s=void 0}=e,{loading:o=!1}=e;return l.$$set=a=>{"comments"in a&&t(0,i=a.comments),"commentCount"in a&&t(1,s=a.commentCount),"loading"in a&&t(2,o=a.loading)},l.$$.update=()=>{l.$$.dirty&1&&t(3,n=Ks(i))},[i,s,o,n]}class qs extends Ue{constructor(e){super(),Ne(this,e,Ys,Hs,Oe,{comments:0,commentCount:1,loading:2})}}function rl(l){let e,t,n,i,s,o=new Date(l[2].published_at).toLocaleDateString()+"",a,r,u,f,h,_=hl(l[2].duration)+"",m,v,w,D,A,g=l[2].download_status+"",E,F,z,B,C,S=l[2].tags&&l[2].tags.length>0&&cl(l),j=l[2].categories&&l[2].categories.length>0&&ul(l),P=l[2].captions_available.length>0&&fl(l),L=l[2].description&&dl(l);return{c(){e=p("div"),t=p("div"),n=p("div"),i=p("strong"),i.textContent="Published:",s=k(),a=M(o),r=k(),u=p("div"),f=p("strong"),f.textContent="Duration:",h=k(),m=M(_),v=k(),w=p("div"),D=p("strong"),D.textContent="Download Status:",A=k(),E=M(g),F=k(),S&&S.c(),z=k(),j&&j.c(),B=k(),P&&P.c(),C=k(),L&&L.c(),d(i,"class","svelte-1dygxzj"),d(f,"class","svelte-1dygxzj"),d(D,"class","svelte-1dygxzj"),d(t,"class","details-meta svelte-1dygxzj"),d(e,"class","details-content svelte-1dygxzj")},m(I,W){y(I,e,W),c(e,t),c(t,n),c(n,i),c(n,s),c(n,a),c(t,r),c(t,u),c(u,f),c(u,h),c(u,m),c(t,v),c(t,w),c(w,D),c(w,A),c(w,E),c(t,F),S&&S.m(t,null),c(t,z),j&&j.m(t,null),c(t,B),P&&P.m(t,null),c(t,C),L&&L.m(t,null)},p(I,W){W&4&&o!==(o=new Date(I[2].published_at).toLocaleDateString()+"")&&T(a,o),W&4&&_!==(_=hl(I[2].duration)+"")&&T(m,_),W&4&&g!==(g=I[2].download_status+"")&&T(E,g),I[2].tags&&I[2].tags.length>0?S?S.p(I,W):(S=cl(I),S.c(),S.m(t,z)):S&&(S.d(1),S=null),I[2].categories&&I[2].categories.length>0?j?j.p(I,W):(j=ul(I),j.c(),j.m(t,B)):j&&(j.d(1),j=null),I[2].captions_available.length>0?P?P.p(I,W):(P=fl(I),P.c(),P.m(t,C)):P&&(P.d(1),P=null),I[2].description?L?L.p(I,W):(L=dl(I),L.c(),L.m(t,null)):L&&(L.d(1),L=null)},d(I){I&&b(e),S&&S.d(),j&&j.d(),P&&P.d(),L&&L.d()}}}function cl(l){let e,t,n,i=l[2].tags.join(", ")+"",s;return{c(){e=p("div"),t=p("strong"),t.textContent="Tags:",n=k(),s=M(i),d(t,"class","svelte-1dygxzj")},m(o,a){y(o,e,a),c(e,t),c(e,n),c(e,s)},p(o,a){a&4&&i!==(i=o[2].tags.join(", ")+"")&&T(s,i)},d(o){o&&b(e)}}}function ul(l){let e,t,n,i=l[2].categories.join(", ")+"",s;return{c(){e=p("div"),t=p("strong"),t.textContent="Categories:",n=k(),s=M(i),d(t,"class","svelte-1dygxzj")},m(o,a){y(o,e,a),c(e,t),c(e,n),c(e,s)},p(o,a){a&4&&i!==(i=o[2].categories.join(", ")+"")&&T(s,i)},d(o){o&&b(e)}}}function fl(l){let e,t,n,i=l[2].captions_available.join(", ")+"",s;return{c(){e=p("div"),t=p("strong"),t.textContent="Captions:",n=k(),s=M(i),d(t,"class","svelte-1dygxzj")},m(o,a){y(o,e,a),c(e,t),c(e,n),c(e,s)},p(o,a){a&4&&i!==(i=o[2].captions_available.join(", ")+"")&&T(s,i)},d(o){o&&b(e)}}}function dl(l){let e,t,n,i,s=l[2].description+"",o;return{c(){e=p("div"),t=p("strong"),t.textContent="Description:",n=k(),i=p("p"),o=M(s),d(t,"class","svelte-1dygxzj"),d(i,"class","svelte-1dygxzj"),d(e,"class","description-text svelte-1dygxzj")},m(a,r){y(a,e,r),c(e,t),c(e,n),c(e,i),c(i,o)},p(a,r){r&4&&s!==(s=a[2].description+"")&&T(o,s)},d(a){a&&b(e)}}}function Ws(l){let e,t,n,i,s,o,a,r,u=l[2].title+"",f,h,_,m,v,w=l[2].channel_name+"",D,A,g,E,F,z=ft(l[2].view_count)+"",B,C,S,j,P,L=Re(l[2].published_at)+"",I,W,N,U,Y,X,te,ee,G,q=l[2].like_count.toLocaleString()+"",K,Z,Me,Ke,re,$,be=l[5]?"▼":"▶",we,R,J,ce,ye,ue,de,Fe;s=new Ps({props:{video:l[2],channelDir:l[1]}});let le=l[5]&&rl(l);return ye=new qs({props:{comments:l[3],commentCount:l[2].comment_count,loading:l[4]}}),{c(){e=p("div"),t=p("button"),t.textContent="← Back to list",n=k(),i=p("div"),We(s.$$.fragment),o=k(),a=p("div"),r=p("h1"),f=M(u),h=k(),_=p("div"),m=p("div"),v=p("span"),D=M(w),A=k(),g=p("span"),g.textContent="•",E=k(),F=p("span"),B=M(z),C=k(),S=p("span"),S.textContent="•",j=k(),P=p("span"),I=M(L),W=k(),N=p("div"),U=p("a"),Y=M("View on YouTube ↗"),te=k(),ee=p("div"),G=p("span"),K=M(q),Z=k(),Me=p("span"),Me.textContent="likes",Ke=k(),re=p("div"),$=p("button"),we=M(be),R=M(" Video Details"),J=k(),le&&le.c(),ce=k(),We(ye.$$.fragment),d(t,"class","back-button svelte-1dygxzj"),d(i,"class","player-container svelte-1dygxzj"),d(r,"class","title svelte-1dygxzj"),d(v,"class","channel-name svelte-1dygxzj"),d(g,"class","separator svelte-1dygxzj"),d(F,"class","views"),d(S,"class","separator svelte-1dygxzj"),d(P,"class","date"),d(m,"class","metadata-left svelte-1dygxzj"),d(U,"href",X=l[2].source_url),d(U,"target","_blank"),d(U,"rel","noopener noreferrer"),d(U,"class","youtube-link svelte-1dygxzj"),d(G,"class","stat-value svelte-1dygxzj"),d(Me,"class","stat-label svelte-1dygxzj"),d(ee,"class","stat svelte-1dygxzj"),d(N,"class","metadata-right svelte-1dygxzj"),d(_,"class","metadata-row svelte-1dygxzj"),d($,"class","details-toggle svelte-1dygxzj"),d(re,"class","details-section svelte-1dygxzj"),d(a,"class","video-info svelte-1dygxzj"),d(e,"class","video-detail svelte-1dygxzj")},m(he,se){y(he,e,se),c(e,t),c(e,n),c(e,i),Ve(s,i,null),c(e,o),c(e,a),c(a,r),c(r,f),c(a,h),c(a,_),c(_,m),c(m,v),c(v,D),c(m,A),c(m,g),c(m,E),c(m,F),c(F,B),c(m,C),c(m,S),c(m,j),c(m,P),c(P,I),c(_,W),c(_,N),c(N,U),c(U,Y),c(N,te),c(N,ee),c(ee,G),c(G,K),c(ee,Z),c(ee,Me),c(a,Ke),c(a,re),c(re,$),c($,we),c($,R),c(re,J),le&&le.m(re,null),c(e,ce),Ve(ye,e,null),ue=!0,de||(Fe=[H(t,"click",function(){Bt(l[0])&&l[0].apply(this,arguments)}),H($,"click",l[7])],de=!0)},p(he,[se]){l=he;const ie={};se&4&&(ie.video=l[2]),se&2&&(ie.channelDir=l[1]),s.$set(ie),(!ue||se&4)&&u!==(u=l[2].title+"")&&T(f,u),(!ue||se&4)&&w!==(w=l[2].channel_name+"")&&T(D,w),(!ue||se&4)&&z!==(z=ft(l[2].view_count)+"")&&T(B,z),(!ue||se&4)&&L!==(L=Re(l[2].published_at)+"")&&T(I,L),(!ue||se&4&&X!==(X=l[2].source_url))&&d(U,"href",X),(!ue||se&4)&&q!==(q=l[2].like_count.toLocaleString()+"")&&T(K,q),(!ue||se&32)&&be!==(be=l[5]?"▼":"▶")&&T(we,be),l[5]?le?le.p(l,se):(le=rl(l),le.c(),le.m(re,null)):le&&(le.d(1),le=null);const Se={};se&8&&(Se.comments=l[3]),se&4&&(Se.commentCount=l[2].comment_count),se&16&&(Se.loading=l[4]),ye.$set(Se)},i(he){ue||(ae(s.$$.fragment,he),ae(ye.$$.fragment,he),ue=!0)},o(he){pe(s.$$.fragment,he),pe(ye.$$.fragment,he),ue=!1},d(he){he&&b(e),Ie(s),le&&le.d(),Ie(ye),de=!1,Ee(Fe)}}}function hl(l){const e=Math.floor(l/3600),t=Math.floor(l%3600/60),n=l%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`:`${t}:${String(n).padStart(2,"0")}`}function Gs(l,e,t){let{video:n}=e,{onBack:i}=e,{channelDir:s=void 0}=e,o=n,a=[],r=!1,u=!1,f=!1;_t(async()=>{try{r=!0,t(2,o=await Be.loadVideoMetadata(n,s))}catch(_){console.warn("Could not load full metadata, using TSV data:",_),t(2,o=n)}finally{r=!1}try{t(4,u=!0),t(3,a=await Be.loadComments(n,s))}catch(_){console.warn("Could not load comments:",_),t(3,a=[])}finally{t(4,u=!1)}});const h=()=>t(5,f=!f);return l.$$set=_=>{"video"in _&&t(6,n=_.video),"onBack"in _&&t(0,i=_.onBack),"channelDir"in _&&t(1,s=_.channelDir)},[i,s,o,a,u,f,n,h]}class Qs extends Ue{constructor(e){super(),Ne(this,e,Gs,Ws,Oe,{video:6,onBack:0,channelDir:1})}}class Js{filter(e,t,n){var s,o;let i=e;if(((s=t.dateRange)!=null&&s.from||(o=t.dateRange)!=null&&o.to)&&(i=i.filter(a=>{var h,_;const r=new Date(a.published_at),u=(h=t.dateRange)!=null&&h.from?new Date(t.dateRange.from):new Date(0),f=(_=t.dateRange)!=null&&_.to?new Date(t.dateRange.to):new Date;return r>=u&&r<=f})),t.channels&&t.channels.length>0&&(i=i.filter(a=>t.channels.includes(a.channel_id))),t.tags&&t.tags.length>0&&(i=i.filter(a=>a.tags.some(r=>t.tags.includes(r)))),t.downloadStatus&&t.downloadStatus.length>0&&(i=i.filter(a=>t.downloadStatus.includes(a.download_status))),t.playlists&&t.playlists.length>0){if(!n||n.length===0)return[];const a=new Set;n.forEach(r=>{t.playlists.includes(r.playlist_id)&&r.video_ids.forEach(u=>a.add(u))}),i=i.filter(r=>a.has(r.video_id))}return i}getUniqueChannels(e){const t=new Map;return e.forEach(n=>{n.channel_id&&!t.has(n.channel_id)&&t.set(n.channel_id,n.channel_name)}),Array.from(t.entries()).map(([n,i])=>({id:n,name:i})).sort((n,i)=>n.name.localeCompare(i.name))}getUniqueTags(e){const t=new Set;return e.forEach(n=>{n.tags&&n.tags.length>0&&n.tags.forEach(i=>t.add(i))}),Array.from(t).sort()}getPlaylistVideoCounts(e,t){const n=new Set(t.map(s=>s.video_id)),i=new Map;return e.forEach(s=>{const o=s.video_ids.filter(a=>n.has(a)).length;i.set(s.playlist_id,o)}),i}}const it=new Js;class Xs{sort(e,t){const n=[...e];return n.sort((i,s)=>{let o=0;switch(t.field){case"views":o=i.view_count-s.view_count;break;case"date":o=new Date(i.published_at).getTime()-new Date(s.published_at).getTime();break;case"duration":o=i.duration-s.duration;break;case"comments":o=i.comment_count-s.comment_count;break;case"title":o=i.title.localeCompare(s.title);break;case"relevance":return 0}return t.direction==="asc"?o:-o}),n}}const Zs=new Xs;class $s{parseHash(e){const t=e.replace(/^#\/?(\?)?/,""),n=new URLSearchParams(t),i=s=>{const o=s==null?void 0:s.split(",").filter(Boolean);return o!=null&&o.length?o:void 0};return{search:n.get("search")||void 0,dateFrom:n.get("from")||void 0,dateTo:n.get("to")||void 0,channels:i(n.get("channels")),tags:i(n.get("tags")),downloadStatus:i(n.get("status")),playlists:i(n.get("playlists")),sortField:n.get("sort")||void 0,sortDirection:n.get("dir")||void 0}}encodeHash(e,t){var o,a,r,u;const n=new URLSearchParams;e.search&&n.set("search",e.search),e.dateFrom&&n.set("from",e.dateFrom),e.dateTo&&n.set("to",e.dateTo),(o=e.channels)!=null&&o.length&&n.set("channels",e.channels.join(",")),(a=e.tags)!=null&&a.length&&n.set("tags",e.tags.join(",")),(r=e.downloadStatus)!=null&&r.length&&n.set("status",e.downloadStatus.join(",")),(u=e.playlists)!=null&&u.length&&n.set("playlists",e.playlists.join(",")),e.sortField&&e.sortField!=="date"&&n.set("sort",e.sortField),e.sortDirection&&e.sortDirection!=="desc"&&n.set("dir",e.sortDirection);const i=n.toString(),s=t||"/";return i?`#${s}?${i}`:`#${s}`}getRoutePrefix(e){const t=e.replace(/^#/,""),n=t.indexOf("?");return n===-1?t||"/":t.substring(0,n)||"/"}updateHash(e){const t=this.getRoutePrefix(window.location.hash),n=this.encodeHash(e,t);history.replaceState(null,"",n)}getCurrentState(){return this.parseHash(window.location.hash)}}const Ct=new $s;function _l(l,e,t){const n=l.slice();return n[43]=e[t],n}function pl(l,e,t){const n=l.slice();return n[46]=e[t],n}function ml(l,e,t){const n=l.slice();return n[49]=e[t],n}function vl(l){let e,t;return{c(){e=p("span"),t=M(l[12]),d(e,"class","count-badge svelte-z58pfr")},m(n,i){y(n,e,i),c(e,t)},p(n,i){i[0]&4096&&T(t,n[12])},d(n){n&&b(e)}}}function gl(l){let e,t,n,i,s,o,a,r,u,f,h,_,m,v,w,D,A,g,E,F,z,B,C,S,j,P,L,I,W,N,U,Y,X,te,ee,G,q,K,Z,Me,Ke,re,$,be,we,R,J,ce,ye=l[1].trim(),ue,de,Fe,le,he,se,ie=l[4].length>0&&bl(l),Se=fe(l[15]),_e=[];for(let O=0;O<Se.length;O+=1)_e[O]=yl(ml(l,Se,O));let me=l[0].length>0&&kl(l),ve=l[14].length>0&&Al(l),ke=ye&&Sl();return{c(){e=p("div"),t=p("div"),n=p("label"),n.textContent="Date Range",i=k(),s=p("div"),o=p("button"),o.textContent="Last Week",a=k(),r=p("button"),r.textContent="Last Month",u=k(),f=p("button"),f.textContent="Last Year",h=k(),_=p("button"),_.textContent="This Year",m=k(),v=p("button"),v.textContent="All Time",w=k(),D=p("div"),A=p("input"),g=k(),E=p("span"),E.textContent="to",F=k(),z=p("input"),B=k(),C=p("div"),S=p("label"),j=M(`Channels
        `),ie&&ie.c(),P=k(),L=p("select");for(let O=0;O<_e.length;O+=1)_e[O].c();I=k(),me&&me.c(),W=k(),ve&&ve.c(),N=k(),U=p("div"),Y=p("label"),Y.textContent="Video Availability",X=k(),te=p("select"),ee=p("option"),ee.textContent="All Videos",G=p("option"),G.textContent="Backup Available (Local)",q=p("option"),q.textContent="Metadata Only",K=k(),Z=p("div"),Me=p("label"),Me.textContent="Sort By",Ke=k(),re=p("div"),$=p("select"),be=p("option"),be.textContent="Date",we=p("option"),we.textContent="Views",R=p("option"),R.textContent="Comments",J=p("option"),J.textContent="Duration",ce=p("option"),ce.textContent="Title",ke&&ke.c(),ue=k(),de=p("select"),Fe=p("option"),Fe.textContent="Descending",le=p("option"),le.textContent="Ascending",d(n,"class","filter-label svelte-z58pfr"),d(o,"type","button"),d(o,"class","preset-btn svelte-z58pfr"),ge(o,"active",l[11]==="week"),d(r,"type","button"),d(r,"class","preset-btn svelte-z58pfr"),ge(r,"active",l[11]==="month"),d(f,"type","button"),d(f,"class","preset-btn svelte-z58pfr"),ge(f,"active",l[11]==="year"),d(_,"type","button"),d(_,"class","preset-btn svelte-z58pfr"),ge(_,"active",l[11]==="thisyear"),d(v,"type","button"),d(v,"class","preset-btn svelte-z58pfr"),ge(v,"active",l[11]==="all"),d(s,"class","date-presets svelte-z58pfr"),d(A,"type","date"),d(A,"class","date-input svelte-z58pfr"),d(A,"title","From date"),d(E,"class","date-separator svelte-z58pfr"),d(z,"type","date"),d(z,"class","date-input svelte-z58pfr"),d(z,"title","To date"),d(D,"class","date-inputs svelte-z58pfr"),d(t,"class","filter-group svelte-z58pfr"),d(S,"class","filter-label svelte-z58pfr"),L.multiple=!0,d(L,"class","multi-select svelte-z58pfr"),d(L,"size","3"),l[4]===void 0&&Te(()=>l[30].call(L)),d(C,"class","filter-group svelte-z58pfr"),d(Y,"class","filter-label svelte-z58pfr"),ee.__value="all",x(ee,ee.__value),G.__value="downloaded",x(G,G.__value),q.__value="metadata_only",x(q,q.__value),d(te,"class","filter-select svelte-z58pfr"),l[6]===void 0&&Te(()=>l[33].call(te)),d(U,"class","filter-group svelte-z58pfr"),d(Me,"class","filter-label svelte-z58pfr"),be.__value="date",x(be,be.__value),we.__value="views",x(we,we.__value),R.__value="comments",x(R,R.__value),J.__value="duration",x(J,J.__value),ce.__value="title",x(ce,ce.__value),d($,"class","sort-select svelte-z58pfr"),l[8]===void 0&&Te(()=>l[34].call($)),Fe.__value="desc",x(Fe,Fe.__value),le.__value="asc",x(le,le.__value),d(de,"class","sort-select svelte-z58pfr"),l[9]===void 0&&Te(()=>l[35].call(de)),d(re,"class","sort-controls svelte-z58pfr"),d(Z,"class","filter-group svelte-z58pfr"),d(e,"class","filters-grid svelte-z58pfr")},m(O,ne){y(O,e,ne),c(e,t),c(t,n),c(t,i),c(t,s),c(s,o),c(s,a),c(s,r),c(s,u),c(s,f),c(s,h),c(s,_),c(s,m),c(s,v),c(t,w),c(t,D),c(D,A),x(A,l[2]),c(D,g),c(D,E),c(D,F),c(D,z),x(z,l[3]),c(e,B),c(e,C),c(C,S),c(S,j),ie&&ie.m(S,null),c(C,P),c(C,L);for(let oe=0;oe<_e.length;oe+=1)_e[oe]&&_e[oe].m(L,null);Ze(L,l[4]),c(e,I),me&&me.m(e,null),c(e,W),ve&&ve.m(e,null),c(e,N),c(e,U),c(U,Y),c(U,X),c(U,te),c(te,ee),c(te,G),c(te,q),Ge(te,l[6],!0),c(e,K),c(e,Z),c(Z,Me),c(Z,Ke),c(Z,re),c(re,$),c($,be),c($,we),c($,R),c($,J),c($,ce),ke&&ke.m($,null),Ge($,l[8],!0),c(re,ue),c(re,de),c(de,Fe),c(de,le),Ge(de,l[9],!0),he||(se=[H(o,"click",l[23]),H(r,"click",l[24]),H(f,"click",l[25]),H(_,"click",l[26]),H(v,"click",l[27]),H(A,"input",l[28]),H(z,"input",l[29]),H(L,"change",l[30]),H(te,"change",l[33]),H($,"change",l[34]),H(de,"change",l[35])],he=!0)},p(O,ne){if(ne[0]&2048&&ge(o,"active",O[11]==="week"),ne[0]&2048&&ge(r,"active",O[11]==="month"),ne[0]&2048&&ge(f,"active",O[11]==="year"),ne[0]&2048&&ge(_,"active",O[11]==="thisyear"),ne[0]&2048&&ge(v,"active",O[11]==="all"),ne[0]&4&&x(A,O[2]),ne[0]&8&&x(z,O[3]),O[4].length>0?ie?ie.p(O,ne):(ie=bl(O),ie.c(),ie.m(S,null)):ie&&(ie.d(1),ie=null),ne[0]&32768){Se=fe(O[15]);let oe;for(oe=0;oe<Se.length;oe+=1){const Lt=ml(O,Se,oe);_e[oe]?_e[oe].p(Lt,ne):(_e[oe]=yl(Lt),_e[oe].c(),_e[oe].m(L,null))}for(;oe<_e.length;oe+=1)_e[oe].d(1);_e.length=Se.length}ne[0]&32784&&Ze(L,O[4]),O[0].length>0?me?me.p(O,ne):(me=kl(O),me.c(),me.m(e,W)):me&&(me.d(1),me=null),O[14].length>0?ve?ve.p(O,ne):(ve=Al(O),ve.c(),ve.m(e,N)):ve&&(ve.d(1),ve=null),ne[0]&64&&Ge(te,O[6]),ne[0]&2&&(ye=O[1].trim()),ye?ke||(ke=Sl(),ke.c(),ke.m($,null)):ke&&(ke.d(1),ke=null),ne[0]&256&&Ge($,O[8]),ne[0]&512&&Ge(de,O[9])},d(O){O&&b(e),ie&&ie.d(),$e(_e,O),me&&me.d(),ve&&ve.d(),ke&&ke.d(),he=!1,Ee(se)}}}function bl(l){let e,t=l[4].length+"",n;return{c(){e=p("span"),n=M(t),d(e,"class","count-badge svelte-z58pfr")},m(i,s){y(i,e,s),c(e,n)},p(i,s){s[0]&16&&t!==(t=i[4].length+"")&&T(n,t)},d(i){i&&b(e)}}}function yl(l){let e,t=l[49].name+"",n,i;return{c(){e=p("option"),n=M(t),e.__value=i=l[49].id,x(e,e.__value)},m(s,o){y(s,e,o),c(e,n)},p(s,o){o[0]&32768&&t!==(t=s[49].name+"")&&T(n,t),o[0]&32768&&i!==(i=s[49].id)&&(e.__value=i,x(e,e.__value))},d(s){s&&b(e)}}}function kl(l){let e,t,n,i,s,o,a,r=l[7].length>0&&Cl(l),u=fe(l[0]),f=[];for(let h=0;h<u.length;h+=1)f[h]=wl(pl(l,u,h));return{c(){e=p("div"),t=p("label"),n=M(`Playlists
          `),r&&r.c(),i=k(),s=p("select");for(let h=0;h<f.length;h+=1)f[h].c();d(t,"class","filter-label svelte-z58pfr"),s.multiple=!0,d(s,"class","multi-select svelte-z58pfr"),d(s,"size","3"),l[7]===void 0&&Te(()=>l[31].call(s)),d(e,"class","filter-group svelte-z58pfr")},m(h,_){y(h,e,_),c(e,t),c(t,n),r&&r.m(t,null),c(e,i),c(e,s);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(s,null);Ze(s,l[7]),o||(a=H(s,"change",l[31]),o=!0)},p(h,_){if(h[7].length>0?r?r.p(h,_):(r=Cl(h),r.c(),r.m(t,null)):r&&(r.d(1),r=null),_[0]&8193){u=fe(h[0]);let m;for(m=0;m<u.length;m+=1){const v=pl(h,u,m);f[m]?f[m].p(v,_):(f[m]=wl(v),f[m].c(),f[m].m(s,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=u.length}_[0]&129&&Ze(s,h[7])},d(h){h&&b(e),r&&r.d(),$e(f,h),o=!1,a()}}}function Cl(l){let e,t=l[7].length+"",n;return{c(){e=p("span"),n=M(t),d(e,"class","count-badge svelte-z58pfr")},m(i,s){y(i,e,s),c(e,n)},p(i,s){s[0]&128&&t!==(t=i[7].length+"")&&T(n,t)},d(i){i&&b(e)}}}function wl(l){let e,t=l[46].title+"",n,i,s=(l[13].get(l[46].playlist_id)||0)+"",o,a,r;return{c(){e=p("option"),n=M(t),i=M(" ("),o=M(s),a=M(`)
            `),e.__value=r=l[46].playlist_id,x(e,e.__value)},m(u,f){y(u,e,f),c(e,n),c(e,i),c(e,o),c(e,a)},p(u,f){f[0]&1&&t!==(t=u[46].title+"")&&T(n,t),f[0]&8193&&s!==(s=(u[13].get(u[46].playlist_id)||0)+"")&&T(o,s),f[0]&1&&r!==(r=u[46].playlist_id)&&(e.__value=r,x(e,e.__value))},d(u){u&&b(e)}}}function Al(l){let e,t,n,i,s,o,a,r=l[5].length>0&&El(l),u=fe(l[14]),f=[];for(let h=0;h<u.length;h+=1)f[h]=Ml(_l(l,u,h));return{c(){e=p("div"),t=p("label"),n=M(`Tags
          `),r&&r.c(),i=k(),s=p("select");for(let h=0;h<f.length;h+=1)f[h].c();d(t,"class","filter-label svelte-z58pfr"),s.multiple=!0,d(s,"class","multi-select svelte-z58pfr"),d(s,"size","3"),l[5]===void 0&&Te(()=>l[32].call(s)),d(e,"class","filter-group svelte-z58pfr")},m(h,_){y(h,e,_),c(e,t),c(t,n),r&&r.m(t,null),c(e,i),c(e,s);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(s,null);Ze(s,l[5]),o||(a=H(s,"change",l[32]),o=!0)},p(h,_){if(h[5].length>0?r?r.p(h,_):(r=El(h),r.c(),r.m(t,null)):r&&(r.d(1),r=null),_[0]&16384){u=fe(h[14]);let m;for(m=0;m<u.length;m+=1){const v=_l(h,u,m);f[m]?f[m].p(v,_):(f[m]=Ml(v),f[m].c(),f[m].m(s,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=u.length}_[0]&16416&&Ze(s,h[5])},d(h){h&&b(e),r&&r.d(),$e(f,h),o=!1,a()}}}function El(l){let e,t=l[5].length+"",n;return{c(){e=p("span"),n=M(t),d(e,"class","count-badge svelte-z58pfr")},m(i,s){y(i,e,s),c(e,n)},p(i,s){s[0]&32&&t!==(t=i[5].length+"")&&T(n,t)},d(i){i&&b(e)}}}function Ml(l){let e,t=l[43]+"",n,i;return{c(){e=p("option"),n=M(t),e.__value=i=l[43],x(e,e.__value)},m(s,o){y(s,e,o),c(e,n)},p(s,o){o[0]&16384&&t!==(t=s[43]+"")&&T(n,t),o[0]&16384&&i!==(i=s[43])&&(e.__value=i,x(e,e.__value))},d(s){s&&b(e)}}}function Sl(l){let e;return{c(){e=p("option"),e.textContent="Relevance",e.__value="relevance",x(e,e.__value)},m(t,n){y(t,e,n)},d(t){t&&b(e)}}}function Dl(l){let e,t,n,i,s,o,a;return{c(){e=p("div"),t=p("button"),n=M("Clear All Filters ("),i=M(l[12]),s=M(")"),d(t,"class","clear-button svelte-z58pfr"),d(e,"class","footer svelte-z58pfr")},m(r,u){y(r,e,u),c(e,t),c(t,n),c(t,i),c(t,s),o||(a=H(t,"click",l[16]),o=!0)},p(r,u){u[0]&4096&&T(i,r[12])},d(r){r&&b(e),o=!1,a()}}}function xs(l){let e,t,n,i,s,o,a,r,u=l[10]?"▼":"▶",f,h,_,m,v,w,D=l[12]>0&&!l[10]&&vl(l),A=l[10]&&gl(l),g=l[12]>0&&Dl(l);return{c(){e=p("div"),t=p("div"),n=p("label"),n.textContent="Search",i=k(),s=p("input"),o=k(),a=p("button"),r=p("span"),f=M(u),h=M(`
    Filters
    `),D&&D.c(),_=k(),A&&A.c(),m=k(),g&&g.c(),d(n,"for","search-input"),d(n,"class","search-label svelte-z58pfr"),d(s,"id","search-input"),d(s,"type","text"),d(s,"placeholder","Search videos, channels, tags..."),d(s,"class","search-input svelte-z58pfr"),d(t,"class","search-section svelte-z58pfr"),d(r,"class","toggle-icon svelte-z58pfr"),d(a,"class","filters-toggle svelte-z58pfr"),d(e,"class","filter-panel svelte-z58pfr")},m(E,F){y(E,e,F),c(e,t),c(t,n),c(t,i),c(t,s),x(s,l[1]),c(e,o),c(e,a),c(a,r),c(r,f),c(a,h),D&&D.m(a,null),c(e,_),A&&A.m(e,null),c(e,m),g&&g.m(e,null),v||(w=[H(s,"input",l[21]),H(a,"click",l[22])],v=!0)},p(E,F){F[0]&2&&s.value!==E[1]&&x(s,E[1]),F[0]&1024&&u!==(u=E[10]?"▼":"▶")&&T(f,u),E[12]>0&&!E[10]?D?D.p(E,F):(D=vl(E),D.c(),D.m(a,null)):D&&(D.d(1),D=null),E[10]?A?A.p(E,F):(A=gl(E),A.c(),A.m(e,m)):A&&(A.d(1),A=null),E[12]>0?g?g.p(E,F):(g=Dl(E),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},i:Q,o:Q,d(E){E&&b(e),D&&D.d(),A&&A.d(),g&&g.d(),v=!1,Ee(w)}}}function ei(l,e){return l.search===e.search&&l.dateFrom===e.dateFrom&&l.dateTo===e.dateTo&&ot(l.channels,e.channels)&&ot(l.tags,e.tags)&&ot(l.downloadStatus,e.downloadStatus)&&ot(l.playlists,e.playlists)&&l.sortField===e.sortField&&l.sortDirection===e.sortDirection}function ot(l,e){if(l===e)return!0;if(l==null||e==null)return l===e;if(l.length!==e.length)return!1;for(let t=0;t<l.length;t++)if(l[t]!==e[t])return!1;return!0}function ti(l,e,t){let n,i,s,o,a,{videos:r}=e,{playlists:u=[]}=e,{onFilterChange:f}=e,h="",_="",m="",v=[],w=[],D="all",A=[],g="date",E="desc";function F(){const R=Ct.getCurrentState();t(1,h=R.search||""),t(2,_=R.dateFrom||""),t(3,m=R.dateTo||""),t(4,v=R.channels||[]),t(5,w=R.tags||[]),t(7,A=R.playlists||[]),t(8,g=R.sortField||"date"),t(9,E=R.sortDirection||"desc"),R.downloadStatus?R.downloadStatus.includes("downloaded")?t(6,D="downloaded"):R.downloadStatus.includes("metadata_only")?t(6,D="metadata_only"):t(6,D="all"):t(6,D="all")}async function z(){S=!0,F(),P(),await It(),S=!1}_t(async()=>{F(),window.addEventListener("hashchange",z),P(),await It(),S=!1}),fn(()=>{window.removeEventListener("hashchange",z)});let B=!0,C=null,S=!0,j;function P(){let R=r;h.trim()&&(R=jt.search(h).map(ce=>ce.video)),R=it.filter(R,{dateRange:_||m?{from:_||"1970-01-01",to:m||new Date().toISOString().split("T")[0]}:void 0,channels:v.length>0?v:void 0,tags:w.length>0?w:void 0,downloadStatus:n.length>0?n:void 0,playlists:A.length>0?A:void 0},u),R=Zs.sort(R,{field:g,direction:E}),I(),f(R)}let L;function I(){S||(clearTimeout(L),L=setTimeout(()=>{const R={search:h||void 0,dateFrom:_||void 0,dateTo:m||void 0,channels:v.length>0?v:void 0,tags:w.length>0?w:void 0,downloadStatus:n.length>0?n:void 0,playlists:A.length>0?A:void 0,sortField:g,sortDirection:E},J=Ct.getCurrentState();ei(J,R)||Ct.updateHash(R)},500))}function W(){t(1,h=""),t(2,_=""),t(3,m=""),t(4,v=[]),t(5,w=[]),t(6,D="all"),t(7,A=[]),t(8,g="date"),t(9,E="desc")}function N(R){const J=new Date,ce=J.toISOString().split("T")[0];switch(t(11,C=R),R){case"week":const ye=new Date(J.getTime()-6048e5);t(2,_=ye.toISOString().split("T")[0]),t(3,m=ce);break;case"month":const ue=new Date(J.getFullYear(),J.getMonth()-1,J.getDate());t(2,_=ue.toISOString().split("T")[0]),t(3,m=ce);break;case"year":const de=new Date(J.getFullYear()-1,J.getMonth(),J.getDate());t(2,_=de.toISOString().split("T")[0]),t(3,m=ce);break;case"thisyear":t(2,_=`${J.getFullYear()}-01-01`),t(3,m=ce);break;case"lastyear":t(2,_=`${J.getFullYear()-1}-01-01`),t(3,m=`${J.getFullYear()-1}-12-31`);break;case"all":t(2,_=""),t(3,m="");break}}function U(){h=this.value,t(1,h)}const Y=()=>t(10,B=!B),X=()=>N("week"),te=()=>N("month"),ee=()=>N("year"),G=()=>N("thisyear"),q=()=>N("all");function K(){_=this.value,t(2,_)}function Z(){m=this.value,t(3,m)}function Me(){v=gt(this),t(4,v),t(15,i),t(18,r)}function Ke(){A=gt(this),t(7,A),t(0,u)}function re(){w=gt(this),t(5,w),t(14,s),t(18,r)}function $(){D=vt(this),t(6,D)}function be(){g=vt(this),t(8,g)}function we(){E=vt(this),t(9,E)}return l.$$set=R=>{"videos"in R&&t(18,r=R.videos),"playlists"in R&&t(0,u=R.playlists),"onFilterChange"in R&&t(19,f=R.onFilterChange)},l.$$.update=()=>{l.$$.dirty[0]&64&&(n=D==="all"?[]:D==="downloaded"?["downloaded"]:D==="metadata_only"?["metadata_only"]:[]),l.$$.dirty[0]&262144&&t(15,i=it.getUniqueChannels(r)),l.$$.dirty[0]&262144&&t(14,s=it.getUniqueTags(r)),l.$$.dirty[0]&262145&&t(13,o=it.getPlaylistVideoCounts(u,r)),l.$$.dirty[0]&1048578&&(clearTimeout(j),t(20,j=setTimeout(()=>{P()},300))),l.$$.dirty[0]&1020&&P(),l.$$.dirty[0]&254&&t(12,a=[h.length>0,_.length>0||m.length>0,v.length>0,w.length>0,D!=="all",A.length>0].filter(Boolean).length),l.$$.dirty[0]&12},[u,h,_,m,v,w,D,A,g,E,B,C,a,o,s,i,W,N,r,f,j,U,Y,X,te,ee,G,q,K,Z,Me,Ke,re,$,be,we]}class li extends Ue{constructor(e){super(),Ne(this,e,ti,xs,Oe,{videos:18,playlists:0,onFilterChange:19},null,[-1,-1])}}function Fl(l,e,t){const n=l.slice();return n[5]=e[t],n}function ni(l){let e,t=[],n=new Map,i=fe(l[0]);const s=o=>o[5].channel_id;for(let o=0;o<i.length;o+=1){let a=Fl(l,i,o),r=s(a);n.set(r,t[o]=Il(r,a))}return{c(){e=p("div");for(let o=0;o<t.length;o+=1)t[o].c();d(e,"class","channels-grid svelte-600xjp")},m(o,a){y(o,e,a);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(e,null)},p(o,a){a&9&&(i=fe(o[0]),t=Gl(t,a,s,1,o,i,n,e,_n,Il,null,Fl))},d(o){o&&b(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function si(l){let e;return{c(){e=p("div"),e.innerHTML='<p>📁 No channels found</p> <p class="empty-hint svelte-600xjp">Add channel archives to this collection</p>',d(e,"class","empty svelte-600xjp")},m(t,n){y(t,e,n)},p:Q,d(t){t&&b(e)}}}function ii(l){let e,t,n,i,s;return{c(){e=p("div"),t=p("p"),t.textContent="❌ Error loading channels",n=k(),i=p("p"),s=M(l[2]),d(i,"class","error-message svelte-600xjp"),d(e,"class","error svelte-600xjp")},m(o,a){y(o,e,a),c(e,t),c(e,n),c(e,i),c(i,s)},p(o,a){a&4&&T(s,o[2])},d(o){o&&b(e)}}}function oi(l){let e;return{c(){e=p("div"),e.textContent="Loading channels...",d(e,"class","loading svelte-600xjp")},m(t,n){y(t,e,n)},p:Q,d(t){t&&b(e)}}}function ai(l){let e;return{c(){e=p("div"),e.textContent="📺",d(e,"class","channel-icon svelte-600xjp")},m(t,n){y(t,e,n)},p:Q,d(t){t&&b(e)}}}function ri(l){let e,t,n,i,s;return{c(){e=p("img"),i=k(),s=p("div"),s.textContent="📺",Le(e.src,t=l[5].avatar_url)||d(e,"src",t),d(e,"alt",n=l[5].name+" avatar"),d(e,"class","channel-avatar svelte-600xjp"),d(e,"onerror","this.style.display='none'; this.nextElementSibling.style.display='block';"),d(s,"class","channel-icon-fallback svelte-600xjp"),un(s,"display","none")},m(o,a){y(o,e,a),y(o,i,a),y(o,s,a)},p(o,a){a&1&&!Le(e.src,t=o[5].avatar_url)&&d(e,"src",t),a&1&&n!==(n=o[5].name+" avatar")&&d(e,"alt",n)},d(o){o&&(b(e),b(i),b(s))}}}function jl(l){let e,t,n=l[5].custom_url+"",i;return{c(){e=p("p"),t=M("@"),i=M(n),d(e,"class","channel-url svelte-600xjp")},m(s,o){y(s,e,o),c(e,t),c(e,i)},p(s,o){o&1&&n!==(n=s[5].custom_url+"")&&T(i,n)},d(s){s&&b(e)}}}function Bl(l){let e,t=l[5].description+"",n;return{c(){e=p("p"),n=M(t),d(e,"class","channel-description svelte-600xjp")},m(i,s){y(i,e,s),c(e,n)},p(i,s){s&1&&t!==(t=i[5].description+"")&&T(n,t)},d(i){i&&b(e)}}}function Tl(l){let e,t,n=dt(l[5].archive_stats.total_videos_archived)+"",i,s,o,a,r,u,f=l[5].archive_stats.total_duration_seconds>0&&Ll(l),h=l[5].archive_stats.total_size_bytes>0&&zl(l);return{c(){e=p("div"),t=p("span"),i=M(n),s=k(),o=p("span"),o.textContent="videos",a=k(),f&&f.c(),r=k(),h&&h.c(),u=ht(),d(t,"class","stat-value svelte-600xjp"),d(o,"class","stat-label svelte-600xjp"),d(e,"class","stat svelte-600xjp")},m(_,m){y(_,e,m),c(e,t),c(t,i),c(e,s),c(e,o),y(_,a,m),f&&f.m(_,m),y(_,r,m),h&&h.m(_,m),y(_,u,m)},p(_,m){m&1&&n!==(n=dt(_[5].archive_stats.total_videos_archived)+"")&&T(i,n),_[5].archive_stats.total_duration_seconds>0?f?f.p(_,m):(f=Ll(_),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null),_[5].archive_stats.total_size_bytes>0?h?h.p(_,m):(h=zl(_),h.c(),h.m(u.parentNode,u)):h&&(h.d(1),h=null)},d(_){_&&(b(e),b(a),b(r),b(u)),f&&f.d(_),h&&h.d(_)}}}function Ll(l){let e,t,n=Rl(l[5].archive_stats.total_duration_seconds)+"",i,s,o;return{c(){e=p("div"),t=p("span"),i=M(n),s=k(),o=p("span"),o.textContent="duration",d(t,"class","stat-value svelte-600xjp"),d(o,"class","stat-label svelte-600xjp"),d(e,"class","stat svelte-600xjp")},m(a,r){y(a,e,r),c(e,t),c(t,i),c(e,s),c(e,o)},p(a,r){r&1&&n!==(n=Rl(a[5].archive_stats.total_duration_seconds)+"")&&T(i,n)},d(a){a&&b(e)}}}function zl(l){let e,t,n=Ol(l[5].archive_stats.total_size_bytes)+"",i,s,o;return{c(){e=p("div"),t=p("span"),i=M(n),s=k(),o=p("span"),o.textContent="size",d(t,"class","stat-value svelte-600xjp"),d(o,"class","stat-label svelte-600xjp"),d(e,"class","stat svelte-600xjp")},m(a,r){y(a,e,r),c(e,t),c(t,i),c(e,s),c(e,o)},p(a,r){r&1&&n!==(n=Ol(a[5].archive_stats.total_size_bytes)+"")&&T(i,n)},d(a){a&&b(e)}}}function Pl(l){let e,t,n=dt(l[5].subscriber_count)+"",i,s,o;return{c(){e=p("div"),t=p("span"),i=M(n),s=k(),o=p("span"),o.textContent="subscribers",d(t,"class","stat-value svelte-600xjp"),d(o,"class","stat-label svelte-600xjp"),d(e,"class","stat svelte-600xjp")},m(a,r){y(a,e,r),c(e,t),c(t,i),c(e,s),c(e,o)},p(a,r){r&1&&n!==(n=dt(a[5].subscriber_count)+"")&&T(i,n)},d(a){a&&b(e)}}}function Vl(l){let e,t=at(l[5].archive_stats.first_video_date)+"",n,i,s=at(l[5].archive_stats.last_video_date)+"",o;return{c(){e=p("div"),n=M(t),i=M(" — "),o=M(s),d(e,"class","channel-date-range svelte-600xjp")},m(a,r){y(a,e,r),c(e,n),c(e,i),c(e,o)},p(a,r){r&1&&t!==(t=at(a[5].archive_stats.first_video_date)+"")&&T(n,t),r&1&&s!==(s=at(a[5].archive_stats.last_video_date)+"")&&T(o,s)},d(a){a&&b(e)}}}function Il(l,e){var W,N;let t,n,i,s,o,a=(e[5].name||e[5].channel_id)+"",r,u,f,h,_,m,v,w,D,A,g,E;function F(U,Y){return U[5].avatar_url?ri:ai}let z=F(e),B=z(e),C=e[5].custom_url&&jl(e),S=e[5].description&&Bl(e),j=e[5].archive_stats&&Tl(e),P=e[5].subscriber_count>0&&Pl(e),L=(((W=e[5].archive_stats)==null?void 0:W.first_video_date)||((N=e[5].archive_stats)==null?void 0:N.last_video_date))&&Vl(e);function I(){return e[4](e[5])}return{key:l,first:null,c(){t=p("a"),n=p("div"),B.c(),i=k(),s=p("div"),o=p("h3"),r=M(a),u=k(),C&&C.c(),f=k(),S&&S.c(),h=k(),_=p("div"),j&&j.c(),m=k(),P&&P.c(),v=k(),L&&L.c(),w=k(),d(o,"class","channel-name svelte-600xjp"),d(s,"class","channel-info svelte-600xjp"),d(n,"class","channel-header svelte-600xjp"),d(_,"class","channel-stats svelte-600xjp"),d(t,"href",D="#/channel/"+e[5].channel_dir),d(t,"class","channel-card svelte-600xjp"),d(t,"title",A=e[5].description||e[5].name),this.first=t},m(U,Y){y(U,t,Y),c(t,n),B.m(n,null),c(n,i),c(n,s),c(s,o),c(o,r),c(s,u),C&&C.m(s,null),c(t,f),S&&S.m(t,null),c(t,h),c(t,_),j&&j.m(_,null),c(_,m),P&&P.m(_,null),c(t,v),L&&L.m(t,null),c(t,w),g||(E=H(t,"click",rn(I)),g=!0)},p(U,Y){var X,te;e=U,z===(z=F(e))&&B?B.p(e,Y):(B.d(1),B=z(e),B&&(B.c(),B.m(n,i))),Y&1&&a!==(a=(e[5].name||e[5].channel_id)+"")&&T(r,a),e[5].custom_url?C?C.p(e,Y):(C=jl(e),C.c(),C.m(s,null)):C&&(C.d(1),C=null),e[5].description?S?S.p(e,Y):(S=Bl(e),S.c(),S.m(t,h)):S&&(S.d(1),S=null),e[5].archive_stats?j?j.p(e,Y):(j=Tl(e),j.c(),j.m(_,m)):j&&(j.d(1),j=null),e[5].subscriber_count>0?P?P.p(e,Y):(P=Pl(e),P.c(),P.m(_,null)):P&&(P.d(1),P=null),(X=e[5].archive_stats)!=null&&X.first_video_date||(te=e[5].archive_stats)!=null&&te.last_video_date?L?L.p(e,Y):(L=Vl(e),L.c(),L.m(t,w)):L&&(L.d(1),L=null),Y&1&&D!==(D="#/channel/"+e[5].channel_dir)&&d(t,"href",D),Y&1&&A!==(A=e[5].description||e[5].name)&&d(t,"title",A)},d(U){U&&b(t),B.d(),C&&C.d(),S&&S.d(),j&&j.d(),P&&P.d(),L&&L.d(),g=!1,E()}}}function ci(l){let e;function t(s,o){return s[1]?oi:s[2]?ii:s[0].length===0?si:ni}let n=t(l),i=n(l);return{c(){e=p("div"),i.c(),d(e,"class","channel-list svelte-600xjp")},m(s,o){y(s,e,o),i.m(e,null)},p(s,[o]){n===(n=t(s))&&i?i.p(s,o):(i.d(1),i=n(s),i&&(i.c(),i.m(e,null)))},i:Q,o:Q,d(s){s&&b(e),i.d()}}}function dt(l){return l>=1e6?`${(l/1e6).toFixed(1)}M`:l>=1e3?`${(l/1e3).toFixed(1)}K`:l.toString()}function Rl(l){if(l===0)return"0s";const e=Math.floor(l/3600),t=Math.floor(l%3600/60);return e>0?`${e}h ${t}m`:t>0?`${t}m`:`${l}s`}function Ol(l){if(l===0)return"0 B";const e=["B","KB","MB","GB","TB"],t=Math.floor(Math.log(l)/Math.log(1024));return`${(l/Math.pow(1024,t)).toFixed(1)} ${e[t]}`}function at(l){if(!l)return"Unknown";try{return new Date(l).toLocaleDateString()}catch{return l}}function ui(l,e,t){let{channels:n=[]}=e,{loading:i=!1}=e,{error:s=null}=e,{onChannelClick:o=()=>{}}=e;const a=r=>o(r);return l.$$set=r=>{"channels"in r&&t(0,n=r.channels),"loading"in r&&t(1,i=r.loading),"error"in r&&t(2,s=r.error),"onChannelClick"in r&&t(3,o=r.onChannelClick)},[n,i,s,o,a]}class fi extends Ue{constructor(e){super(),Ne(this,e,ui,ci,Oe,{channels:0,loading:1,error:2,onChannelClick:3})}}function Nl(l){let e,t,n;return{c(){e=p("button"),e.textContent="← Back to channels",d(e,"class","back-button svelte-8c02cr")},m(i,s){y(i,e,s),t||(n=H(e,"click",l[10]),t=!0)},p:Q,d(i){i&&b(e),t=!1,n()}}}function di(l){let e=l[3].length+"",t,n,i=l[3].length!==1?"s":"",s,o;return{c(){t=M(e),n=M(" video"),s=M(i),o=M(" archived")},m(a,r){y(a,t,r),y(a,n,r),y(a,s,r),y(a,o,r)},p(a,r){r&8&&e!==(e=a[3].length+"")&&T(t,e),r&8&&i!==(i=a[3].length!==1?"s":"")&&T(s,i)},d(a){a&&(b(t),b(n),b(s),b(o))}}}function hi(l){let e=l[1].length+"",t,n,i=l[1].length!==1?"s":"",s,o;return{c(){t=M(e),n=M(" channel"),s=M(i),o=M(" in collection")},m(a,r){y(a,t,r),y(a,n,r),y(a,s,r),y(a,o,r)},p(a,r){r&2&&e!==(e=a[1].length+"")&&T(t,e),r&2&&i!==(i=a[1].length!==1?"s":"")&&T(s,i)},d(a){a&&(b(t),b(n),b(s),b(o))}}}function _i(l){let e,t,n,i=!l[6]&&!l[7]&&Ul(l);return t=new Es({props:{videos:l[4],totalVideos:l[3].length,loading:l[6],error:l[7],onVideoClick:l[11]}}),{c(){i&&i.c(),e=k(),We(t.$$.fragment)},m(s,o){i&&i.m(s,o),y(s,e,o),Ve(t,s,o),n=!0},p(s,o){!s[6]&&!s[7]?i?(i.p(s,o),o&192&&ae(i,1)):(i=Ul(s),i.c(),ae(i,1),i.m(e.parentNode,e)):i&&(pt(),pe(i,1,1,()=>{i=null}),mt());const a={};o&16&&(a.videos=s[4]),o&8&&(a.totalVideos=s[3].length),o&64&&(a.loading=s[6]),o&128&&(a.error=s[7]),t.$set(a)},i(s){n||(ae(i),ae(t.$$.fragment,s),n=!0)},o(s){pe(i),pe(t.$$.fragment,s),n=!1},d(s){s&&b(e),i&&i.d(s),Ie(t,s)}}}function pi(l){let e,t;return e=new fi({props:{channels:l[1],loading:l[6],error:l[7],onChannelClick:l[9]}}),{c(){We(e.$$.fragment)},m(n,i){Ve(e,n,i),t=!0},p(n,i){const s={};i&2&&(s.channels=n[1]),i&64&&(s.loading=n[6]),i&128&&(s.error=n[7]),e.$set(s)},i(n){t||(ae(e.$$.fragment,n),t=!0)},o(n){pe(e.$$.fragment,n),t=!1},d(n){Ie(e,n)}}}function mi(l){var n;let e,t;return e=new Qs({props:{video:l[8],onBack:l[12],channelDir:(n=l[2])==null?void 0:n.channel_dir}}),{c(){We(e.$$.fragment)},m(i,s){Ve(e,i,s),t=!0},p(i,s){var a;const o={};s&256&&(o.video=i[8]),s&4&&(o.channelDir=(a=i[2])==null?void 0:a.channel_dir),e.$set(o)},i(i){t||(ae(e.$$.fragment,i),t=!0)},o(i){pe(e.$$.fragment,i),t=!1},d(i){Ie(e,i)}}}function Ul(l){let e,t;return e=new li({props:{videos:l[3],playlists:l[5],onFilterChange:l[13]}}),{c(){We(e.$$.fragment)},m(n,i){Ve(e,n,i),t=!0},p(n,i){const s={};i&8&&(s.videos=n[3]),i&32&&(s.playlists=n[5]),e.$set(s)},i(n){t||(ae(e.$$.fragment,n),t=!0)},o(n){pe(e.$$.fragment,n),t=!1},d(n){Ie(e,n)}}}function vi(l){let e,t,n,i,s,o,a,r,u,f,h,_,m,v,w=l[2]&&Nl(l);function D(B,C){if(B[0]&&!B[2])return hi;if(!B[6]&&!B[7])return di}let A=D(l),g=A&&A(l);const E=[mi,pi,_i],F=[];function z(B,C){return B[8]?0:B[0]&&!B[2]?1:2}return _=z(l),m=F[_]=E[_](l),{c(){e=p("main"),t=p("header"),n=p("div"),w&&w.c(),i=k(),s=p("h1"),o=M("📹 YouTube Archive Browser "),a=p("span"),a.textContent="v0.2.2",r=k(),u=p("p"),g&&g.c(),f=k(),h=p("div"),m.c(),d(a,"class","version svelte-8c02cr"),d(s,"class","svelte-8c02cr"),d(u,"class","subtitle svelte-8c02cr"),d(n,"class","header-content svelte-8c02cr"),d(t,"class","svelte-8c02cr"),d(h,"class","container svelte-8c02cr"),d(e,"class","svelte-8c02cr")},m(B,C){y(B,e,C),c(e,t),c(t,n),w&&w.m(n,null),c(n,i),c(n,s),c(s,o),c(s,a),c(n,r),c(n,u),g&&g.m(u,null),c(e,f),c(e,h),F[_].m(h,null),v=!0},p(B,[C]){B[2]?w?w.p(B,C):(w=Nl(B),w.c(),w.m(n,i)):w&&(w.d(1),w=null),A===(A=D(B))&&g?g.p(B,C):(g&&g.d(1),g=A&&A(B),g&&(g.c(),g.m(u,null)));let S=_;_=z(B),_===S?F[_].p(B,C):(pt(),pe(F[S],1,1,()=>{F[S]=null}),mt(),m=F[_],m?m.p(B,C):(m=F[_]=E[_](B),m.c()),ae(m,1),m.m(h,null))},i(B){v||(ae(m),v=!0)},o(B){pe(m),v=!1},d(B){B&&b(e),w&&w.d(),g&&g.d(),F[_].d()}}}function gi(l,e,t){let n=!1,i=[],s=null,o=[],a=[],r=[],u=!0,f=null;Pe.getCurrentRoute();let h=null;_t(async()=>{try{if(t(0,n=await Be.isMultiChannelMode()),n)t(1,i=await Be.loadChannels()),t(6,u=!1);else{t(3,o=await Be.loadVideos()),t(4,a=o),jt.initialize(o);try{t(5,r=await Be.loadPlaylists())}catch(g){console.warn("Could not load playlists:",g),t(5,r=[])}t(6,u=!1)}}catch(g){t(7,f=g instanceof Error?g.message:"Unknown error loading archive"),t(6,u=!1)}Pe.subscribe(async g=>{if(g.name==="video"){const E=g.params.video_id,F=g.params.channel_dir;if(F&&n){const z=i.find(B=>B.channel_dir===F);z&&z.channel_dir!==(s==null?void 0:s.channel_dir)&&await _(z)}if(t(8,h=o.find(z=>z.video_id===E)||null),!h)try{t(8,h=await Be.loadVideoMetadata(E))}catch(z){console.warn("Could not load video metadata:",z),t(8,h=null)}}else if(g.name==="channel"&&n){const E=g.params.channel_dir,F=i.find(z=>z.channel_dir===E);F&&await _(F),t(8,h=null)}else t(8,h=null)})});async function _(g){t(6,u=!0),t(2,s=g);try{t(3,o=await Be.loadChannelVideos(g.channel_dir)),t(4,a=o),jt.initialize(o);try{t(5,r=await Be.loadChannelPlaylists(g.channel_dir))}catch(E){console.warn("Could not load playlists for channel:",E),t(5,r=[])}t(6,u=!1)}catch(E){t(7,f=E instanceof Error?E.message:"Unknown error loading channel"),t(6,u=!1)}}function m(g){Pe.navigate("channel",{channel_dir:g.channel_dir})}function v(){Pe.navigate("home"),t(2,s=null),t(3,o=[]),t(4,a=[]),t(5,r=[]),t(7,f=null)}function w(g){s?Pe.navigate("video",{video_id:g.video_id,channel_dir:s.channel_dir}):Pe.navigate("video",{video_id:g.video_id})}function D(){s?Pe.navigate("channel",{channel_dir:s.channel_dir}):Pe.navigate("home")}function A(g){t(4,a=g)}return[n,i,s,o,a,r,u,f,h,m,v,w,D,A]}class bi extends Ue{constructor(e){super(),Ne(this,e,gi,vi,Oe,{})}}new bi({target:document.getElementById("app")});
