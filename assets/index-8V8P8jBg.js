var kl=Object.defineProperty;var Cl=(s,e,t)=>e in s?kl(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Me=(s,e,t)=>Cl(s,typeof e!="symbol"?e+"":e,t);import{P as wl,S as Re,i as Ve,s as Pe,n as oe,d as w,r as Ke,a as B,b as A,c,l as H,e as p,f as b,t as M,g as h,h as je,j as be,k as _e,m as tt,o as lt,p as pe,u as Al,q as He,v as Ue,w as ht,x as qe,y as El,z as he,A as We,B as ul,C as Ml,D as J,E as Ye,F as Ie,G as Ne,H as st,I as nt}from"./vendor-Bsl8QWlC.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wl);function mt(s){const e=s.split(/\r?\n/);if(e.length<2)return[];const t=e[0].split("	");return e.slice(1).filter(l=>l.trim()).map(l=>{const n=l.split("	");return Object.fromEntries(t.map((i,o)=>[i,n[o]||""]))})}function Oe(s,e=0){const t=parseInt(s,10);return isNaN(t)?e:t}const it="/annextubetesting/";function Sl(){return window.location.protocol==="file:"}class Dl{constructor(e){Me(this,"baseUrl");Me(this,"videosCache",null);Me(this,"playlistsCache",null);Me(this,"metadataCache",new Map);Me(this,"commentsCache",new Map);e?this.baseUrl=e:Sl()?this.baseUrl="..":this.baseUrl=it.endsWith("/")?it.slice(0,-1):it,console.log(`DataLoader initialized with baseUrl: ${this.baseUrl}`)}async loadVideos(){if(this.videosCache)return this.videosCache;const e=await fetch(`${this.baseUrl}/videos/videos.tsv`);if(!e.ok)throw new Error(`Failed to load videos.tsv: ${e.statusText}`);const t=await e.text(),l=mt(t);return this.videosCache=l.map(n=>this.parseTSVVideo(n)),this.videosCache}async loadPlaylists(){if(this.playlistsCache)return this.playlistsCache;const e=await fetch(`${this.baseUrl}/playlists/playlists.tsv`);if(!e.ok)throw new Error(`Failed to load playlists.tsv: ${e.statusText}`);const t=await e.text(),n=mt(t).map(i=>this.parseTSVPlaylist(i));return await Promise.all(n.map(async i=>{try{const o=await this.loadPlaylistMetadata(i.playlist_id,i.path);i.video_ids=o.video_ids}catch(o){console.warn(`Could not load video_ids for playlist ${i.playlist_id}:`,o)}})),this.playlistsCache=n,this.playlistsCache}async loadVideoMetadata(e){if(this.metadataCache.has(e))return this.metadataCache.get(e);const t=this.getVideoPath(e),l=await fetch(`${this.baseUrl}/videos/${t}/metadata.json`);if(!l.ok)throw new Error(`Failed to load metadata for ${e}: ${l.statusText}`);const n=await l.json();if(this.videosCache){const i=this.videosCache.find(o=>o.video_id===e);i&&(n.file_path=t,n.download_status=i.download_status)}return this.metadataCache.set(e,n),n}async loadComments(e){if(this.commentsCache.has(e))return this.commentsCache.get(e);const t=this.getVideoPath(e),l=await fetch(`${this.baseUrl}/videos/${t}/comments.json`);if(!l.ok){if(l.status===404)return[];throw new Error(`Failed to load comments for ${e}: ${l.statusText}`)}const n=await l.json();return this.commentsCache.set(e,n),n}async loadPlaylistMetadata(e,t){let l=t||"";if(!l&&this.playlistsCache){const i=this.playlistsCache.find(o=>o.playlist_id===e);i&&i.path&&(l=i.path)}if(!l)throw new Error(`Cannot load playlist metadata for ${e}: path not found in cache`);const n=await fetch(`${this.baseUrl}/playlists/${l}/playlist.json`);if(!n.ok)throw new Error(`Failed to load playlist metadata for ${e}: ${n.statusText}`);return await n.json()}getCaptionPath(e,t){const l=this.getVideoPath(e);return`${this.baseUrl}/videos/${l}/caption_${t}.vtt`}getVideoPath(e){if(this.videosCache){const t=this.videosCache.find(l=>l.video_id===e);if(t&&t.file_path)return t.file_path}return e}clearCache(){this.videosCache=null,this.playlistsCache=null,this.metadataCache.clear(),this.commentsCache.clear()}parseTSVVideo(e){return{video_id:e.video_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,published_at:e.published_at,duration:Oe(e.duration),view_count:Oe(e.view_count),like_count:Oe(e.like_count),comment_count:Oe(e.comment_count),thumbnail_url:e.thumbnail_url,download_status:e.download_status,source_url:e.source_url,file_path:e.path||e.video_id,license:"standard",privacy_status:"public",availability:"public",tags:[],categories:[],captions_available:[],has_auto_captions:!1,fetched_at:new Date().toISOString(),updated_at:new Date().toISOString()}}parseTSVPlaylist(e){return{playlist_id:e.playlist_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,video_count:Oe(e.video_count),total_duration:Oe(e.total_duration),privacy_status:e.privacy_status,created_at:e.created_at,last_sync:e.last_sync,path:e.path,video_ids:[],updated_at:e.last_sync,fetched_at:e.last_sync}}}const Ze=new Dl;class Fl{constructor(){Me(this,"listeners",[]);Me(this,"currentRoute",{name:"home",params:{}});window.addEventListener("hashchange",()=>this.handleHashChange()),this.handleHashChange()}subscribe(e){return this.listeners.push(e),e(this.currentRoute),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}navigate(e,t={}){e==="home"?window.location.hash="#/":e==="video"&&(window.location.hash=`#/video/${t.video_id}`)}getCurrentRoute(){return this.currentRoute}handleHashChange(){const e=window.location.hash.slice(1),t=this.parseHash(e);this.currentRoute=t,this.notifyListeners(t)}parseHash(e){const t=e.startsWith("/")?e.slice(1):e;if(!t||t==="/")return{name:"home",params:{}};const l=t.match(/^video\/([^/]+)$/);return l?{name:"video",params:{video_id:l[1]}}:{name:"home",params:{}}}notifyListeners(e){this.listeners.forEach(t=>t(e))}}const Qe=new Fl;function Fe(s){return Array.isArray?Array.isArray(s):hl(s)==="[object Array]"}function Bl(s){if(typeof s=="string")return s;let e=s+"";return e=="0"&&1/s==-1/0?"-0":e}function zl(s){return s==null?"":Bl(s)}function Se(s){return typeof s=="string"}function fl(s){return typeof s=="number"}function Tl(s){return s===!0||s===!1||Ll(s)&&hl(s)=="[object Boolean]"}function dl(s){return typeof s=="object"}function Ll(s){return dl(s)&&s!==null}function ve(s){return s!=null}function ot(s){return!s.trim().length}function hl(s){return s==null?s===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(s)}const jl="Incorrect 'index' type",Rl=s=>`Invalid value for key ${s}`,Vl=s=>`Pattern length exceeds max of ${s}.`,Pl=s=>`Missing ${s} property in key`,Il=s=>`Property 'weight' in key '${s}' must be a positive integer`,gt=Object.prototype.hasOwnProperty;class Ol{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(l=>{let n=_l(l);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight}),this._keys.forEach(l=>{l.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function _l(s){let e=null,t=null,l=null,n=1,i=null;if(Se(s)||Fe(s))l=s,e=vt(s),t=at(s);else{if(!gt.call(s,"name"))throw new Error(Pl("name"));const o=s.name;if(l=o,gt.call(s,"weight")&&(n=s.weight,n<=0))throw new Error(Il(o));e=vt(o),t=at(o),i=s.getFn}return{path:e,id:t,weight:n,src:l,getFn:i}}function vt(s){return Fe(s)?s:s.split(".")}function at(s){return Fe(s)?s.join("."):s}function Nl(s,e){let t=[],l=!1;const n=(i,o,a)=>{if(ve(i))if(!o[a])t.push(i);else{let u=o[a];const r=i[u];if(!ve(r))return;if(a===o.length-1&&(Se(r)||fl(r)||Tl(r)))t.push(zl(r));else if(Fe(r)){l=!0;for(let f=0,d=r.length;f<d;f+=1)n(r[f],o,a+1)}else o.length&&n(r,o,a+1)}};return n(s,Se(e)?e.split("."):e,0),l?t:t[0]}const Hl={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Ul={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(s,e)=>s.score===e.score?s.idx<e.idx?-1:1:s.score<e.score?-1:1},ql={location:0,threshold:.6,distance:100},Yl={useExtendedSearch:!1,getFn:Nl,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var D={...Ul,...Hl,...ql,...Yl};const Kl=/[^ ]+/g;function Wl(s=1,e=3){const t=new Map,l=Math.pow(10,e);return{get(n){const i=n.match(Kl).length;if(t.has(i))return t.get(i);const o=1/Math.pow(i,.5*s),a=parseFloat(Math.round(o*l)/l);return t.set(i,a),a},clear(){t.clear()}}}class _t{constructor({getFn:e=D.getFn,fieldNormWeight:t=D.fieldNormWeight}={}){this.norm=Wl(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,l)=>{this._keysMap[t.id]=l})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,Se(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();Se(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,l=this.size();t<l;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!ve(e)||ot(e))return;let l={v:e,i:t,n:this.norm.get(e)};this.records.push(l)}_addObject(e,t){let l={i:t,$:{}};this.keys.forEach((n,i)=>{let o=n.getFn?n.getFn(e):this.getFn(e,n.path);if(ve(o)){if(Fe(o)){let a=[];const u=[{nestedArrIndex:-1,value:o}];for(;u.length;){const{nestedArrIndex:r,value:f}=u.pop();if(ve(f))if(Se(f)&&!ot(f)){let d={v:f,i:r,n:this.norm.get(f)};a.push(d)}else Fe(f)&&f.forEach((d,_)=>{u.push({nestedArrIndex:_,value:d})})}l.$[i]=a}else if(Se(o)&&!ot(o)){let a={v:o,n:this.norm.get(o)};l.$[i]=a}}}),this.records.push(l)}toJSON(){return{keys:this.keys,records:this.records}}}function pl(s,e,{getFn:t=D.getFn,fieldNormWeight:l=D.fieldNormWeight}={}){const n=new _t({getFn:t,fieldNormWeight:l});return n.setKeys(s.map(_l)),n.setSources(e),n.create(),n}function Gl(s,{getFn:e=D.getFn,fieldNormWeight:t=D.fieldNormWeight}={}){const{keys:l,records:n}=s,i=new _t({getFn:e,fieldNormWeight:t});return i.setKeys(l),i.setIndexRecords(n),i}function Je(s,{errors:e=0,currentLocation:t=0,expectedLocation:l=0,distance:n=D.distance,ignoreLocation:i=D.ignoreLocation}={}){const o=e/s.length;if(i)return o;const a=Math.abs(l-t);return n?o+a/n:a?1:o}function Ql(s=[],e=D.minMatchCharLength){let t=[],l=-1,n=-1,i=0;for(let o=s.length;i<o;i+=1){let a=s[i];a&&l===-1?l=i:!a&&l!==-1&&(n=i-1,n-l+1>=e&&t.push([l,n]),l=-1)}return s[i-1]&&i-l>=e&&t.push([l,i-1]),t}const Le=32;function Jl(s,e,t,{location:l=D.location,distance:n=D.distance,threshold:i=D.threshold,findAllMatches:o=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,includeMatches:u=D.includeMatches,ignoreLocation:r=D.ignoreLocation}={}){if(e.length>Le)throw new Error(Vl(Le));const f=e.length,d=s.length,_=Math.max(0,Math.min(l,d));let m=i,g=_;const k=a>1||u,y=k?Array(d):[];let C;for(;(C=s.indexOf(e,g))>-1;){let P=Je(e,{currentLocation:C,expectedLocation:_,distance:n,ignoreLocation:r});if(m=Math.min(P,m),g=C+f,k){let z=0;for(;z<f;)y[C+z]=1,z+=1}}g=-1;let v=[],E=1,S=f+d;const T=1<<f-1;for(let P=0;P<f;P+=1){let z=0,V=S;for(;z<V;)Je(e,{errors:P,currentLocation:_+V,expectedLocation:_,distance:n,ignoreLocation:r})<=m?z=V:S=V,V=Math.floor((S-z)/2+z);S=V;let I=Math.max(1,_-V+1),F=o?d:Math.min(_+V,d)+f,L=Array(F+2);L[F+1]=(1<<P)-1;for(let q=F;q>=I;q-=1){let K=q-1,te=t[s.charAt(K)];if(k&&(y[K]=+!!te),L[q]=(L[q+1]<<1|1)&te,P&&(L[q]|=(v[q+1]|v[q])<<1|1|v[q+1]),L[q]&T&&(E=Je(e,{errors:P,currentLocation:K,expectedLocation:_,distance:n,ignoreLocation:r}),E<=m)){if(m=E,g=K,g<=_)break;I=Math.max(1,2*_-g)}}if(Je(e,{errors:P+1,currentLocation:_,expectedLocation:_,distance:n,ignoreLocation:r})>m)break;v=L}const O={isMatch:g>=0,score:Math.max(.001,E)};if(k){const P=Ql(y,a);P.length?u&&(O.indices=P):O.isMatch=!1}return O}function Xl(s){let e={};for(let t=0,l=s.length;t<l;t+=1){const n=s.charAt(t);e[n]=(e[n]||0)|1<<l-t-1}return e}const $e=String.prototype.normalize?s=>s.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):s=>s;class ml{constructor(e,{location:t=D.location,threshold:l=D.threshold,distance:n=D.distance,includeMatches:i=D.includeMatches,findAllMatches:o=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,isCaseSensitive:u=D.isCaseSensitive,ignoreDiacritics:r=D.ignoreDiacritics,ignoreLocation:f=D.ignoreLocation}={}){if(this.options={location:t,threshold:l,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:u,ignoreDiacritics:r,ignoreLocation:f},e=u?e:e.toLowerCase(),e=r?$e(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const d=(m,g)=>{this.chunks.push({pattern:m,alphabet:Xl(m),startIndex:g})},_=this.pattern.length;if(_>Le){let m=0;const g=_%Le,k=_-g;for(;m<k;)d(this.pattern.substr(m,Le),m),m+=Le;if(g){const y=_-Le;d(this.pattern.substr(y),y)}}else d(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:l,includeMatches:n}=this.options;if(e=t?e:e.toLowerCase(),e=l?$e(e):e,this.pattern===e){let k={isMatch:!0,score:0};return n&&(k.indices=[[0,e.length-1]]),k}const{location:i,distance:o,threshold:a,findAllMatches:u,minMatchCharLength:r,ignoreLocation:f}=this.options;let d=[],_=0,m=!1;this.chunks.forEach(({pattern:k,alphabet:y,startIndex:C})=>{const{isMatch:v,score:E,indices:S}=Jl(e,k,y,{location:i+C,distance:o,threshold:a,findAllMatches:u,minMatchCharLength:r,includeMatches:n,ignoreLocation:f});v&&(m=!0),_+=E,v&&S&&(d=[...d,...S])});let g={isMatch:m,score:m?_/this.chunks.length:1};return m&&n&&(g.indices=d),g}}class ze{constructor(e){this.pattern=e}static isMultiMatch(e){return bt(e,this.multiRegex)}static isSingleMatch(e){return bt(e,this.singleRegex)}search(){}}function bt(s,e){const t=s.match(e);return t?t[1]:null}class Zl extends ze{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class $l extends ze{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const l=e.indexOf(this.pattern)===-1;return{isMatch:l,score:l?0:1,indices:[0,e.length-1]}}}class xl extends ze{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class es extends ze{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class ts extends ze{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class ls extends ze{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class gl extends ze{constructor(e,{location:t=D.location,threshold:l=D.threshold,distance:n=D.distance,includeMatches:i=D.includeMatches,findAllMatches:o=D.findAllMatches,minMatchCharLength:a=D.minMatchCharLength,isCaseSensitive:u=D.isCaseSensitive,ignoreDiacritics:r=D.ignoreDiacritics,ignoreLocation:f=D.ignoreLocation}={}){super(e),this._bitapSearch=new ml(e,{location:t,threshold:l,distance:n,includeMatches:i,findAllMatches:o,minMatchCharLength:a,isCaseSensitive:u,ignoreDiacritics:r,ignoreLocation:f})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class vl extends ze{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,l;const n=[],i=this.pattern.length;for(;(l=e.indexOf(this.pattern,t))>-1;)t=l+i,n.push([l,t-1]);const o=!!n.length;return{isMatch:o,score:o?0:1,indices:n}}}const rt=[Zl,vl,xl,es,ls,ts,$l,gl],yt=rt.length,ss=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ns="|";function is(s,e={}){return s.split(ns).map(t=>{let l=t.trim().split(ss).filter(i=>i&&!!i.trim()),n=[];for(let i=0,o=l.length;i<o;i+=1){const a=l[i];let u=!1,r=-1;for(;!u&&++r<yt;){const f=rt[r];let d=f.isMultiMatch(a);d&&(n.push(new f(d,e)),u=!0)}if(!u)for(r=-1;++r<yt;){const f=rt[r];let d=f.isSingleMatch(a);if(d){n.push(new f(d,e));break}}}return n})}const os=new Set([gl.type,vl.type]);class as{constructor(e,{isCaseSensitive:t=D.isCaseSensitive,ignoreDiacritics:l=D.ignoreDiacritics,includeMatches:n=D.includeMatches,minMatchCharLength:i=D.minMatchCharLength,ignoreLocation:o=D.ignoreLocation,findAllMatches:a=D.findAllMatches,location:u=D.location,threshold:r=D.threshold,distance:f=D.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:l,includeMatches:n,minMatchCharLength:i,findAllMatches:a,ignoreLocation:o,location:u,threshold:r,distance:f},e=t?e:e.toLowerCase(),e=l?$e(e):e,this.pattern=e,this.query=is(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:l,isCaseSensitive:n,ignoreDiacritics:i}=this.options;e=n?e:e.toLowerCase(),e=i?$e(e):e;let o=0,a=[],u=0;for(let r=0,f=t.length;r<f;r+=1){const d=t[r];a.length=0,o=0;for(let _=0,m=d.length;_<m;_+=1){const g=d[_],{isMatch:k,indices:y,score:C}=g.search(e);if(k){if(o+=1,u+=C,l){const v=g.constructor.type;os.has(v)?a=[...a,...y]:a.push(y)}}else{u=0,o=0,a.length=0;break}}if(o){let _={isMatch:!0,score:u/o};return l&&(_.indices=a),_}}return{isMatch:!1,score:1}}}const ct=[];function rs(...s){ct.push(...s)}function ut(s,e){for(let t=0,l=ct.length;t<l;t+=1){let n=ct[t];if(n.condition(s,e))return new n(s,e)}return new ml(s,e)}const xe={AND:"$and",OR:"$or"},ft={PATH:"$path",PATTERN:"$val"},dt=s=>!!(s[xe.AND]||s[xe.OR]),cs=s=>!!s[ft.PATH],us=s=>!Fe(s)&&dl(s)&&!dt(s),kt=s=>({[xe.AND]:Object.keys(s).map(e=>({[e]:s[e]}))});function bl(s,e,{auto:t=!0}={}){const l=n=>{let i=Object.keys(n);const o=cs(n);if(!o&&i.length>1&&!dt(n))return l(kt(n));if(us(n)){const u=o?n[ft.PATH]:i[0],r=o?n[ft.PATTERN]:n[u];if(!Se(r))throw new Error(Rl(u));const f={keyId:at(u),pattern:r};return t&&(f.searcher=ut(r,e)),f}let a={children:[],operator:i[0]};return i.forEach(u=>{const r=n[u];Fe(r)&&r.forEach(f=>{a.children.push(l(f))})}),a};return dt(s)||(s=kt(s)),l(s)}function fs(s,{ignoreFieldNorm:e=D.ignoreFieldNorm}){s.forEach(t=>{let l=1;t.matches.forEach(({key:n,norm:i,score:o})=>{const a=n?n.weight:null;l*=Math.pow(o===0&&a?Number.EPSILON:o,(a||1)*(e?1:i))}),t.score=l})}function ds(s,e){const t=s.matches;e.matches=[],ve(t)&&t.forEach(l=>{if(!ve(l.indices)||!l.indices.length)return;const{indices:n,value:i}=l;let o={indices:n,value:i};l.key&&(o.key=l.key.src),l.idx>-1&&(o.refIndex=l.idx),e.matches.push(o)})}function hs(s,e){e.score=s.score}function _s(s,e,{includeMatches:t=D.includeMatches,includeScore:l=D.includeScore}={}){const n=[];return t&&n.push(ds),l&&n.push(hs),s.map(i=>{const{idx:o}=i,a={item:e[o],refIndex:o};return n.length&&n.forEach(u=>{u(i,a)}),a})}class Ge{constructor(e,t={},l){this.options={...D,...t},this.options.useExtendedSearch,this._keyStore=new Ol(this.options.keys),this.setCollection(e,l)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof _t))throw new Error(jl);this._myIndex=t||pl(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){ve(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let l=0,n=this._docs.length;l<n;l+=1){const i=this._docs[l];e(i,l)&&(this.removeAt(l),l-=1,n-=1,t.push(i))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:l,includeScore:n,shouldSort:i,sortFn:o,ignoreFieldNorm:a}=this.options;let u=Se(e)?Se(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return fs(u,{ignoreFieldNorm:a}),i&&u.sort(o),fl(t)&&t>-1&&(u=u.slice(0,t)),_s(u,this._docs,{includeMatches:l,includeScore:n})}_searchStringList(e){const t=ut(e,this.options),{records:l}=this._myIndex,n=[];return l.forEach(({v:i,i:o,n:a})=>{if(!ve(i))return;const{isMatch:u,score:r,indices:f}=t.searchIn(i);u&&n.push({item:i,idx:o,matches:[{score:r,value:i,norm:a,indices:f}]})}),n}_searchLogical(e){const t=bl(e,this.options),l=(a,u,r)=>{if(!a.children){const{keyId:d,searcher:_}=a,m=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(u,d),searcher:_});return m&&m.length?[{idx:r,item:u,matches:m}]:[]}const f=[];for(let d=0,_=a.children.length;d<_;d+=1){const m=a.children[d],g=l(m,u,r);if(g.length)f.push(...g);else if(a.operator===xe.AND)return[]}return f},n=this._myIndex.records,i={},o=[];return n.forEach(({$:a,i:u})=>{if(ve(a)){let r=l(t,a,u);r.length&&(i[u]||(i[u]={idx:u,item:a,matches:[]},o.push(i[u])),r.forEach(({matches:f})=>{i[u].matches.push(...f)}))}}),o}_searchObjectList(e){const t=ut(e,this.options),{keys:l,records:n}=this._myIndex,i=[];return n.forEach(({$:o,i:a})=>{if(!ve(o))return;let u=[];l.forEach((r,f)=>{u.push(...this._findMatches({key:r,value:o[f],searcher:t}))}),u.length&&i.push({idx:a,item:o,matches:u})}),i}_findMatches({key:e,value:t,searcher:l}){if(!ve(t))return[];let n=[];if(Fe(t))t.forEach(({v:i,i:o,n:a})=>{if(!ve(i))return;const{isMatch:u,score:r,indices:f}=l.searchIn(i);u&&n.push({score:r,key:e,value:i,idx:o,norm:a,indices:f})});else{const{v:i,n:o}=t,{isMatch:a,score:u,indices:r}=l.searchIn(i);a&&n.push({score:u,key:e,value:i,norm:o,indices:r})}return n}}Ge.version="7.1.0";Ge.createIndex=pl;Ge.parseIndex=Gl;Ge.config=D;Ge.parseQuery=bl;rs(as);class ps{constructor(){Me(this,"fuse",null);Me(this,"videos",[])}initialize(e){this.videos=e,this.fuse=new Ge(e,{keys:[{name:"title",weight:.4},{name:"channel_name",weight:.2},{name:"tags",weight:.3},{name:"description",weight:.1}],threshold:.3,includeScore:!0,includeMatches:!0,ignoreLocation:!0,minMatchCharLength:2})}search(e,t){if(!this.fuse||!e.trim())return this.videos.map(i=>({video:i,score:0,matches:[]}));const n=this.fuse.search(e).map(i=>{var o;return{video:i.item,score:i.score||0,matches:((o=i.matches)==null?void 0:o.map(a=>a.key||""))||[]}});return t!=null&&t.limit&&t.limit>0?n.slice(0,t.limit):n}clear(){this.fuse=null,this.videos=[]}getIndexedCount(){return this.videos.length}}const yl=new ps;function Ct(s){const e=Math.floor(s/3600),t=Math.floor(s%3600/60),l=s%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(l).padStart(2,"0")}`:`${t}:${String(l).padStart(2,"0")}`}function et(s){return s>=1e9?`${(s/1e9).toFixed(1)}B views`:s>=1e6?`${(s/1e6).toFixed(1)}M views`:s>=1e3?`${(s/1e3).toFixed(1)}K views`:`${s} views`}function Be(s){let e;typeof s=="number"?e=new Date(s*1e3):e=new Date(s);const l=new Date().getTime()-e.getTime(),n=Math.floor(l/1e3),i=Math.floor(n/60),o=Math.floor(i/60),a=Math.floor(o/24),u=Math.floor(a/30),r=Math.floor(a/365);return r>0?`${r} year${r>1?"s":""} ago`:u>0?`${u} month${u>1?"s":""} ago`:a>0?`${a} day${a>1?"s":""} ago`:o>0?`${o} hour${o>1?"s":""} ago`:i>0?`${i} minute${i>1?"s":""} ago`:"Just now"}function wt(s){return s===0?"":s>=1e3?`${(s/1e3).toFixed(1)}K comments`:`${s} comment${s!==1?"s":""}`}function ms(s){let e,t,l,n,i;return{c(){e=p("img"),je(e.src,t=s[0].thumbnail_url)||h(e,"src",t),h(e,"alt",l=s[0].title),h(e,"class","thumbnail svelte-16jifoe"),h(e,"loading","lazy")},m(o,a){A(o,e,a),n||(i=H(e,"error",s[3]),n=!0)},p(o,a){a&1&&!je(e.src,t=o[0].thumbnail_url)&&h(e,"src",t),a&1&&l!==(l=o[0].title)&&h(e,"alt",l)},d(o){o&&w(e),n=!1,i()}}}function gs(s){let e;return{c(){e=p("div"),e.innerHTML='<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg> <span class="placeholder-text svelte-16jifoe">No thumbnail</span>',h(e,"class","thumbnail-placeholder svelte-16jifoe")},m(t,l){A(t,e,l)},p:oe,d(t){t&&w(e)}}}function vs(s){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>',h(e,"class","status-badge metadata-only svelte-16jifoe"),h(e,"title","Metadata only (no video file)")},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function bs(s){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',h(e,"class","status-badge downloaded svelte-16jifoe"),h(e,"title","Video available locally")},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function At(s){let e,t,l,n=wt(s[0].comment_count)+"",i;return{c(){e=p("span"),e.textContent="‚Ä¢",t=b(),l=p("span"),i=M(n),h(e,"class","separator svelte-16jifoe"),h(l,"class","comments")},m(o,a){A(o,e,a),A(o,t,a),A(o,l,a),c(l,i)},p(o,a){a&1&&n!==(n=wt(o[0].comment_count)+"")&&B(i,n)},d(o){o&&(w(e),w(t),w(l))}}}function ys(s){let e,t,l,n,i,o=Ct(s[0].duration)+"",a,u,r,f,d=s[0].title+"",_,m,g,k=s[0].channel_name+"",y,C,v,E,S=et(s[0].view_count)+"",T,O,P,z,V,I,F=Be(s[0].published_at)+"",L,G,q;function K(N,Q){return N[2]?gs:ms}let te=K(s),$=te(s);function ee(N,Q){if(N[0].download_status==="downloaded")return bs;if(N[0].download_status==="metadata_only")return vs}let X=ee(s),Y=X&&X(s),U=s[0].comment_count>0&&At(s);return{c(){e=p("div"),t=p("div"),$.c(),l=b(),Y&&Y.c(),n=b(),i=p("div"),a=M(o),u=b(),r=p("div"),f=p("h3"),_=M(d),m=b(),g=p("div"),y=M(k),C=b(),v=p("div"),E=p("span"),T=M(S),O=b(),U&&U.c(),P=b(),z=p("span"),z.textContent="‚Ä¢",V=b(),I=p("span"),L=M(F),h(i,"class","duration svelte-16jifoe"),h(t,"class","thumbnail-container svelte-16jifoe"),h(f,"class","title svelte-16jifoe"),h(g,"class","channel svelte-16jifoe"),h(E,"class","views"),h(z,"class","separator svelte-16jifoe"),h(I,"class","date"),h(v,"class","metadata svelte-16jifoe"),h(r,"class","info svelte-16jifoe"),h(e,"class","video-card svelte-16jifoe"),h(e,"role","button"),h(e,"tabindex","0")},m(N,Q){A(N,e,Q),c(e,t),$.m(t,null),c(t,l),Y&&Y.m(t,null),c(t,n),c(t,i),c(i,a),c(e,u),c(e,r),c(r,f),c(f,_),c(r,m),c(r,g),c(g,y),c(r,C),c(r,v),c(v,E),c(E,T),c(v,O),U&&U.m(v,null),c(v,P),c(v,z),c(v,V),c(v,I),c(I,L),G||(q=[H(e,"click",s[5]),H(e,"keydown",s[4])],G=!0)},p(N,[Q]){te===(te=K(N))&&$?$.p(N,Q):($.d(1),$=te(N),$&&($.c(),$.m(t,l))),X!==(X=ee(N))&&(Y&&Y.d(1),Y=X&&X(N),Y&&(Y.c(),Y.m(t,n))),Q&1&&o!==(o=Ct(N[0].duration)+"")&&B(a,o),Q&1&&d!==(d=N[0].title+"")&&B(_,d),Q&1&&k!==(k=N[0].channel_name+"")&&B(y,k),Q&1&&S!==(S=et(N[0].view_count)+"")&&B(T,S),N[0].comment_count>0?U?U.p(N,Q):(U=At(N),U.c(),U.m(v,P)):U&&(U.d(1),U=null),Q&1&&F!==(F=Be(N[0].published_at)+"")&&B(L,F)},i:oe,o:oe,d(N){N&&w(e),$.d(),Y&&Y.d(),U&&U.d(),G=!1,Ke(q)}}}function ks(s,e,t){let{video:l}=e,{onClick:n=()=>{}}=e,i=!1;function o(){t(2,i=!0)}function a(r){(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),n(l))}const u=()=>n(l);return s.$$set=r=>{"video"in r&&t(0,l=r.video),"onClick"in r&&t(1,n=r.onClick)},[l,n,i,o,a,u]}class Cs extends Re{constructor(e){super(),Ve(this,e,ks,ys,Pe,{video:0,onClick:1})}}function Et(s,e,t){const l=s.slice();return l[6]=e[t],l}function ws(s){let e,t,l=[],n=new Map,i,o=s[1]>0&&Mt(s),a=pe(s[0]);const u=r=>r[6].video_id;for(let r=0;r<a.length;r+=1){let f=Et(s,a,r),d=u(f);n.set(d,l[r]=St(d,f))}return{c(){o&&o.c(),e=b(),t=p("div");for(let r=0;r<l.length;r+=1)l[r].c();h(t,"class","video-grid svelte-1thvyca")},m(r,f){o&&o.m(r,f),A(r,e,f),A(r,t,f);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(t,null);i=!0},p(r,f){r[1]>0?o?o.p(r,f):(o=Mt(r),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),f&5&&(a=pe(r[0]),tt(),l=Al(l,f,u,1,r,a,n,t,El,St,null,Et),lt())},i(r){if(!i){for(let f=0;f<a.length;f+=1)_e(l[f]);i=!0}},o(r){for(let f=0;f<l.length;f+=1)be(l[f]);i=!1},d(r){r&&(w(e),w(t)),o&&o.d(r);for(let f=0;f<l.length;f+=1)l[f].d()}}}function As(s){let e;function t(i,o){return i[5]?Bs:Fs}let l=t(s),n=l(s);return{c(){e=p("div"),n.c(),h(e,"class","empty svelte-1thvyca")},m(i,o){A(i,e,o),n.m(e,null)},p(i,o){l!==(l=t(i))&&(n.d(1),n=l(i),n&&(n.c(),n.m(e,null)))},i:oe,o:oe,d(i){i&&w(e),n.d()}}}function Es(s){let e,t,l,n,i;return{c(){e=p("div"),t=p("p"),t.textContent="Error loading videos",l=b(),n=p("p"),i=M(s[4]),h(t,"class","error-title svelte-1thvyca"),h(n,"class","error-message svelte-1thvyca"),h(e,"class","error svelte-1thvyca")},m(o,a){A(o,e,a),c(e,t),c(e,l),c(e,n),c(n,i)},p(o,a){a&16&&B(i,o[4])},i:oe,o:oe,d(o){o&&w(e)}}}function Ms(s){let e;return{c(){e=p("div"),e.innerHTML='<div class="spinner svelte-1thvyca"></div> <p class="svelte-1thvyca">Loading videos...</p>',h(e,"class","loading svelte-1thvyca")},m(t,l){A(t,e,l)},p:oe,i:oe,o:oe,d(t){t&&w(e)}}}function Mt(s){let e,t;function l(o,a){return o[5]?Ds:Ss}let n=l(s),i=n(s);return{c(){e=p("div"),t=p("p"),i.c(),h(t,"class","result-count svelte-1thvyca"),h(e,"class","result-header svelte-1thvyca")},m(o,a){A(o,e,a),c(e,t),i.m(t,null)},p(o,a){n===(n=l(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(t,null)))},d(o){o&&w(e),i.d()}}}function Ss(s){let e=s[0].length+"",t,l;return{c(){t=M(e),l=M(" videos")},m(n,i){A(n,t,i),A(n,l,i)},p(n,i){i&1&&e!==(e=n[0].length+"")&&B(t,e)},d(n){n&&(w(t),w(l))}}}function Ds(s){let e,t=s[0].length+"",l,n,i,o;return{c(){e=M("Showing "),l=M(t),n=M(" of "),i=M(s[1]),o=M(" videos")},m(a,u){A(a,e,u),A(a,l,u),A(a,n,u),A(a,i,u),A(a,o,u)},p(a,u){u&1&&t!==(t=a[0].length+"")&&B(l,t),u&2&&B(i,a[1])},d(a){a&&(w(e),w(l),w(n),w(i),w(o))}}}function St(s,e){let t,l,n;return l=new Cs({props:{video:e[6],onClick:e[2]}}),{key:s,first:null,c(){t=ht(),qe(l.$$.fragment),this.first=t},m(i,o){A(i,t,o),Ue(l,i,o),n=!0},p(i,o){e=i;const a={};o&1&&(a.video=e[6]),o&4&&(a.onClick=e[2]),l.$set(a)},i(i){n||(_e(l.$$.fragment,i),n=!0)},o(i){be(l.$$.fragment,i),n=!1},d(i){i&&w(t),He(l,i)}}}function Fs(s){let e,t,l;return{c(){e=p("p"),e.textContent="No videos found in this archive.",t=b(),l=p("p"),l.textContent="Check that videos.tsv exists in the videos/ directory.",h(e,"class","svelte-1thvyca"),h(l,"class","hint svelte-1thvyca")},m(n,i){A(n,e,i),A(n,t,i),A(n,l,i)},d(n){n&&(w(e),w(t),w(l))}}}function Bs(s){let e,t,l;return{c(){e=p("p"),e.textContent="No videos match the current filters.",t=b(),l=p("p"),l.textContent="Try adjusting your search or filter criteria.",h(e,"class","svelte-1thvyca"),h(l,"class","hint svelte-1thvyca")},m(n,i){A(n,e,i),A(n,t,i),A(n,l,i)},d(n){n&&(w(e),w(t),w(l))}}}function zs(s){let e,t,l,n;const i=[Ms,Es,As,ws],o=[];function a(u,r){return u[3]?0:u[4]?1:u[0].length===0?2:3}return t=a(s),l=o[t]=i[t](s),{c(){e=p("div"),l.c(),h(e,"class","video-list-container svelte-1thvyca")},m(u,r){A(u,e,r),o[t].m(e,null),n=!0},p(u,[r]){let f=t;t=a(u),t===f?o[t].p(u,r):(tt(),be(o[f],1,1,()=>{o[f]=null}),lt(),l=o[t],l?l.p(u,r):(l=o[t]=i[t](u),l.c()),_e(l,1),l.m(e,null))},i(u){n||(_e(l),n=!0)},o(u){be(l),n=!1},d(u){u&&w(e),o[t].d()}}}function Ts(s,e,t){let l,{videos:n}=e,{totalVideos:i=0}=e,{onVideoClick:o=()=>{}}=e,{loading:a=!1}=e,{error:u=null}=e;return s.$$set=r=>{"videos"in r&&t(0,n=r.videos),"totalVideos"in r&&t(1,i=r.totalVideos),"onVideoClick"in r&&t(2,o=r.onVideoClick),"loading"in r&&t(3,a=r.loading),"error"in r&&t(4,u=r.error)},s.$$.update=()=>{s.$$.dirty&3&&t(5,l=i>0&&n.length!==i)},[n,i,o,a,u,l]}class Ls extends Re{constructor(e){super(),Ve(this,e,Ts,zs,Pe,{videos:0,totalVideos:1,onVideoClick:2,loading:3,error:4})}}function Dt(s,e,t){const l=s.slice();return l[17]=e[t],l}function Ft(s){let e,t,l,n,i,o,a,u,r,f;return{c(){e=p("div"),t=p("button"),l=M("Play from Archive"),i=b(),o=p("button"),a=M("Play from YouTube"),h(t,"class","tab svelte-1qmy9il"),h(t,"role","tab"),h(t,"aria-selected",n=s[1]==="local"),h(t,"aria-controls","local-player-panel"),he(t,"active",s[1]==="local"),h(o,"class","tab svelte-1qmy9il"),h(o,"role","tab"),h(o,"aria-selected",u=s[1]==="youtube"),h(o,"aria-controls","youtube-player-panel"),he(o,"active",s[1]==="youtube"),h(e,"class","tabs svelte-1qmy9il"),h(e,"role","tablist")},m(d,_){A(d,e,_),c(e,t),c(t,l),c(e,i),c(e,o),c(o,a),r||(f=[H(t,"click",s[13]),H(o,"click",s[14])],r=!0)},p(d,_){_&2&&n!==(n=d[1]==="local")&&h(t,"aria-selected",n),_&2&&he(t,"active",d[1]==="local"),_&2&&u!==(u=d[1]==="youtube")&&h(o,"aria-selected",u),_&2&&he(o,"active",d[1]==="youtube")},d(d){d&&w(e),r=!1,Ke(f)}}}function js(s){let e,t,l,n,i,o,a,u,r=s[4]&&Bt(s);return{c(){e=p("div"),r&&r.c(),t=b(),l=p("iframe"),je(l.src,n=s[9]())||h(l,"src",n),h(l,"title",i=s[0].title),h(l,"frameborder","0"),h(l,"allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),l.allowFullscreen=!0,h(l,"style",o=s[4]?"opacity: 0;":""),h(l,"class","svelte-1qmy9il"),h(e,"class","youtube-wrapper svelte-1qmy9il")},m(f,d){A(f,e,d),r&&r.m(e,null),c(e,t),c(e,l),a||(u=H(l,"load",s[11]),a=!0)},p(f,d){f[4]?r?r.p(f,d):(r=Bt(f),r.c(),r.m(e,t)):r&&(r.d(1),r=null),d&1&&i!==(i=f[0].title)&&h(l,"title",i),d&16&&o!==(o=f[4]?"opacity: 0;":"")&&h(l,"style",o)},d(f){f&&w(e),r&&r.d(),a=!1,u()}}}function Rs(s){let e;function t(i,o){return i[2]?Ps:Vs}let l=t(s),n=l(s);return{c(){n.c(),e=ht()},m(i,o){n.m(i,o),A(i,e,o)},p(i,o){l===(l=t(i))&&n?n.p(i,o):(n.d(1),n=l(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){i&&w(e),n.d(i)}}}function Bt(s){let e,t,l,n,i,o;return{c(){e=p("div"),t=p("img"),i=b(),o=p("div"),o.textContent="Loading...",je(t.src,l=s[8]())||h(t,"src",l),h(t,"alt",n=s[0].title),h(t,"class","thumbnail-placeholder svelte-1qmy9il"),h(o,"class","loading-spinner svelte-1qmy9il"),h(e,"class","youtube-loading svelte-1qmy9il")},m(a,u){A(a,e,u),c(e,t),c(e,i),c(e,o)},p(a,u){u&1&&n!==(n=a[0].title)&&h(t,"alt",n)},d(a){a&&w(e)}}}function Vs(s){let e,t,l,n,i,o,a,u,r=pe(s[5]),f=[];for(let d=0;d<r.length;d+=1)f[d]=zt(Dt(s,r,d));return{c(){e=p("video"),t=p("source");for(let d=0;d<f.length;d+=1)f[d].c();n=p("p"),i=M(`Your browser doesn't support HTML5 video or the MKV format.
              `),o=p("button"),o.textContent="Watch on YouTube",je(t.src,l=s[7]())||h(t,"src",l),h(o,"class","fallback-button svelte-1qmy9il"),h(n,"class","video-fallback svelte-1qmy9il"),e.controls=!0,h(e,"crossorigin","anonymous"),h(e,"preload","metadata"),h(e,"poster",s[8]()),h(e,"class","svelte-1qmy9il")},m(d,_){A(d,e,_),c(e,t);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(e,null);c(e,n),c(n,i),c(n,o),a||(u=[H(o,"click",s[16]),H(e,"error",s[10]),H(e,"loadstart",Os),H(e,"loadedmetadata",Ns),H(e,"canplay",Hs)],a=!0)},p(d,_){if(_&33){r=pe(d[5]);let m;for(m=0;m<r.length;m+=1){const g=Dt(d,r,m);f[m]?f[m].p(g,_):(f[m]=zt(g),f[m].c(),f[m].m(e,n))}for(;m<f.length;m+=1)f[m].d(1);f.length=r.length}},d(d){d&&w(e),We(f,d),a=!1,Ke(u)}}}function Ps(s){let e,t,l,n,i,o,a,u,r,f;return{c(){e=p("div"),t=p("p"),t.textContent="‚ö†Ô∏è Video Playback Error",l=b(),n=p("p"),i=M(s[3]),o=b(),a=p("div"),u=p("button"),u.textContent="Watch on YouTube instead",h(t,"class","error-title svelte-1qmy9il"),h(n,"class","error-details svelte-1qmy9il"),h(u,"class","error-button svelte-1qmy9il"),h(a,"class","error-actions svelte-1qmy9il"),h(e,"class","video-error-message svelte-1qmy9il")},m(d,_){A(d,e,_),c(e,t),c(e,l),c(e,n),c(n,i),c(e,o),c(e,a),c(a,u),r||(f=H(u,"click",s[15]),r=!0)},p(d,_){_&8&&B(i,d[3])},d(d){d&&w(e),r=!1,f()}}}function zt(s){let e,t,l,n;return{c(){e=p("track"),h(e,"kind","subtitles"),je(e.src,t=`/videos/${s[0].file_path||s[0].video_id}/video.${s[17]}.vtt`)||h(e,"src",t),h(e,"srclang",l=s[17]),h(e,"label",n=s[17].toUpperCase())},m(i,o){A(i,e,o)},p(i,o){o&33&&!je(e.src,t=`/videos/${i[0].file_path||i[0].video_id}/video.${i[17]}.vtt`)&&h(e,"src",t),o&32&&l!==(l=i[17])&&h(e,"srclang",l),o&32&&n!==(n=i[17].toUpperCase())&&h(e,"label",n)},d(i){i&&w(e)}}}function Is(s){let e,t,l,n,i,o,a=s[6]&&Ft(s);function u(d,_){if(d[1]==="local"&&d[6])return Rs;if(d[1]==="youtube")return js}let r=u(s),f=r&&r(s);return{c(){e=p("div"),a&&a.c(),t=b(),l=p("div"),n=p("div"),f&&f.c(),h(n,"class","tab-content svelte-1qmy9il"),h(n,"role","tabpanel"),h(n,"id",i=s[1]==="local"?"local-player-panel":"youtube-player-panel"),h(n,"aria-labelledby",o=s[1]==="local"?"local-tab":"youtube-tab"),h(l,"class","tab-content-wrapper svelte-1qmy9il"),h(e,"class","video-player svelte-1qmy9il")},m(d,_){A(d,e,_),a&&a.m(e,null),c(e,t),c(e,l),c(l,n),f&&f.m(n,null)},p(d,[_]){d[6]?a?a.p(d,_):(a=Ft(d),a.c(),a.m(e,t)):a&&(a.d(1),a=null),r===(r=u(d))&&f?f.p(d,_):(f&&f.d(1),f=r&&r(d),f&&(f.c(),f.m(n,null))),_&2&&i!==(i=d[1]==="local"?"local-player-panel":"youtube-player-panel")&&h(n,"id",i),_&2&&o!==(o=d[1]==="local"?"local-tab":"youtube-tab")&&h(n,"aria-labelledby",o)},i:oe,o:oe,d(d){d&&w(e),a&&a.d(),f&&f.d()}}}function Os(){console.log("[VideoPlayer] Video load started")}function Ns(){console.log("[VideoPlayer] Video metadata loaded")}function Hs(){console.log("[VideoPlayer] Video can play")}function Us(s,e,t){let l,n,{video:i}=e,o=i.download_status==="downloaded"?"local":"youtube",a=!1,u="",r=!0;function f(){const T=`/videos/${i.file_path||i.video_id}/video.mkv`;return console.log("[VideoPlayer] Video path:",T,"download_status:",i.download_status),T}function d(){return`/videos/${i.file_path||i.video_id}/thumbnail.jpg`}function _(){return`https://www.youtube.com/embed/${i.video_id}`}function m(S){t(2,a=!0);const T=S.target,O=T.error;if(console.error("[VideoPlayer] Video error event:",{error:O?{code:O.code,message:O.message}:"no error object",src:T.src,networkState:T.networkState,readyState:T.readyState}),O)switch(O.code){case O.MEDIA_ERR_ABORTED:t(3,u="Video loading was aborted. Please try again.");break;case O.MEDIA_ERR_NETWORK:t(3,u="Network error while loading video. Check your connection.");break;case O.MEDIA_ERR_DECODE:t(3,u="Video file is corrupted or in an unsupported format.");break;case O.MEDIA_ERR_SRC_NOT_SUPPORTED:t(3,u="Video file could not be loaded. You may need to run `git annex get` to download the file, or your browser may not support MKV format.");break;default:t(3,u="An unknown error occurred while loading the video.")}}function g(){t(4,r=!1)}function k(S){t(1,o=S),S==="local"?(t(2,a=!1),t(3,u="")):t(4,r=!0)}const y=()=>k("local"),C=()=>k("youtube"),v=()=>k("youtube"),E=()=>k("youtube");return s.$$set=S=>{"video"in S&&t(0,i=S.video)},s.$$.update=()=>{s.$$.dirty&1&&t(6,l=i.download_status==="downloaded"),s.$$.dirty&1&&t(5,n=i.captions_available||[])},[i,o,a,u,r,n,l,f,d,_,m,g,k,y,C,v,E]}class qs extends Re{constructor(e){super(),Ve(this,e,Us,Is,Pe,{video:0})}}function Tt(s,e,t){const l=s.slice();return l[7]=e[t],l}function Lt(s,e,t){const l=s.slice();return l[10]=e[t],l}function Ys(s){const e=s.slice(),t=e[1]!==void 0?e[1]:e[0].length;e[4]=t;const l=e[0].length>0;e[5]=l;const n=e[5]||e[1]===void 0;return e[6]=n,e}function jt(s){let e,t=s[4].toLocaleString()+"",l,n,i=s[4]!==1?"s":"",o,a,u,r,f=!s[6]&&s[1]!==void 0&&s[1]>0&&Rt();function d(g,k){return g[5]?Ws:Gs}let _=d(s),m=_(s);return{c(){e=p("h3"),l=M(t),n=M(" Comment"),o=M(i),a=b(),f&&f.c(),u=b(),m.c(),r=ht(),h(e,"class","svelte-799on6")},m(g,k){A(g,e,k),c(e,l),c(e,n),c(e,o),c(e,a),f&&f.m(e,null),A(g,u,k),m.m(g,k),A(g,r,k)},p(g,k){k&3&&t!==(t=g[4].toLocaleString()+"")&&B(l,t),k&3&&i!==(i=g[4]!==1?"s":"")&&B(o,i),!g[6]&&g[1]!==void 0&&g[1]>0?f||(f=Rt(),f.c(),f.m(e,null)):f&&(f.d(1),f=null),_===(_=d(g))&&m?m.p(g,k):(m.d(1),m=_(g),m&&(m.c(),m.m(r.parentNode,r)))},d(g){g&&(w(e),w(u),w(r)),f&&f.d(),m.d(g)}}}function Ks(s){let e,t,l;return{c(){e=p("h3"),e.textContent="Loading comments...",t=b(),l=p("div"),l.innerHTML='<div class="spinner svelte-799on6"></div>',h(e,"class","svelte-799on6"),h(l,"class","loading-spinner svelte-799on6")},m(n,i){A(n,e,i),A(n,t,i),A(n,l,i)},p:oe,d(n){n&&(w(e),w(t),w(l))}}}function Rt(s){let e;return{c(){e=p("span"),e.textContent="(not fetched)",h(e,"class","not-fetched svelte-799on6")},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function Ws(s){let e,t=pe(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Nt(Tt(s,t,n));return{c(){e=p("div");for(let n=0;n<l.length;n+=1)l[n].c();h(e,"class","comments-list svelte-799on6")},m(n,i){A(n,e,i);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,i){if(i&8){t=pe(n[3]);let o;for(o=0;o<t.length;o+=1){const a=Tt(n,t,o);l[o]?l[o].p(a,i):(l[o]=Nt(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&w(e),We(l,n)}}}function Gs(s){let e;function t(i,o){return i[1]!==void 0&&i[1]>0?Js:Qs}let l=t(s),n=l(s);return{c(){e=p("p"),n.c(),h(e,"class","no-comments svelte-799on6")},m(i,o){A(i,e,o),n.m(e,null)},p(i,o){l!==(l=t(i))&&(n.d(1),n=l(i),n&&(n.c(),n.m(e,null)))},d(i){i&&w(e),n.d()}}}function Vt(s){let e,t,l=s[7].like_count.toLocaleString()+"",n;return{c(){e=p("span"),t=M("üëç "),n=M(l),h(e,"class","likes svelte-799on6")},m(i,o){A(i,e,o),c(e,t),c(e,n)},p(i,o){o&8&&l!==(l=i[7].like_count.toLocaleString()+"")&&B(n,l)},d(i){i&&w(e)}}}function Pt(s){let e,t,l=s[7].replies.length+"",n,i,o=s[7].replies.length===1?"reply":"replies",a,u,r,f=pe(s[7].replies),d=[];for(let _=0;_<f.length;_+=1)d[_]=Ot(Lt(s,f,_));return{c(){e=p("details"),t=p("summary"),n=M(l),i=b(),a=M(o),u=b(),r=p("div");for(let _=0;_<d.length;_+=1)d[_].c();h(t,"class","replies-summary svelte-799on6"),h(r,"class","replies svelte-799on6"),h(e,"class","replies-details svelte-799on6"),e.open=!0},m(_,m){A(_,e,m),c(e,t),c(t,n),c(t,i),c(t,a),c(e,u),c(e,r);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(r,null)},p(_,m){if(m&8&&l!==(l=_[7].replies.length+"")&&B(n,l),m&8&&o!==(o=_[7].replies.length===1?"reply":"replies")&&B(a,o),m&8){f=pe(_[7].replies);let g;for(g=0;g<f.length;g+=1){const k=Lt(_,f,g);d[g]?d[g].p(k,m):(d[g]=Ot(k),d[g].c(),d[g].m(r,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=f.length}},d(_){_&&w(e),We(d,_)}}}function It(s){let e,t,l=s[10].like_count.toLocaleString()+"",n;return{c(){e=p("span"),t=M("üëç "),n=M(l),h(e,"class","likes svelte-799on6")},m(i,o){A(i,e,o),c(e,t),c(e,n)},p(i,o){o&8&&l!==(l=i[10].like_count.toLocaleString()+"")&&B(n,l)},d(i){i&&w(e)}}}function Ot(s){let e,t,l,n=s[10].author+"",i,o,a,u=Be(s[10].timestamp)+"",r,f,d,_=s[10].text+"",m,g,k,y,C=s[10].like_count>0&&It(s);return{c(){e=p("div"),t=p("div"),l=p("span"),i=M(n),o=b(),a=p("span"),r=M(u),f=b(),d=p("div"),m=M(_),g=b(),k=p("div"),C&&C.c(),y=b(),h(l,"class","author svelte-799on6"),h(a,"class","timestamp svelte-799on6"),h(t,"class","comment-header svelte-799on6"),h(d,"class","comment-text svelte-799on6"),h(k,"class","comment-meta svelte-799on6"),h(e,"class","comment reply svelte-799on6")},m(v,E){A(v,e,E),c(e,t),c(t,l),c(l,i),c(t,o),c(t,a),c(a,r),c(e,f),c(e,d),c(d,m),c(e,g),c(e,k),C&&C.m(k,null),c(e,y)},p(v,E){E&8&&n!==(n=v[10].author+"")&&B(i,n),E&8&&u!==(u=Be(v[10].timestamp)+"")&&B(r,u),E&8&&_!==(_=v[10].text+"")&&B(m,_),v[10].like_count>0?C?C.p(v,E):(C=It(v),C.c(),C.m(k,null)):C&&(C.d(1),C=null)},d(v){v&&w(e),C&&C.d()}}}function Nt(s){let e,t,l,n=s[7].author+"",i,o,a,u=Be(s[7].timestamp)+"",r,f,d,_=s[7].text+"",m,g,k,y,C,v=s[7].like_count>0&&Vt(s),E=s[7].replies&&s[7].replies.length>0&&Pt(s);return{c(){e=p("div"),t=p("div"),l=p("span"),i=M(n),o=b(),a=p("span"),r=M(u),f=b(),d=p("div"),m=M(_),g=b(),k=p("div"),v&&v.c(),y=b(),E&&E.c(),C=b(),h(l,"class","author svelte-799on6"),h(a,"class","timestamp svelte-799on6"),h(t,"class","comment-header svelte-799on6"),h(d,"class","comment-text svelte-799on6"),h(k,"class","comment-meta svelte-799on6"),h(e,"class","comment svelte-799on6")},m(S,T){A(S,e,T),c(e,t),c(t,l),c(l,i),c(t,o),c(t,a),c(a,r),c(e,f),c(e,d),c(d,m),c(e,g),c(e,k),v&&v.m(k,null),c(e,y),E&&E.m(e,null),c(e,C)},p(S,T){T&8&&n!==(n=S[7].author+"")&&B(i,n),T&8&&u!==(u=Be(S[7].timestamp)+"")&&B(r,u),T&8&&_!==(_=S[7].text+"")&&B(m,_),S[7].like_count>0?v?v.p(S,T):(v=Vt(S),v.c(),v.m(k,null)):v&&(v.d(1),v=null),S[7].replies&&S[7].replies.length>0?E?E.p(S,T):(E=Pt(S),E.c(),E.m(e,C)):E&&(E.d(1),E=null)},d(S){S&&w(e),v&&v.d(),E&&E.d()}}}function Qs(s){let e;return{c(){e=M("No comments available for this video.")},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function Js(s){let e;return{c(){e=M("Comments were not fetched for this video. Enable comments in the archive configuration to download them.")},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function Xs(s){let e;function t(o,a){return o[2]?Ks:jt}function l(o,a){return a===jt?Ys(o):o}let n=t(s),i=n(l(s,n));return{c(){e=p("div"),i.c(),h(e,"class","comments-section svelte-799on6")},m(o,a){A(o,e,a),i.m(e,null)},p(o,[a]){n===(n=t(o))&&i?i.p(l(o,n),a):(i.d(1),i=n(l(o,n)),i&&(i.c(),i.m(e,null)))},i:oe,o:oe,d(o){o&&w(e),i.d()}}}function Zs(s){const e=new Map,t=[];return s.forEach(l=>{e.set(l.comment_id,{...l,replies:[]})}),s.forEach(l=>{const n=e.get(l.comment_id);if(l.parent==="root")t.push(n);else{const i=e.get(l.parent);i?i.replies.push(n):t.push(n)}}),t}function $s(s,e,t){let l,{comments:n}=e,{commentCount:i=void 0}=e,{loading:o=!1}=e;return s.$$set=a=>{"comments"in a&&t(0,n=a.comments),"commentCount"in a&&t(1,i=a.commentCount),"loading"in a&&t(2,o=a.loading)},s.$$.update=()=>{s.$$.dirty&1&&t(3,l=Zs(n))},[n,i,o,l]}class xs extends Re{constructor(e){super(),Ve(this,e,$s,Xs,Pe,{comments:0,commentCount:1,loading:2})}}function Ht(s){let e,t,l,n,i,o=new Date(s[1].published_at).toLocaleDateString()+"",a,u,r,f,d,_=Wt(s[1].duration)+"",m,g,k,y,C,v=s[1].download_status+"",E,S,T,O,P,z=s[1].tags&&s[1].tags.length>0&&Ut(s),V=s[1].categories&&s[1].categories.length>0&&qt(s),I=s[1].captions_available.length>0&&Yt(s),F=s[1].description&&Kt(s);return{c(){e=p("div"),t=p("div"),l=p("div"),n=p("strong"),n.textContent="Published:",i=b(),a=M(o),u=b(),r=p("div"),f=p("strong"),f.textContent="Duration:",d=b(),m=M(_),g=b(),k=p("div"),y=p("strong"),y.textContent="Download Status:",C=b(),E=M(v),S=b(),z&&z.c(),T=b(),V&&V.c(),O=b(),I&&I.c(),P=b(),F&&F.c(),h(n,"class","svelte-1dygxzj"),h(f,"class","svelte-1dygxzj"),h(y,"class","svelte-1dygxzj"),h(t,"class","details-meta svelte-1dygxzj"),h(e,"class","details-content svelte-1dygxzj")},m(L,G){A(L,e,G),c(e,t),c(t,l),c(l,n),c(l,i),c(l,a),c(t,u),c(t,r),c(r,f),c(r,d),c(r,m),c(t,g),c(t,k),c(k,y),c(k,C),c(k,E),c(t,S),z&&z.m(t,null),c(t,T),V&&V.m(t,null),c(t,O),I&&I.m(t,null),c(t,P),F&&F.m(t,null)},p(L,G){G&2&&o!==(o=new Date(L[1].published_at).toLocaleDateString()+"")&&B(a,o),G&2&&_!==(_=Wt(L[1].duration)+"")&&B(m,_),G&2&&v!==(v=L[1].download_status+"")&&B(E,v),L[1].tags&&L[1].tags.length>0?z?z.p(L,G):(z=Ut(L),z.c(),z.m(t,T)):z&&(z.d(1),z=null),L[1].categories&&L[1].categories.length>0?V?V.p(L,G):(V=qt(L),V.c(),V.m(t,O)):V&&(V.d(1),V=null),L[1].captions_available.length>0?I?I.p(L,G):(I=Yt(L),I.c(),I.m(t,P)):I&&(I.d(1),I=null),L[1].description?F?F.p(L,G):(F=Kt(L),F.c(),F.m(t,null)):F&&(F.d(1),F=null)},d(L){L&&w(e),z&&z.d(),V&&V.d(),I&&I.d(),F&&F.d()}}}function Ut(s){let e,t,l,n=s[1].tags.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Tags:",l=b(),i=M(n),h(t,"class","svelte-1dygxzj")},m(o,a){A(o,e,a),c(e,t),c(e,l),c(e,i)},p(o,a){a&2&&n!==(n=o[1].tags.join(", ")+"")&&B(i,n)},d(o){o&&w(e)}}}function qt(s){let e,t,l,n=s[1].categories.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Categories:",l=b(),i=M(n),h(t,"class","svelte-1dygxzj")},m(o,a){A(o,e,a),c(e,t),c(e,l),c(e,i)},p(o,a){a&2&&n!==(n=o[1].categories.join(", ")+"")&&B(i,n)},d(o){o&&w(e)}}}function Yt(s){let e,t,l,n=s[1].captions_available.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Captions:",l=b(),i=M(n),h(t,"class","svelte-1dygxzj")},m(o,a){A(o,e,a),c(e,t),c(e,l),c(e,i)},p(o,a){a&2&&n!==(n=o[1].captions_available.join(", ")+"")&&B(i,n)},d(o){o&&w(e)}}}function Kt(s){let e,t,l,n,i=s[1].description+"",o;return{c(){e=p("div"),t=p("strong"),t.textContent="Description:",l=b(),n=p("p"),o=M(i),h(t,"class","svelte-1dygxzj"),h(n,"class","svelte-1dygxzj"),h(e,"class","description-text svelte-1dygxzj")},m(a,u){A(a,e,u),c(e,t),c(e,l),c(e,n),c(n,o)},p(a,u){u&2&&i!==(i=a[1].description+"")&&B(o,i)},d(a){a&&w(e)}}}function en(s){let e,t,l,n,i,o,a,u,r=s[1].title+"",f,d,_,m,g,k=s[1].channel_name+"",y,C,v,E,S,T=et(s[1].view_count)+"",O,P,z,V,I,F=Be(s[1].published_at)+"",L,G,q,K,te,$,ee,X,Y,U=s[1].like_count.toLocaleString()+"",N,Q,ye,Te,ae,j,W=s[4]?"‚ñº":"‚ñ∂",le,ke,Ce,we,Ae,ue,me,De;i=new qs({props:{video:s[1]}});let Z=s[4]&&Ht(s);return Ae=new xs({props:{comments:s[2],commentCount:s[1].comment_count,loading:s[3]}}),{c(){e=p("div"),t=p("button"),t.textContent="‚Üê Back to list",l=b(),n=p("div"),qe(i.$$.fragment),o=b(),a=p("div"),u=p("h1"),f=M(r),d=b(),_=p("div"),m=p("div"),g=p("span"),y=M(k),C=b(),v=p("span"),v.textContent="‚Ä¢",E=b(),S=p("span"),O=M(T),P=b(),z=p("span"),z.textContent="‚Ä¢",V=b(),I=p("span"),L=M(F),G=b(),q=p("div"),K=p("a"),te=M("View on YouTube ‚Üó"),ee=b(),X=p("div"),Y=p("span"),N=M(U),Q=b(),ye=p("span"),ye.textContent="likes",Te=b(),ae=p("div"),j=p("button"),le=M(W),ke=M(" Video Details"),Ce=b(),Z&&Z.c(),we=b(),qe(Ae.$$.fragment),h(t,"class","back-button svelte-1dygxzj"),h(n,"class","player-container svelte-1dygxzj"),h(u,"class","title svelte-1dygxzj"),h(g,"class","channel-name svelte-1dygxzj"),h(v,"class","separator svelte-1dygxzj"),h(S,"class","views"),h(z,"class","separator svelte-1dygxzj"),h(I,"class","date"),h(m,"class","metadata-left svelte-1dygxzj"),h(K,"href",$=s[1].source_url),h(K,"target","_blank"),h(K,"rel","noopener noreferrer"),h(K,"class","youtube-link svelte-1dygxzj"),h(Y,"class","stat-value svelte-1dygxzj"),h(ye,"class","stat-label svelte-1dygxzj"),h(X,"class","stat svelte-1dygxzj"),h(q,"class","metadata-right svelte-1dygxzj"),h(_,"class","metadata-row svelte-1dygxzj"),h(j,"class","details-toggle svelte-1dygxzj"),h(ae,"class","details-section svelte-1dygxzj"),h(a,"class","video-info svelte-1dygxzj"),h(e,"class","video-detail svelte-1dygxzj")},m(re,se){A(re,e,se),c(e,t),c(e,l),c(e,n),Ue(i,n,null),c(e,o),c(e,a),c(a,u),c(u,f),c(a,d),c(a,_),c(_,m),c(m,g),c(g,y),c(m,C),c(m,v),c(m,E),c(m,S),c(S,O),c(m,P),c(m,z),c(m,V),c(m,I),c(I,L),c(_,G),c(_,q),c(q,K),c(K,te),c(q,ee),c(q,X),c(X,Y),c(Y,N),c(X,Q),c(X,ye),c(a,Te),c(a,ae),c(ae,j),c(j,le),c(j,ke),c(ae,Ce),Z&&Z.m(ae,null),c(e,we),Ue(Ae,e,null),ue=!0,me||(De=[H(t,"click",function(){Ml(s[0])&&s[0].apply(this,arguments)}),H(j,"click",s[6])],me=!0)},p(re,[se]){s=re;const ne={};se&2&&(ne.video=s[1]),i.$set(ne),(!ue||se&2)&&r!==(r=s[1].title+"")&&B(f,r),(!ue||se&2)&&k!==(k=s[1].channel_name+"")&&B(y,k),(!ue||se&2)&&T!==(T=et(s[1].view_count)+"")&&B(O,T),(!ue||se&2)&&F!==(F=Be(s[1].published_at)+"")&&B(L,F),(!ue||se&2&&$!==($=s[1].source_url))&&h(K,"href",$),(!ue||se&2)&&U!==(U=s[1].like_count.toLocaleString()+"")&&B(N,U),(!ue||se&16)&&W!==(W=s[4]?"‚ñº":"‚ñ∂")&&B(le,W),s[4]?Z?Z.p(s,se):(Z=Ht(s),Z.c(),Z.m(ae,null)):Z&&(Z.d(1),Z=null);const Ee={};se&4&&(Ee.comments=s[2]),se&2&&(Ee.commentCount=s[1].comment_count),se&8&&(Ee.loading=s[3]),Ae.$set(Ee)},i(re){ue||(_e(i.$$.fragment,re),_e(Ae.$$.fragment,re),ue=!0)},o(re){be(i.$$.fragment,re),be(Ae.$$.fragment,re),ue=!1},d(re){re&&w(e),He(i),Z&&Z.d(),He(Ae),me=!1,Ke(De)}}}function Wt(s){const e=Math.floor(s/3600),t=Math.floor(s%3600/60),l=s%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(l).padStart(2,"0")}`:`${t}:${String(l).padStart(2,"0")}`}function tn(s,e,t){let{video:l}=e,{onBack:n}=e,i=l,o=[],a=!1,u=!1,r=!1;ul(async()=>{try{a=!0,t(1,i=await Ze.loadVideoMetadata(l.video_id))}catch(d){console.warn("Could not load full metadata, using TSV data:",d),t(1,i=l)}finally{a=!1}try{t(3,u=!0),t(2,o=await Ze.loadComments(l.video_id))}catch(d){console.warn("Could not load comments:",d),t(2,o=[])}finally{t(3,u=!1)}});const f=()=>t(4,r=!r);return s.$$set=d=>{"video"in d&&t(5,l=d.video),"onBack"in d&&t(0,n=d.onBack)},[n,i,o,u,r,l,f]}class ln extends Re{constructor(e){super(),Ve(this,e,tn,en,Pe,{video:5,onBack:0})}}class sn{filter(e,t,l){var i,o;let n=e;if(((i=t.dateRange)!=null&&i.from||(o=t.dateRange)!=null&&o.to)&&(n=n.filter(a=>{var d,_;const u=new Date(a.published_at),r=(d=t.dateRange)!=null&&d.from?new Date(t.dateRange.from):new Date(0),f=(_=t.dateRange)!=null&&_.to?new Date(t.dateRange.to):new Date;return u>=r&&u<=f})),t.channels&&t.channels.length>0&&(n=n.filter(a=>t.channels.includes(a.channel_id))),t.tags&&t.tags.length>0&&(n=n.filter(a=>a.tags.some(u=>t.tags.includes(u)))),t.downloadStatus&&t.downloadStatus.length>0&&(n=n.filter(a=>t.downloadStatus.includes(a.download_status))),t.playlists&&t.playlists.length>0){if(!l||l.length===0)return[];const a=new Set;l.forEach(u=>{t.playlists.includes(u.playlist_id)&&u.video_ids.forEach(r=>a.add(r))}),n=n.filter(u=>a.has(u.video_id))}return n}getUniqueChannels(e){const t=new Map;return e.forEach(l=>{l.channel_id&&!t.has(l.channel_id)&&t.set(l.channel_id,l.channel_name)}),Array.from(t.entries()).map(([l,n])=>({id:l,name:n})).sort((l,n)=>l.name.localeCompare(n.name))}getUniqueTags(e){const t=new Set;return e.forEach(l=>{l.tags&&l.tags.length>0&&l.tags.forEach(n=>t.add(n))}),Array.from(t).sort()}getPlaylistVideoCounts(e,t){const l=new Set(t.map(i=>i.video_id)),n=new Map;return e.forEach(i=>{const o=i.video_ids.filter(a=>l.has(a)).length;n.set(i.playlist_id,o)}),n}}const Xe=new sn;class nn{sort(e,t){const l=[...e];return l.sort((n,i)=>{let o=0;switch(t.field){case"views":o=n.view_count-i.view_count;break;case"date":o=new Date(n.published_at).getTime()-new Date(i.published_at).getTime();break;case"duration":o=n.duration-i.duration;break;case"comments":o=n.comment_count-i.comment_count;break;case"title":o=n.title.localeCompare(i.title);break;case"relevance":return 0}return t.direction==="asc"?o:-o}),l}}const on=new nn;class an{parseHash(e){const t=e.replace(/^#\/?(\?)?/,""),l=new URLSearchParams(t),n=i=>{const o=i==null?void 0:i.split(",").filter(Boolean);return o!=null&&o.length?o:void 0};return{search:l.get("search")||void 0,dateFrom:l.get("from")||void 0,dateTo:l.get("to")||void 0,channels:n(l.get("channels")),tags:n(l.get("tags")),downloadStatus:n(l.get("status")),playlists:n(l.get("playlists")),sortField:l.get("sort")||void 0,sortDirection:l.get("dir")||void 0}}encodeHash(e){var n,i,o,a;const t=new URLSearchParams;e.search&&t.set("search",e.search),e.dateFrom&&t.set("from",e.dateFrom),e.dateTo&&t.set("to",e.dateTo),(n=e.channels)!=null&&n.length&&t.set("channels",e.channels.join(",")),(i=e.tags)!=null&&i.length&&t.set("tags",e.tags.join(",")),(o=e.downloadStatus)!=null&&o.length&&t.set("status",e.downloadStatus.join(",")),(a=e.playlists)!=null&&a.length&&t.set("playlists",e.playlists.join(",")),e.sortField&&t.set("sort",e.sortField),e.sortDirection&&t.set("dir",e.sortDirection);const l=t.toString();return l?`#/?${l}`:"#/"}updateHash(e){window.location.hash=this.encodeHash(e)}getCurrentState(){return this.parseHash(window.location.hash)}}const rn=new an;function Gt(s,e,t){const l=s.slice();return l[40]=e[t],l}function Qt(s,e,t){const l=s.slice();return l[43]=e[t],l}function Jt(s,e,t){const l=s.slice();return l[46]=e[t],l}function Xt(s){let e,t;return{c(){e=p("span"),t=M(s[12]),h(e,"class","count-badge svelte-z58pfr")},m(l,n){A(l,e,n),c(e,t)},p(l,n){n[0]&4096&&B(t,l[12])},d(l){l&&w(e)}}}function Zt(s){let e,t,l,n,i,o,a,u,r,f,d,_,m,g,k,y,C,v,E,S,T,O,P,z,V,I,F,L,G,q,K,te,$,ee,X,Y,U,N,Q,ye,Te,ae,j,W,le,ke,Ce,we,Ae=s[1].trim(),ue,me,De,Z,re,se,ne=s[4].length>0&&$t(s),Ee=pe(s[15]),ce=[];for(let R=0;R<Ee.length;R+=1)ce[R]=xt(Jt(s,Ee,R));let fe=s[0].length>0&&el(s),de=s[14].length>0&&sl(s),ge=Ae&&ol();return{c(){e=p("div"),t=p("div"),l=p("label"),l.textContent="Date Range",n=b(),i=p("div"),o=p("button"),o.textContent="Last Week",a=b(),u=p("button"),u.textContent="Last Month",r=b(),f=p("button"),f.textContent="Last Year",d=b(),_=p("button"),_.textContent="This Year",m=b(),g=p("button"),g.textContent="All Time",k=b(),y=p("div"),C=p("input"),v=b(),E=p("span"),E.textContent="to",S=b(),T=p("input"),O=b(),P=p("div"),z=p("label"),V=M(`Channels
        `),ne&&ne.c(),I=b(),F=p("select");for(let R=0;R<ce.length;R+=1)ce[R].c();L=b(),fe&&fe.c(),G=b(),de&&de.c(),q=b(),K=p("div"),te=p("label"),te.textContent="Video Availability",$=b(),ee=p("select"),X=p("option"),X.textContent="All Videos",Y=p("option"),Y.textContent="Backup Available (Local)",U=p("option"),U.textContent="Metadata Only",N=b(),Q=p("div"),ye=p("label"),ye.textContent="Sort By",Te=b(),ae=p("div"),j=p("select"),W=p("option"),W.textContent="Date",le=p("option"),le.textContent="Views",ke=p("option"),ke.textContent="Comments",Ce=p("option"),Ce.textContent="Duration",we=p("option"),we.textContent="Title",ge&&ge.c(),ue=b(),me=p("select"),De=p("option"),De.textContent="Descending",Z=p("option"),Z.textContent="Ascending",h(l,"class","filter-label svelte-z58pfr"),h(o,"type","button"),h(o,"class","preset-btn svelte-z58pfr"),he(o,"active",s[11]==="week"),h(u,"type","button"),h(u,"class","preset-btn svelte-z58pfr"),he(u,"active",s[11]==="month"),h(f,"type","button"),h(f,"class","preset-btn svelte-z58pfr"),he(f,"active",s[11]==="year"),h(_,"type","button"),h(_,"class","preset-btn svelte-z58pfr"),he(_,"active",s[11]==="thisyear"),h(g,"type","button"),h(g,"class","preset-btn svelte-z58pfr"),he(g,"active",s[11]==="all"),h(i,"class","date-presets svelte-z58pfr"),h(C,"type","date"),h(C,"class","date-input svelte-z58pfr"),h(C,"title","From date"),h(E,"class","date-separator svelte-z58pfr"),h(T,"type","date"),h(T,"class","date-input svelte-z58pfr"),h(T,"title","To date"),h(y,"class","date-inputs svelte-z58pfr"),h(t,"class","filter-group svelte-z58pfr"),h(z,"class","filter-label svelte-z58pfr"),F.multiple=!0,h(F,"class","multi-select svelte-z58pfr"),h(F,"size","3"),s[4]===void 0&&Ne(()=>s[30].call(F)),h(P,"class","filter-group svelte-z58pfr"),h(te,"class","filter-label svelte-z58pfr"),X.__value="all",J(X,X.__value),Y.__value="downloaded",J(Y,Y.__value),U.__value="metadata_only",J(U,U.__value),h(ee,"class","filter-select svelte-z58pfr"),s[6]===void 0&&Ne(()=>s[33].call(ee)),h(K,"class","filter-group svelte-z58pfr"),h(ye,"class","filter-label svelte-z58pfr"),W.__value="date",J(W,W.__value),le.__value="views",J(le,le.__value),ke.__value="comments",J(ke,ke.__value),Ce.__value="duration",J(Ce,Ce.__value),we.__value="title",J(we,we.__value),h(j,"class","sort-select svelte-z58pfr"),s[8]===void 0&&Ne(()=>s[34].call(j)),De.__value="desc",J(De,De.__value),Z.__value="asc",J(Z,Z.__value),h(me,"class","sort-select svelte-z58pfr"),s[9]===void 0&&Ne(()=>s[35].call(me)),h(ae,"class","sort-controls svelte-z58pfr"),h(Q,"class","filter-group svelte-z58pfr"),h(e,"class","filters-grid svelte-z58pfr")},m(R,x){A(R,e,x),c(e,t),c(t,l),c(t,n),c(t,i),c(i,o),c(i,a),c(i,u),c(i,r),c(i,f),c(i,d),c(i,_),c(i,m),c(i,g),c(t,k),c(t,y),c(y,C),J(C,s[2]),c(y,v),c(y,E),c(y,S),c(y,T),J(T,s[3]),c(e,O),c(e,P),c(P,z),c(z,V),ne&&ne.m(z,null),c(P,I),c(P,F);for(let ie=0;ie<ce.length;ie+=1)ce[ie]&&ce[ie].m(F,null);Ye(F,s[4]),c(e,L),fe&&fe.m(e,null),c(e,G),de&&de.m(e,null),c(e,q),c(e,K),c(K,te),c(K,$),c(K,ee),c(ee,X),c(ee,Y),c(ee,U),Ie(ee,s[6],!0),c(e,N),c(e,Q),c(Q,ye),c(Q,Te),c(Q,ae),c(ae,j),c(j,W),c(j,le),c(j,ke),c(j,Ce),c(j,we),ge&&ge.m(j,null),Ie(j,s[8],!0),c(ae,ue),c(ae,me),c(me,De),c(me,Z),Ie(me,s[9],!0),re||(se=[H(o,"click",s[23]),H(u,"click",s[24]),H(f,"click",s[25]),H(_,"click",s[26]),H(g,"click",s[27]),H(C,"input",s[28]),H(T,"input",s[29]),H(F,"change",s[30]),H(ee,"change",s[33]),H(j,"change",s[34]),H(me,"change",s[35])],re=!0)},p(R,x){if(x[0]&2048&&he(o,"active",R[11]==="week"),x[0]&2048&&he(u,"active",R[11]==="month"),x[0]&2048&&he(f,"active",R[11]==="year"),x[0]&2048&&he(_,"active",R[11]==="thisyear"),x[0]&2048&&he(g,"active",R[11]==="all"),x[0]&4&&J(C,R[2]),x[0]&8&&J(T,R[3]),R[4].length>0?ne?ne.p(R,x):(ne=$t(R),ne.c(),ne.m(z,null)):ne&&(ne.d(1),ne=null),x[0]&32768){Ee=pe(R[15]);let ie;for(ie=0;ie<Ee.length;ie+=1){const pt=Jt(R,Ee,ie);ce[ie]?ce[ie].p(pt,x):(ce[ie]=xt(pt),ce[ie].c(),ce[ie].m(F,null))}for(;ie<ce.length;ie+=1)ce[ie].d(1);ce.length=Ee.length}x[0]&32784&&Ye(F,R[4]),R[0].length>0?fe?fe.p(R,x):(fe=el(R),fe.c(),fe.m(e,G)):fe&&(fe.d(1),fe=null),R[14].length>0?de?de.p(R,x):(de=sl(R),de.c(),de.m(e,q)):de&&(de.d(1),de=null),x[0]&64&&Ie(ee,R[6]),x[0]&2&&(Ae=R[1].trim()),Ae?ge||(ge=ol(),ge.c(),ge.m(j,null)):ge&&(ge.d(1),ge=null),x[0]&256&&Ie(j,R[8]),x[0]&512&&Ie(me,R[9])},d(R){R&&w(e),ne&&ne.d(),We(ce,R),fe&&fe.d(),de&&de.d(),ge&&ge.d(),re=!1,Ke(se)}}}function $t(s){let e,t=s[4].length+"",l;return{c(){e=p("span"),l=M(t),h(e,"class","count-badge svelte-z58pfr")},m(n,i){A(n,e,i),c(e,l)},p(n,i){i[0]&16&&t!==(t=n[4].length+"")&&B(l,t)},d(n){n&&w(e)}}}function xt(s){let e,t=s[46].name+"",l,n;return{c(){e=p("option"),l=M(t),e.__value=n=s[46].id,J(e,e.__value)},m(i,o){A(i,e,o),c(e,l)},p(i,o){o[0]&32768&&t!==(t=i[46].name+"")&&B(l,t),o[0]&32768&&n!==(n=i[46].id)&&(e.__value=n,J(e,e.__value))},d(i){i&&w(e)}}}function el(s){let e,t,l,n,i,o,a,u=s[7].length>0&&tl(s),r=pe(s[0]),f=[];for(let d=0;d<r.length;d+=1)f[d]=ll(Qt(s,r,d));return{c(){e=p("div"),t=p("label"),l=M(`Playlists
          `),u&&u.c(),n=b(),i=p("select");for(let d=0;d<f.length;d+=1)f[d].c();h(t,"class","filter-label svelte-z58pfr"),i.multiple=!0,h(i,"class","multi-select svelte-z58pfr"),h(i,"size","3"),s[7]===void 0&&Ne(()=>s[31].call(i)),h(e,"class","filter-group svelte-z58pfr")},m(d,_){A(d,e,_),c(e,t),c(t,l),u&&u.m(t,null),c(e,n),c(e,i);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(i,null);Ye(i,s[7]),o||(a=H(i,"change",s[31]),o=!0)},p(d,_){if(d[7].length>0?u?u.p(d,_):(u=tl(d),u.c(),u.m(t,null)):u&&(u.d(1),u=null),_[0]&8193){r=pe(d[0]);let m;for(m=0;m<r.length;m+=1){const g=Qt(d,r,m);f[m]?f[m].p(g,_):(f[m]=ll(g),f[m].c(),f[m].m(i,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=r.length}_[0]&129&&Ye(i,d[7])},d(d){d&&w(e),u&&u.d(),We(f,d),o=!1,a()}}}function tl(s){let e,t=s[7].length+"",l;return{c(){e=p("span"),l=M(t),h(e,"class","count-badge svelte-z58pfr")},m(n,i){A(n,e,i),c(e,l)},p(n,i){i[0]&128&&t!==(t=n[7].length+"")&&B(l,t)},d(n){n&&w(e)}}}function ll(s){let e,t=s[43].title+"",l,n,i=(s[13].get(s[43].playlist_id)||0)+"",o,a,u;return{c(){e=p("option"),l=M(t),n=M(" ("),o=M(i),a=M(`)
            `),e.__value=u=s[43].playlist_id,J(e,e.__value)},m(r,f){A(r,e,f),c(e,l),c(e,n),c(e,o),c(e,a)},p(r,f){f[0]&1&&t!==(t=r[43].title+"")&&B(l,t),f[0]&8193&&i!==(i=(r[13].get(r[43].playlist_id)||0)+"")&&B(o,i),f[0]&1&&u!==(u=r[43].playlist_id)&&(e.__value=u,J(e,e.__value))},d(r){r&&w(e)}}}function sl(s){let e,t,l,n,i,o,a,u=s[5].length>0&&nl(s),r=pe(s[14]),f=[];for(let d=0;d<r.length;d+=1)f[d]=il(Gt(s,r,d));return{c(){e=p("div"),t=p("label"),l=M(`Tags
          `),u&&u.c(),n=b(),i=p("select");for(let d=0;d<f.length;d+=1)f[d].c();h(t,"class","filter-label svelte-z58pfr"),i.multiple=!0,h(i,"class","multi-select svelte-z58pfr"),h(i,"size","3"),s[5]===void 0&&Ne(()=>s[32].call(i)),h(e,"class","filter-group svelte-z58pfr")},m(d,_){A(d,e,_),c(e,t),c(t,l),u&&u.m(t,null),c(e,n),c(e,i);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(i,null);Ye(i,s[5]),o||(a=H(i,"change",s[32]),o=!0)},p(d,_){if(d[5].length>0?u?u.p(d,_):(u=nl(d),u.c(),u.m(t,null)):u&&(u.d(1),u=null),_[0]&16384){r=pe(d[14]);let m;for(m=0;m<r.length;m+=1){const g=Gt(d,r,m);f[m]?f[m].p(g,_):(f[m]=il(g),f[m].c(),f[m].m(i,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=r.length}_[0]&16416&&Ye(i,d[5])},d(d){d&&w(e),u&&u.d(),We(f,d),o=!1,a()}}}function nl(s){let e,t=s[5].length+"",l;return{c(){e=p("span"),l=M(t),h(e,"class","count-badge svelte-z58pfr")},m(n,i){A(n,e,i),c(e,l)},p(n,i){i[0]&32&&t!==(t=n[5].length+"")&&B(l,t)},d(n){n&&w(e)}}}function il(s){let e,t=s[40]+"",l,n;return{c(){e=p("option"),l=M(t),e.__value=n=s[40],J(e,e.__value)},m(i,o){A(i,e,o),c(e,l)},p(i,o){o[0]&16384&&t!==(t=i[40]+"")&&B(l,t),o[0]&16384&&n!==(n=i[40])&&(e.__value=n,J(e,e.__value))},d(i){i&&w(e)}}}function ol(s){let e;return{c(){e=p("option"),e.textContent="Relevance",e.__value="relevance",J(e,e.__value)},m(t,l){A(t,e,l)},d(t){t&&w(e)}}}function al(s){let e,t,l,n,i,o,a;return{c(){e=p("div"),t=p("button"),l=M("Clear All Filters ("),n=M(s[12]),i=M(")"),h(t,"class","clear-button svelte-z58pfr"),h(e,"class","footer svelte-z58pfr")},m(u,r){A(u,e,r),c(e,t),c(t,l),c(t,n),c(t,i),o||(a=H(t,"click",s[16]),o=!0)},p(u,r){r[0]&4096&&B(n,u[12])},d(u){u&&w(e),o=!1,a()}}}function cn(s){let e,t,l,n,i,o,a,u,r=s[10]?"‚ñº":"‚ñ∂",f,d,_,m,g,k,y=s[12]>0&&!s[10]&&Xt(s),C=s[10]&&Zt(s),v=s[12]>0&&al(s);return{c(){e=p("div"),t=p("div"),l=p("label"),l.textContent="Search",n=b(),i=p("input"),o=b(),a=p("button"),u=p("span"),f=M(r),d=M(`
    Filters
    `),y&&y.c(),_=b(),C&&C.c(),m=b(),v&&v.c(),h(l,"for","search-input"),h(l,"class","search-label svelte-z58pfr"),h(i,"id","search-input"),h(i,"type","text"),h(i,"placeholder","Search videos, channels, tags..."),h(i,"class","search-input svelte-z58pfr"),h(t,"class","search-section svelte-z58pfr"),h(u,"class","toggle-icon svelte-z58pfr"),h(a,"class","filters-toggle svelte-z58pfr"),h(e,"class","filter-panel svelte-z58pfr")},m(E,S){A(E,e,S),c(e,t),c(t,l),c(t,n),c(t,i),J(i,s[1]),c(e,o),c(e,a),c(a,u),c(u,f),c(a,d),y&&y.m(a,null),c(e,_),C&&C.m(e,null),c(e,m),v&&v.m(e,null),g||(k=[H(i,"input",s[21]),H(a,"click",s[22])],g=!0)},p(E,S){S[0]&2&&i.value!==E[1]&&J(i,E[1]),S[0]&1024&&r!==(r=E[10]?"‚ñº":"‚ñ∂")&&B(f,r),E[12]>0&&!E[10]?y?y.p(E,S):(y=Xt(E),y.c(),y.m(a,null)):y&&(y.d(1),y=null),E[10]?C?C.p(E,S):(C=Zt(E),C.c(),C.m(e,m)):C&&(C.d(1),C=null),E[12]>0?v?v.p(E,S):(v=al(E),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i:oe,o:oe,d(E){E&&w(e),y&&y.d(),C&&C.d(),v&&v.d(),g=!1,Ke(k)}}}function un(s,e,t){let l,n,i,o,a,{videos:u}=e,{playlists:r=[]}=e,{onFilterChange:f}=e,d="",_="",m="",g=[],k=[],y="all",C=[],v="date",E="desc",S=!0,T=null,O;function P(){let j=u;d.trim()&&(j=yl.search(d).map(le=>le.video)),j=Xe.filter(j,{dateRange:_||m?{from:_||"1970-01-01",to:m||new Date().toISOString().split("T")[0]}:void 0,channels:g.length>0?g:void 0,tags:k.length>0?k:void 0,downloadStatus:l.length>0?l:void 0,playlists:C.length>0?C:void 0},r),j=on.sort(j,{field:v,direction:E}),V(),f(j)}let z;function V(){clearTimeout(z),z=setTimeout(()=>{rn.updateHash({search:d||void 0,dateFrom:_||void 0,dateTo:m||void 0,channels:g.length>0?g:void 0,tags:k.length>0?k:void 0,downloadStatus:l.length>0?l:void 0,playlists:C.length>0?C:void 0,sortField:v,sortDirection:E})},500)}function I(){t(1,d=""),t(2,_=""),t(3,m=""),t(4,g=[]),t(5,k=[]),t(6,y="all"),t(7,C=[]),t(8,v="date"),t(9,E="desc")}function F(j){const W=new Date,le=W.toISOString().split("T")[0];switch(t(11,T=j),j){case"week":const ke=new Date(W.getTime()-6048e5);t(2,_=ke.toISOString().split("T")[0]),t(3,m=le);break;case"month":const Ce=new Date(W.getFullYear(),W.getMonth()-1,W.getDate());t(2,_=Ce.toISOString().split("T")[0]),t(3,m=le);break;case"year":const we=new Date(W.getFullYear()-1,W.getMonth(),W.getDate());t(2,_=we.toISOString().split("T")[0]),t(3,m=le);break;case"thisyear":t(2,_=`${W.getFullYear()}-01-01`),t(3,m=le);break;case"lastyear":t(2,_=`${W.getFullYear()-1}-01-01`),t(3,m=`${W.getFullYear()-1}-12-31`);break;case"all":t(2,_=""),t(3,m="");break}}function L(){d=this.value,t(1,d)}const G=()=>t(10,S=!S),q=()=>F("week"),K=()=>F("month"),te=()=>F("year"),$=()=>F("thisyear"),ee=()=>F("all");function X(){_=this.value,t(2,_)}function Y(){m=this.value,t(3,m)}function U(){g=st(this),t(4,g),t(15,n),t(18,u)}function N(){C=st(this),t(7,C),t(0,r)}function Q(){k=st(this),t(5,k),t(14,i),t(18,u)}function ye(){y=nt(this),t(6,y)}function Te(){v=nt(this),t(8,v)}function ae(){E=nt(this),t(9,E)}return s.$$set=j=>{"videos"in j&&t(18,u=j.videos),"playlists"in j&&t(0,r=j.playlists),"onFilterChange"in j&&t(19,f=j.onFilterChange)},s.$$.update=()=>{s.$$.dirty[0]&64&&(l=y==="all"?[]:y==="downloaded"?["downloaded"]:y==="metadata_only"?["metadata_only"]:[]),s.$$.dirty[0]&262144&&t(15,n=Xe.getUniqueChannels(u)),s.$$.dirty[0]&262144&&t(14,i=Xe.getUniqueTags(u)),s.$$.dirty[0]&262145&&t(13,o=Xe.getPlaylistVideoCounts(r,u)),s.$$.dirty[0]&1048578&&(clearTimeout(O),t(20,O=setTimeout(()=>{P()},300))),s.$$.dirty[0]&1020&&P(),s.$$.dirty[0]&254&&t(12,a=[d.length>0,_.length>0||m.length>0,g.length>0,k.length>0,y!=="all",C.length>0].filter(Boolean).length),s.$$.dirty[0]&12},[r,d,_,m,g,k,y,C,v,E,S,T,a,o,i,n,I,F,u,f,O,L,G,q,K,te,$,ee,X,Y,U,N,Q,ye,Te,ae]}class fn extends Re{constructor(e){super(),Ve(this,e,un,cn,Pe,{videos:18,playlists:0,onFilterChange:19},null,[-1,-1])}}function rl(s){let e=s[0].length+"",t,l;return{c(){t=M(e),l=M(" videos archived")},m(n,i){A(n,t,i),A(n,l,i)},p(n,i){i&1&&e!==(e=n[0].length+"")&&B(t,e)},d(n){n&&(w(t),w(l))}}}function dn(s){let e,t,l,n=!s[3]&&!s[4]&&cl(s);return t=new Ls({props:{videos:s[1],totalVideos:s[0].length,loading:s[3],error:s[4],onVideoClick:s[6]}}),{c(){n&&n.c(),e=b(),qe(t.$$.fragment)},m(i,o){n&&n.m(i,o),A(i,e,o),Ue(t,i,o),l=!0},p(i,o){!i[3]&&!i[4]?n?(n.p(i,o),o&24&&_e(n,1)):(n=cl(i),n.c(),_e(n,1),n.m(e.parentNode,e)):n&&(tt(),be(n,1,1,()=>{n=null}),lt());const a={};o&2&&(a.videos=i[1]),o&1&&(a.totalVideos=i[0].length),o&8&&(a.loading=i[3]),o&16&&(a.error=i[4]),t.$set(a)},i(i){l||(_e(n),_e(t.$$.fragment,i),l=!0)},o(i){be(n),be(t.$$.fragment,i),l=!1},d(i){i&&w(e),n&&n.d(i),He(t,i)}}}function hn(s){let e,t;return e=new ln({props:{video:s[5],onBack:s[7]}}),{c(){qe(e.$$.fragment)},m(l,n){Ue(e,l,n),t=!0},p(l,n){const i={};n&32&&(i.video=l[5]),e.$set(i)},i(l){t||(_e(e.$$.fragment,l),t=!0)},o(l){be(e.$$.fragment,l),t=!1},d(l){He(e,l)}}}function cl(s){let e,t;return e=new fn({props:{videos:s[0],playlists:s[2],onFilterChange:s[8]}}),{c(){qe(e.$$.fragment)},m(l,n){Ue(e,l,n),t=!0},p(l,n){const i={};n&1&&(i.videos=l[0]),n&4&&(i.playlists=l[2]),e.$set(i)},i(l){t||(_e(e.$$.fragment,l),t=!0)},o(l){be(e.$$.fragment,l),t=!1},d(l){He(e,l)}}}function _n(s){let e,t,l,n,i,o,a,u,r,f,d,_=!s[3]&&!s[4]&&rl(s);const m=[hn,dn],g=[];function k(y,C){return y[5]?0:1}return r=k(s),f=g[r]=m[r](s),{c(){e=p("main"),t=p("header"),l=p("div"),n=p("h1"),n.textContent="üìπ YouTube Archive Browser",i=b(),o=p("p"),_&&_.c(),a=b(),u=p("div"),f.c(),h(n,"class","svelte-1wq1yz8"),h(o,"class","subtitle svelte-1wq1yz8"),h(l,"class","header-content svelte-1wq1yz8"),h(t,"class","svelte-1wq1yz8"),h(u,"class","container svelte-1wq1yz8"),h(e,"class","svelte-1wq1yz8")},m(y,C){A(y,e,C),c(e,t),c(t,l),c(l,n),c(l,i),c(l,o),_&&_.m(o,null),c(e,a),c(e,u),g[r].m(u,null),d=!0},p(y,[C]){!y[3]&&!y[4]?_?_.p(y,C):(_=rl(y),_.c(),_.m(o,null)):_&&(_.d(1),_=null);let v=r;r=k(y),r===v?g[r].p(y,C):(tt(),be(g[v],1,1,()=>{g[v]=null}),lt(),f=g[r],f?f.p(y,C):(f=g[r]=m[r](y),f.c()),_e(f,1),f.m(u,null))},i(y){d||(_e(f),d=!0)},o(y){be(f),d=!1},d(y){y&&w(e),_&&_.d(),g[r].d()}}}function pn(s,e,t){let l=[],n=[],i=[],o=!0,a=null;Qe.getCurrentRoute();let u=null;ul(async()=>{try{t(0,l=await Ze.loadVideos()),t(1,n=l),yl.initialize(l);try{t(2,i=await Ze.loadPlaylists())}catch(_){console.warn("Could not load playlists:",_),t(2,i=[])}t(3,o=!1)}catch(_){t(4,a=_ instanceof Error?_.message:"Unknown error loading archive"),t(3,o=!1)}Qe.subscribe(_=>{if(_.name==="video"){const m=_.params.video_id;t(5,u=l.find(g=>g.video_id===m)||null)}else t(5,u=null)})});function r(_){Qe.navigate("video",{video_id:_.video_id})}function f(){Qe.navigate("home")}function d(_){t(1,n=_)}return[l,n,i,o,a,u,r,f,d]}class mn extends Re{constructor(e){super(),Ve(this,e,pn,_n,Pe,{})}}new mn({target:document.getElementById("app")});
